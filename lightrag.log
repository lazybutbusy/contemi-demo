2025-01-07 03:26:44,696 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:26:44,696 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 03:26:44,696 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 03:26:44,696 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 03:26:44,697 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 03:26:44,699 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 03:26:44,983 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 03:27:44,046 - lightrag - INFO - Inserting entities into storage...
2025-01-07 03:27:48,636 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 03:27:48,649 - lightrag - INFO - Inserting 397 vectors to entities
2025-01-07 03:27:52,868 - lightrag - INFO - Inserting 302 vectors to relationships
2025-01-07 03:27:56,316 - lightrag - INFO - Writing graph with 398 nodes, 302 edges
2025-01-07 03:27:56,987 - lightrag - INFO - Truncate 39 to 3 chunks
2025-01-07 03:28:08,233 - lightrag - INFO - kw_prompt result:
2025-01-07 03:28:08,953 - lightrag - INFO - Local query uses 60 entites, 106 relations, 3 text units
2025-01-07 03:28:22,273 - lightrag - INFO - kw_prompt result:
2025-01-07 03:28:23,164 - lightrag - INFO - Global query uses 57 entites, 60 relations, 3 text units
2025-01-07 03:28:34,970 - lightrag - INFO - kw_prompt result:
2025-01-07 03:28:35,712 - lightrag - INFO - Local query uses 60 entites, 106 relations, 3 text units
2025-01-07 03:28:36,398 - lightrag - INFO - Global query uses 55 entites, 60 relations, 3 text units
2025-01-07 03:28:51,731 - lightrag - INFO - Local query uses 60 entites, 106 relations, 3 text units
2025-01-07 03:28:52,444 - lightrag - INFO - Global query uses 55 entites, 60 relations, 3 text units
2025-01-07 03:32:41,250 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:32:41,250 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 03:32:41,250 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 03:32:41,250 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 03:32:41,251 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 03:32:41,252 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 03:32:41,528 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 03:32:41,572 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: model "nomic-embed-text" not found, try pulling it first
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 122, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: model "nomic-embed-text" not found, try pulling it first

2025-01-07 03:32:41,574 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-07 03:33:30,502 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:33:30,503 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 03:33:30,503 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 03:33:30,503 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 03:33:30,504 - lightrag - INFO - Loaded graph from ./dickens/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-07 03:33:30,504 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 03:33:30,506 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 03:33:30,776 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 03:34:14,116 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: POST predict: Post "http://127.0.0.1:41239/completion": EOF
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 313, in _process_single_content
    final_result = await use_llm_func(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: POST predict: Post "http://127.0.0.1:41239/completion": EOF

2025-01-07 03:34:14,122 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-07 03:34:14,199 - lightrag - WARNING - No valid chunks found after filtering
2025-01-07 03:35:08,166 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:35:08,167 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 03:35:08,167 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 03:35:08,167 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 03:35:08,167 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 03:35:08,169 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 03:35:08,442 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 03:35:27,736 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: POST predict: Post "http://127.0.0.1:39569/completion": EOF
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 313, in _process_single_content
    final_result = await use_llm_func(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: POST predict: Post "http://127.0.0.1:39569/completion": EOF

2025-01-07 03:35:27,739 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-07 03:35:27,820 - lightrag - WARNING - No valid chunks found after filtering
2025-01-07 03:36:56,286 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:36:56,287 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 03:36:56,287 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 03:36:56,287 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 03:36:56,288 - lightrag - INFO - Loaded graph from ./dickens/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-07 03:36:56,289 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 03:36:56,290 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 03:36:56,607 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 03:37:26,408 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: POST predict: Post "http://127.0.0.1:33947/completion": EOF
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 313, in _process_single_content
    final_result = await use_llm_func(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: POST predict: Post "http://127.0.0.1:33947/completion": EOF

2025-01-07 03:37:26,410 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-07 03:37:26,493 - lightrag - WARNING - No valid chunks found after filtering
2025-01-07 03:37:53,501 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:37:53,502 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 03:37:53,502 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 03:37:53,502 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 03:37:53,503 - lightrag - INFO - Loaded graph from ./dickens/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-07 03:37:53,504 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 03:37:53,506 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 03:37:53,788 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 03:44:41,977 - lightrag - INFO - Inserting entities into storage...
2025-01-07 03:44:41,978 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 03:44:41,978 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-07 03:44:41,979 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-07 03:44:41,981 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-07 03:44:43,028 - lightrag - WARNING - No valid chunks found after filtering
2025-01-07 03:44:43,354 - lightrag - INFO - kw_prompt result:
2025-01-07 03:44:43,354 - lightrag - ERROR - No JSON-like structure found in the result.
2025-01-07 03:44:43,576 - lightrag - INFO - kw_prompt result:
2025-01-07 03:44:43,576 - lightrag - ERROR - No JSON-like structure found in the result.
2025-01-07 03:44:43,808 - lightrag - INFO - kw_prompt result:
2025-01-07 03:44:43,808 - lightrag - ERROR - No JSON-like structure found in the result.
2025-01-07 03:44:44,059 - lightrag - WARNING - No JSON-like structure found in keywords extraction result
2025-01-07 03:47:44,456 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:47:44,456 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 03:47:44,456 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 03:47:44,456 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 03:47:44,457 - lightrag - INFO - Loaded graph from ./dickens/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-07 03:47:44,458 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 03:47:44,460 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 03:47:44,736 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 03:52:27,137 - lightrag - INFO - Inserting entities into storage...
2025-01-07 03:52:31,937 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 03:52:31,940 - lightrag - INFO - Inserting 149 vectors to entities
2025-01-07 03:52:32,985 - lightrag - INFO - Inserting 80 vectors to relationships
2025-01-07 03:52:33,532 - lightrag - INFO - Writing graph with 175 nodes, 80 edges
2025-01-07 03:52:33,570 - lightrag - INFO - Truncate 42 to 3 chunks
2025-01-07 03:52:42,921 - lightrag - INFO - kw_prompt result:
2025-01-07 03:52:42,921 - lightrag - WARNING - low_level_keywords is empty
2025-01-07 03:52:43,306 - lightrag - INFO - kw_prompt result:
2025-01-07 03:52:43,348 - lightrag - INFO - Global query uses 70 entites, 60 relations, 3 text units
2025-01-07 03:53:05,959 - lightrag - INFO - kw_prompt result:
2025-01-07 03:53:06,007 - lightrag - INFO - Local query uses 60 entites, 54 relations, 3 text units
2025-01-07 03:53:06,086 - lightrag - INFO - Global query uses 70 entites, 60 relations, 3 text units
2025-01-07 03:53:42,978 - lightrag - INFO - Local query uses 60 entites, 56 relations, 3 text units
2025-01-07 03:53:43,073 - lightrag - INFO - Global query uses 70 entites, 60 relations, 3 text units
2025-01-07 03:54:51,107 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:54:51,108 - lightrag - INFO - Load KV llm_response_cache with 4 data
2025-01-07 03:54:51,108 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 03:54:51,109 - lightrag - INFO - Load KV text_chunks with 42 data
2025-01-07 03:54:51,258 - lightrag - INFO - Loaded graph from ./dickens/graph_chunk_entity_relation.graphml with 175 nodes, 80 edges
2025-01-07 03:54:51,263 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 03:54:51,264 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 03:54:52,959 - lightrag - INFO - kw_prompt result:
2025-01-07 03:54:53,268 - lightrag - INFO - Local query uses 60 entites, 56 relations, 3 text units
2025-01-07 03:55:09,293 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:55:09,294 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 03:55:09,294 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 03:55:09,294 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 03:55:09,294 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 03:55:09,296 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 03:55:09,583 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 03:59:27,813 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 03:59:27,813 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 03:59:27,813 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 03:59:27,813 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 03:59:27,814 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 03:59:27,815 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 03:59:28,107 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 04:14:41,709 - lightrag - INFO - Inserting entities into storage...
2025-01-07 04:14:56,609 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 04:14:56,626 - lightrag - INFO - Inserting 219 vectors to entities
2025-01-07 04:14:59,208 - lightrag - INFO - Inserting 198 vectors to relationships
2025-01-07 04:15:00,561 - lightrag - INFO - Writing graph with 309 nodes, 198 edges
2025-01-07 04:15:00,607 - lightrag - INFO - Truncate 42 to 3 chunks
2025-01-07 04:15:16,462 - lightrag - INFO - kw_prompt result:
2025-01-07 04:15:16,528 - lightrag - INFO - Local query uses 60 entites, 66 relations, 3 text units
2025-01-07 04:16:27,977 - lightrag - INFO - kw_prompt result:
2025-01-07 04:16:28,028 - lightrag - INFO - Global query uses 65 entites, 60 relations, 3 text units
2025-01-07 04:18:29,971 - lightrag - INFO - kw_prompt result:
2025-01-07 04:18:30,021 - lightrag - INFO - Local query uses 60 entites, 65 relations, 3 text units
2025-01-07 04:18:30,137 - lightrag - INFO - Global query uses 66 entites, 60 relations, 3 text units
2025-01-07 04:20:16,015 - lightrag - INFO - Local query uses 60 entites, 65 relations, 3 text units
2025-01-07 04:20:16,094 - lightrag - INFO - Global query uses 73 entites, 60 relations, 3 text units
2025-01-07 04:21:17,368 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 04:21:17,369 - lightrag - INFO - Load KV llm_response_cache with 5 data
2025-01-07 04:21:17,369 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 04:21:17,370 - lightrag - INFO - Load KV text_chunks with 42 data
2025-01-07 04:21:17,512 - lightrag - INFO - Loaded graph from ./dickens/graph_chunk_entity_relation.graphml with 309 nodes, 198 edges
2025-01-07 04:21:17,521 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 04:21:17,522 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 04:22:21,848 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 04:22:21,849 - lightrag - INFO - Load KV llm_response_cache with 5 data
2025-01-07 04:22:21,849 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 04:22:21,850 - lightrag - INFO - Load KV text_chunks with 42 data
2025-01-07 04:22:21,994 - lightrag - INFO - Loaded graph from ./dickens/graph_chunk_entity_relation.graphml with 309 nodes, 198 edges
2025-01-07 04:22:58,612 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 04:22:58,613 - lightrag - INFO - Load KV llm_response_cache with 5 data
2025-01-07 04:22:58,613 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 04:22:58,615 - lightrag - INFO - Load KV text_chunks with 42 data
2025-01-07 04:22:58,764 - lightrag - INFO - Loaded graph from ./dickens/graph_chunk_entity_relation.graphml with 309 nodes, 198 edges
2025-01-07 04:22:58,772 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 04:22:58,773 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 07:04:20,758 - lightrag - INFO - Logger initialized for working directory: ./dickens_openai
2025-01-07 07:04:20,759 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 07:04:20,759 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 07:04:20,759 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 07:04:20,759 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 07:04:20,761 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 07:04:21,052 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 07:11:49,856 - lightrag - INFO - Logger initialized for working directory: ./dickens_openai
2025-01-07 07:11:49,856 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 07:11:49,856 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 07:11:49,856 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 07:11:49,857 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 07:11:49,859 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 07:11:50,139 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 07:13:57,707 - lightrag - INFO - Inserting entities into storage...
2025-01-07 07:14:03,837 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 07:14:03,853 - lightrag - INFO - Inserting 410 vectors to entities
2025-01-07 07:14:08,688 - lightrag - INFO - Inserting 313 vectors to relationships
2025-01-07 07:14:13,890 - lightrag - INFO - Writing graph with 414 nodes, 313 edges
2025-01-07 07:14:15,993 - lightrag - INFO - Local query uses 60 entites, 114 relations, 3 text units
2025-01-07 07:14:16,787 - lightrag - INFO - Global query uses 55 entites, 60 relations, 3 text units
2025-01-07 07:46:39,237 - lightrag - INFO - Logger initialized for working directory: ./dickens_openai
2025-01-07 07:46:39,237 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 07:46:39,238 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 07:46:39,239 - lightrag - INFO - Load KV text_chunks with 42 data
2025-01-07 07:46:39,382 - lightrag - INFO - Loaded graph from ./dickens_openai/graph_chunk_entity_relation.graphml with 414 nodes, 313 edges
2025-01-07 07:46:39,409 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 07:46:39,409 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 07:46:39,409 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 07:46:39,410 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 07:46:39,410 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 07:46:39,410 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 07:46:39,411 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 07:46:39,705 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 07:53:17,675 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 07:53:17,675 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 07:53:17,675 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 07:53:17,675 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 07:53:17,676 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 07:53:17,678 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 07:53:17,957 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 07:58:47,650 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 07:58:47,650 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 07:58:47,650 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 07:58:47,651 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 07:58:47,651 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 07:58:47,653 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 07:58:47,928 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 08:11:30,539 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 08:11:30,539 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 08:11:30,540 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 08:11:30,540 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 08:11:30,540 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 08:11:30,542 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 08:11:30,847 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 08:17:57,679 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 316, in _process_single_content
    glean_result = await use_llm_func(continue_prompt, history_messages=history)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-07 08:17:57,682 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-07 08:17:57,702 - lightrag - ERROR - Error in get_vector_context: [Errno 111] Connection refused
2025-01-07 08:21:12,318 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 08:21:12,318 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 08:21:12,318 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 08:21:12,318 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 08:21:12,319 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 08:21:12,321 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 08:21:12,606 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 08:49:18,931 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 08:49:18,932 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 08:49:18,932 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 08:49:18,932 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 08:49:18,933 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 08:49:18,936 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 08:49:19,214 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-07 09:05:13,906 - lightrag - INFO - Inserting entities into storage...
2025-01-07 09:05:24,589 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 09:05:24,599 - lightrag - INFO - Inserting 229 vectors to entities
2025-01-07 09:05:27,274 - lightrag - INFO - Inserting 199 vectors to relationships
2025-01-07 09:05:28,641 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 09:05:29,354 - lightrag - INFO - Local query uses 60 entites, 51 relations, 3 text units
2025-01-07 09:05:29,455 - lightrag - INFO - Global query uses 70 entites, 60 relations, 3 text units
2025-01-07 15:29:26,513 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-07 15:29:26,513 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 15:29:26,515 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 15:29:26,516 - lightrag - INFO - Load KV text_chunks with 42 data
2025-01-07 15:29:26,672 - lightrag - INFO - Loaded graph from ./dickens/graph_chunk_entity_relation.graphml with 329 nodes, 199 edges
2025-01-07 15:29:26,685 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 15:29:26,686 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 15:29:26,998 - lightrag - INFO - Inserting 58 vectors to chunks
2025-01-07 16:09:30,002 - lightrag - ERROR - Failed to process document doc-f4099a3ef6f8d161d0e2c03b0631c17b: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 316, in _process_single_content
    glean_result = await use_llm_func(continue_prompt, history_messages=history)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-07 16:09:30,024 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 16:09:30,039 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:09:30,076 - lightrag - INFO - Inserting 53 vectors to chunks
2025-01-07 16:09:30,117 - lightrag - ERROR - Failed to process document doc-156115ef4bf09195383ab4d5d5d6b291: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-07 16:09:30,138 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 16:09:30,148 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:09:30,182 - lightrag - INFO - Inserting 47 vectors to chunks
2025-01-07 16:09:30,222 - lightrag - ERROR - Failed to process document doc-b5278ebbef2b5c37355bd25e84393403: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-07 16:09:30,244 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 16:09:30,254 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:09:30,287 - lightrag - INFO - Inserting 45 vectors to chunks
2025-01-07 16:09:30,326 - lightrag - ERROR - Failed to process document doc-f6ac2e335354bfe92d1cd97008a60360: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-07 16:09:30,347 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 16:09:30,357 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:09:30,391 - lightrag - INFO - Inserting 47 vectors to chunks
2025-01-07 16:09:30,430 - lightrag - ERROR - Failed to process document doc-bf85530292f41b696953f3563e80e18a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-07 16:09:30,451 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 16:09:30,461 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:09:30,494 - lightrag - INFO - Inserting 45 vectors to chunks
2025-01-07 16:09:30,533 - lightrag - ERROR - Failed to process document doc-1dfa1f4d09b1d07e61eb3ee4ad168784: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-07 16:09:30,554 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 16:09:30,564 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:09:30,592 - lightrag - INFO - Inserting 39 vectors to chunks
2025-01-07 16:09:30,632 - lightrag - ERROR - Failed to process document doc-85d2e38affa832fdb12d95d720b47471: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-07 16:09:30,653 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 16:09:30,663 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:09:30,700 - lightrag - INFO - Inserting 50 vectors to chunks
2025-01-07 16:09:30,738 - lightrag - ERROR - Failed to process document doc-ed96f5d9817621884abdcb9ca64ae6eb: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-07 16:09:30,761 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 16:09:30,771 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:09:30,801 - lightrag - INFO - Inserting 43 vectors to chunks
2025-01-07 16:09:30,840 - lightrag - ERROR - Failed to process document doc-be8d4b04b16e2d770b8bea9248db0e8f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-07 16:09:30,861 - lightrag - INFO - Writing graph with 329 nodes, 199 edges
2025-01-07 16:09:30,871 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:09:30,897 - lightrag - INFO - Inserting 36 vectors to chunks
2025-01-07 16:11:11,133 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-07 16:11:11,134 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 16:11:11,134 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 16:11:11,134 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 16:11:11,134 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 16:11:11,136 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:11:11,433 - lightrag - INFO - Inserting 58 vectors to chunks
2025-01-07 16:15:30,777 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-07 16:15:30,777 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 16:15:30,777 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 16:15:30,777 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 16:15:30,778 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:15:30,780 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:15:31,073 - lightrag - INFO - Inserting 58 vectors to chunks
2025-01-07 16:20:06,085 - lightrag - INFO - Inserting entities into storage...
2025-01-07 16:20:06,121 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 16:20:06,132 - lightrag - INFO - Inserting 830 vectors to entities
2025-01-07 16:20:11,736 - lightrag - INFO - Inserting 344 vectors to relationships
2025-01-07 16:20:13,930 - lightrag - INFO - Writing graph with 830 nodes, 344 edges
2025-01-07 16:20:15,339 - lightrag - INFO - Local query uses 60 entites, 26 relations, 3 text units
2025-01-07 16:20:15,461 - lightrag - INFO - Global query uses 72 entites, 60 relations, 3 text units
2025-01-07 16:20:39,432 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-07 16:20:39,432 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 16:20:39,433 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:20:39,435 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:20:39,587 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 830 nodes, 344 edges
2025-01-07 16:20:39,613 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:20:39,615 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:20:41,358 - lightrag - INFO - Local query uses 60 entites, 100 relations, 3 text units
2025-01-07 16:20:41,454 - lightrag - INFO - Global query uses 70 entites, 60 relations, 3 text units
2025-01-07 16:22:42,325 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-07 16:22:42,326 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 16:22:42,327 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:22:42,328 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:22:42,480 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 830 nodes, 344 edges
2025-01-07 16:22:42,506 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:22:42,507 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:22:44,244 - lightrag - INFO - Local query uses 60 entites, 131 relations, 3 text units
2025-01-07 16:22:44,353 - lightrag - INFO - Global query uses 61 entites, 60 relations, 3 text units
2025-01-07 16:23:45,377 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-07 16:23:45,377 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 16:23:45,378 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:23:45,379 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:23:45,528 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 830 nodes, 344 edges
2025-01-07 16:23:45,553 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:23:45,555 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:23:47,257 - lightrag - INFO - Local query uses 60 entites, 135 relations, 3 text units
2025-01-07 16:23:47,355 - lightrag - INFO - Global query uses 65 entites, 60 relations, 3 text units
2025-01-07 16:25:32,301 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-07 16:25:32,301 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 16:25:32,302 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:25:32,304 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:25:32,455 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 830 nodes, 344 edges
2025-01-07 16:25:32,481 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:25:32,482 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:25:34,081 - lightrag - INFO - Local query uses 60 entites, 6 relations, 3 text units
2025-01-07 16:25:34,174 - lightrag - INFO - Global query uses 73 entites, 60 relations, 3 text units
2025-01-07 16:28:05,443 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 16:28:05,443 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-07 16:28:05,443 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-07 16:28:05,443 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-07 16:28:05,444 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-07 16:28:05,446 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 16:28:05,744 - lightrag - INFO - Inserting 58 vectors to chunks
2025-01-07 16:32:04,709 - lightrag - INFO - Inserting entities into storage...
2025-01-07 16:32:04,747 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 16:32:04,759 - lightrag - INFO - Inserting 806 vectors to entities
2025-01-07 16:32:13,477 - lightrag - INFO - Inserting 324 vectors to relationships
2025-01-07 16:32:17,140 - lightrag - INFO - Writing graph with 809 nodes, 324 edges
2025-01-07 16:32:18,861 - lightrag - INFO - Local query uses 14 entites, 12 relations, 3 text units
2025-01-07 16:32:19,618 - lightrag - INFO - Global query uses 62 entites, 60 relations, 3 text units
2025-01-07 16:38:39,461 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 16:38:39,461 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 16:38:39,463 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:38:39,465 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:38:39,626 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 16:38:39,674 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:38:39,676 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:38:42,341 - lightrag - INFO - Local query uses 33 entites, 76 relations, 3 text units
2025-01-07 16:38:43,664 - lightrag - INFO - Global query uses 58 entites, 60 relations, 3 text units
2025-01-07 16:40:23,199 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 16:40:23,199 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 16:40:23,201 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:40:23,202 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:40:23,357 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 16:40:23,404 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:40:23,406 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:40:25,920 - lightrag - INFO - Local query uses 45 entites, 134 relations, 4 text units
2025-01-07 16:40:26,675 - lightrag - INFO - Global query uses 65 entites, 60 relations, 3 text units
2025-01-07 16:47:41,341 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 16:47:41,341 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 16:47:41,343 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:47:41,344 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:47:41,498 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 16:47:41,545 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:47:41,547 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:47:44,342 - lightrag - INFO - Local query uses 49 entites, 131 relations, 4 text units
2025-01-07 16:47:45,302 - lightrag - INFO - Global query uses 64 entites, 60 relations, 3 text units
2025-01-07 16:49:44,038 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 16:49:44,038 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 16:49:44,039 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:49:44,040 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:49:44,204 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 16:49:44,252 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:49:44,254 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:49:47,412 - lightrag - INFO - Local query uses 49 entites, 131 relations, 4 text units
2025-01-07 16:49:48,329 - lightrag - INFO - Global query uses 64 entites, 60 relations, 3 text units
2025-01-07 16:51:15,321 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 16:51:15,321 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-07 16:51:15,323 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:51:15,324 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:51:15,481 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 16:51:15,529 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:51:15,531 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:51:17,131 - lightrag - INFO - kw_prompt result:
2025-01-07 16:51:18,291 - lightrag - INFO - Local query uses 20 entites, 27 relations, 4 text units
2025-01-07 16:51:19,168 - lightrag - INFO - Global query uses 63 entites, 60 relations, 3 text units
2025-01-07 16:53:31,135 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 16:53:31,135 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 16:53:31,137 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:53:31,138 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:53:31,303 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 16:53:31,352 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:53:31,353 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:53:36,545 - lightrag - INFO - kw_prompt result:
2025-01-07 16:53:37,613 - lightrag - INFO - Local query uses 60 entites, 147 relations, 3 text units
2025-01-07 16:53:38,607 - lightrag - INFO - Global query uses 64 entites, 60 relations, 3 text units
2025-01-07 16:57:39,816 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 16:57:39,816 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 16:57:39,818 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 16:57:39,819 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 16:57:39,972 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 16:57:40,020 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 16:57:40,021 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 16:57:41,444 - lightrag - INFO - kw_prompt result:
2025-01-07 16:57:42,686 - lightrag - INFO - Local query uses 60 entites, 146 relations, 3 text units
2025-01-07 16:57:43,533 - lightrag - INFO - Global query uses 63 entites, 60 relations, 3 text units
2025-01-07 17:08:47,245 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 17:08:47,246 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 17:08:47,247 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 17:08:47,248 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 17:08:47,405 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 17:08:47,452 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 17:08:47,454 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 17:08:49,713 - lightrag - INFO - kw_prompt result:
2025-01-07 17:08:50,691 - lightrag - INFO - Local query uses 60 entites, 134 relations, 3 text units
2025-01-07 17:08:51,524 - lightrag - INFO - Global query uses 62 entites, 60 relations, 3 text units
2025-01-07 17:09:54,021 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 17:09:54,022 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 17:09:54,023 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 17:09:54,024 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 17:09:54,181 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 17:09:54,229 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 17:09:54,230 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 17:09:55,917 - lightrag - INFO - kw_prompt result:
2025-01-07 17:09:56,791 - lightrag - INFO - Local query uses 48 entites, 66 relations, 3 text units
2025-01-07 17:09:57,636 - lightrag - INFO - Global query uses 57 entites, 50 relations, 3 text units
2025-01-07 17:13:38,417 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 17:13:38,418 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 17:13:38,419 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 17:13:38,420 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 17:13:38,580 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 17:13:38,627 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 17:13:38,629 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-07 17:13:40,059 - lightrag - INFO - kw_prompt result:
2025-01-07 17:13:41,260 - lightrag - INFO - Local query uses 60 entites, 84 relations, 3 text units
2025-01-07 17:13:42,149 - lightrag - INFO - Global query uses 77 entites, 60 relations, 3 text units
2025-01-07 17:26:18,503 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 17:26:18,504 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 17:26:18,505 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-07 17:26:18,506 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-07 17:26:18,656 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 809 nodes, 324 edges
2025-01-07 17:26:18,704 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-07 17:26:18,706 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 17:26:18,991 - lightrag - INFO - Inserting 58 vectors to chunks
2025-01-07 17:30:16,380 - lightrag - INFO - Inserting entities into storage...
2025-01-07 17:30:23,858 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 17:30:23,874 - lightrag - INFO - Inserting 912 vectors to entities
2025-01-07 17:30:33,523 - lightrag - INFO - Inserting 355 vectors to relationships
2025-01-07 17:30:37,502 - lightrag - INFO - Writing graph with 1167 nodes, 595 edges
2025-01-07 17:30:37,540 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 17:30:37,578 - lightrag - INFO - Inserting 53 vectors to chunks
2025-01-07 17:37:17,853 - lightrag - INFO - Inserting entities into storage...
2025-01-07 17:37:24,212 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 17:37:24,225 - lightrag - INFO - Inserting 759 vectors to entities
2025-01-07 17:37:32,155 - lightrag - INFO - Inserting 272 vectors to relationships
2025-01-07 17:37:36,774 - lightrag - INFO - Writing graph with 1485 nodes, 814 edges
2025-01-07 17:37:36,825 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 17:37:36,863 - lightrag - INFO - Inserting 47 vectors to chunks
2025-01-07 17:40:20,959 - lightrag - INFO - Inserting entities into storage...
2025-01-07 17:40:28,411 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 17:40:28,425 - lightrag - INFO - Inserting 677 vectors to entities
2025-01-07 17:40:38,368 - lightrag - INFO - Inserting 273 vectors to relationships
2025-01-07 17:40:41,836 - lightrag - INFO - Writing graph with 1690 nodes, 1012 edges
2025-01-07 17:40:41,880 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 17:40:41,911 - lightrag - INFO - Inserting 45 vectors to chunks
2025-01-07 17:46:19,746 - lightrag - INFO - Inserting entities into storage...
2025-01-07 17:46:28,624 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 17:46:28,636 - lightrag - INFO - Inserting 1146 vectors to entities
2025-01-07 17:46:42,715 - lightrag - INFO - Inserting 226 vectors to relationships
2025-01-07 17:46:46,126 - lightrag - INFO - Writing graph with 2327 nodes, 1175 edges
2025-01-07 17:46:46,180 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 17:46:46,213 - lightrag - INFO - Inserting 47 vectors to chunks
2025-01-07 17:50:25,653 - lightrag - INFO - Inserting entities into storage...
2025-01-07 17:50:38,412 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 17:50:38,708 - lightrag - INFO - Inserting 687 vectors to entities
2025-01-07 17:50:46,370 - lightrag - INFO - Inserting 292 vectors to relationships
2025-01-07 17:50:50,313 - lightrag - INFO - Writing graph with 2455 nodes, 1341 edges
2025-01-07 17:50:50,376 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 17:50:50,408 - lightrag - INFO - Inserting 45 vectors to chunks
2025-01-07 17:53:55,723 - lightrag - INFO - Inserting entities into storage...
2025-01-07 17:54:07,193 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 17:54:07,206 - lightrag - INFO - Inserting 594 vectors to entities
2025-01-07 17:54:14,484 - lightrag - INFO - Inserting 245 vectors to relationships
2025-01-07 17:54:17,995 - lightrag - INFO - Writing graph with 2605 nodes, 1508 edges
2025-01-07 17:54:18,314 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 17:54:18,342 - lightrag - INFO - Inserting 39 vectors to chunks
2025-01-07 17:56:07,292 - lightrag - INFO - Inserting entities into storage...
2025-01-07 17:56:20,737 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 17:56:20,753 - lightrag - INFO - Inserting 621 vectors to entities
2025-01-07 17:56:28,164 - lightrag - INFO - Inserting 229 vectors to relationships
2025-01-07 17:56:32,671 - lightrag - INFO - Writing graph with 2764 nodes, 1635 edges
2025-01-07 17:56:32,742 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 17:56:32,778 - lightrag - INFO - Inserting 50 vectors to chunks
2025-01-07 17:59:49,920 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:00:11,696 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:00:11,715 - lightrag - INFO - Inserting 731 vectors to entities
2025-01-07 18:00:21,141 - lightrag - INFO - Inserting 297 vectors to relationships
2025-01-07 18:00:24,913 - lightrag - INFO - Writing graph with 3004 nodes, 1862 edges
2025-01-07 18:00:25,004 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:00:25,035 - lightrag - INFO - Inserting 43 vectors to chunks
2025-01-07 18:05:30,992 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:05:50,803 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:05:50,822 - lightrag - INFO - Inserting 644 vectors to entities
2025-01-07 18:05:57,930 - lightrag - INFO - Inserting 268 vectors to relationships
2025-01-07 18:06:01,625 - lightrag - INFO - Writing graph with 3138 nodes, 2011 edges
2025-01-07 18:06:01,721 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:06:01,747 - lightrag - INFO - Inserting 36 vectors to chunks
2025-01-07 18:09:24,805 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:09:40,476 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:09:40,513 - lightrag - INFO - Inserting 626 vectors to entities
2025-01-07 18:09:48,428 - lightrag - INFO - Inserting 215 vectors to relationships
2025-01-07 18:09:51,989 - lightrag - INFO - Writing graph with 3262 nodes, 2136 edges
2025-01-07 18:09:52,339 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:09:52,366 - lightrag - INFO - Inserting 38 vectors to chunks
2025-01-07 18:12:46,450 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:13:04,638 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:13:04,654 - lightrag - INFO - Inserting 542 vectors to entities
2025-01-07 18:13:11,653 - lightrag - INFO - Inserting 205 vectors to relationships
2025-01-07 18:13:15,052 - lightrag - INFO - Writing graph with 3360 nodes, 2252 edges
2025-01-07 18:13:15,147 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:13:15,178 - lightrag - INFO - Inserting 45 vectors to chunks
2025-01-07 18:17:40,101 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:18:02,962 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:18:05,937 - lightrag - INFO - Inserting 767 vectors to entities
2025-01-07 18:18:14,053 - lightrag - INFO - Inserting 240 vectors to relationships
2025-01-07 18:18:17,514 - lightrag - INFO - Writing graph with 3606 nodes, 2383 edges
2025-01-07 18:18:17,629 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:18:17,656 - lightrag - INFO - Inserting 37 vectors to chunks
2025-01-07 18:21:33,432 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:21:50,064 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:21:50,083 - lightrag - INFO - Inserting 594 vectors to entities
2025-01-07 18:21:57,531 - lightrag - INFO - Inserting 193 vectors to relationships
2025-01-07 18:22:01,014 - lightrag - INFO - Writing graph with 3727 nodes, 2464 edges
2025-01-07 18:22:01,126 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:22:01,160 - lightrag - INFO - Inserting 47 vectors to chunks
2025-01-07 18:25:51,410 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:26:25,191 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:26:25,212 - lightrag - INFO - Inserting 654 vectors to entities
2025-01-07 18:26:32,678 - lightrag - INFO - Inserting 295 vectors to relationships
2025-01-07 18:26:36,797 - lightrag - INFO - Writing graph with 3852 nodes, 2676 edges
2025-01-07 18:26:36,924 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:26:36,956 - lightrag - INFO - Inserting 43 vectors to chunks
2025-01-07 18:29:21,405 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:29:50,701 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:29:53,099 - lightrag - INFO - Inserting 661 vectors to entities
2025-01-07 18:30:00,845 - lightrag - INFO - Inserting 268 vectors to relationships
2025-01-07 18:30:04,684 - lightrag - INFO - Writing graph with 3984 nodes, 2827 edges
2025-01-07 18:30:04,831 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:30:04,862 - lightrag - INFO - Inserting 44 vectors to chunks
2025-01-07 18:34:02,281 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:34:26,333 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:34:31,059 - lightrag - INFO - Inserting 671 vectors to entities
2025-01-07 18:34:39,763 - lightrag - INFO - Inserting 251 vectors to relationships
2025-01-07 18:34:43,651 - lightrag - INFO - Writing graph with 4123 nodes, 2960 edges
2025-01-07 18:34:43,781 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:34:43,815 - lightrag - INFO - Inserting 46 vectors to chunks
2025-01-07 18:37:11,504 - lightrag - INFO - Inserting entities into storage...
2025-01-07 18:37:33,436 - lightrag - INFO - Inserting relationships into storage...
2025-01-07 18:37:38,026 - lightrag - INFO - Inserting 611 vectors to entities
2025-01-07 18:37:45,520 - lightrag - INFO - Inserting 257 vectors to relationships
2025-01-07 18:37:49,403 - lightrag - INFO - Writing graph with 4263 nodes, 3094 edges
2025-01-07 18:39:05,097 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:39:05,097 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:39:05,114 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:39:05,128 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:39:05,373 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:39:05,738 - lightrag - INFO - Loaded document status storage with 18 records
2025-01-07 18:39:05,740 - lightrag - INFO - Processing 1 new unique documents
2025-01-07 18:39:06,004 - lightrag - INFO - Inserting 58 vectors to chunks
2025-01-07 18:40:07,199 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:40:07,199 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:40:07,216 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:40:07,231 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:40:07,479 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:40:07,841 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:40:10,718 - lightrag - INFO - Local query uses 60 entites, 25 relations, 3 text units
2025-01-07 18:40:11,453 - lightrag - INFO - Global query uses 24 entites, 60 relations, 3 text units
2025-01-07 18:41:33,216 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:41:33,217 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:41:33,233 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:41:33,256 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:41:33,502 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:41:33,877 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:41:38,266 - lightrag - INFO - Local query uses 60 entites, 36 relations, 3 text units
2025-01-07 18:41:39,618 - lightrag - INFO - Global query uses 20 entites, 60 relations, 3 text units
2025-01-07 18:43:22,675 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:43:22,676 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:43:22,692 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:43:22,707 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:43:22,949 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:43:23,312 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:43:50,507 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:43:50,507 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:43:50,524 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:43:50,538 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:43:50,785 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:43:51,145 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:43:53,210 - lightrag - INFO - Local query uses 200 entites, 111 relations, 6 text units
2025-01-07 18:43:54,111 - lightrag - INFO - Global query uses 42 entites, 200 relations, 6 text units
2025-01-07 18:44:49,732 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:44:49,732 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:44:49,749 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:44:49,770 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:44:50,008 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:44:50,367 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:44:51,711 - lightrag - INFO - kw_prompt result:
2025-01-07 18:44:52,745 - lightrag - INFO - Local query uses 200 entites, 180 relations, 6 text units
2025-01-07 18:44:53,629 - lightrag - INFO - Global query uses 42 entites, 199 relations, 6 text units
2025-01-07 18:45:28,920 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:45:28,920 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:45:28,937 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:45:28,951 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:45:29,198 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:45:29,561 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:45:30,972 - lightrag - INFO - kw_prompt result:
2025-01-07 18:45:32,062 - lightrag - INFO - Local query uses 200 entites, 239 relations, 6 text units
2025-01-07 18:45:33,043 - lightrag - INFO - Global query uses 46 entites, 200 relations, 6 text units
2025-01-07 18:45:54,399 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:45:54,400 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:45:54,416 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:45:54,430 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:45:54,673 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:45:55,033 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:45:56,392 - lightrag - INFO - kw_prompt result:
2025-01-07 18:45:57,364 - lightrag - INFO - Local query uses 200 entites, 213 relations, 6 text units
2025-01-07 18:45:58,137 - lightrag - INFO - Global query uses 45 entites, 200 relations, 6 text units
2025-01-07 18:46:10,512 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:46:10,513 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:46:10,529 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:46:10,544 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:46:10,787 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:46:11,153 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:46:12,666 - lightrag - INFO - kw_prompt result:
2025-01-07 18:46:13,597 - lightrag - INFO - Local query uses 200 entites, 251 relations, 6 text units
2025-01-07 18:46:14,474 - lightrag - INFO - Global query uses 45 entites, 200 relations, 6 text units
2025-01-07 18:46:47,428 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:46:47,428 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:46:47,445 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:46:47,459 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:46:47,698 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:46:48,062 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:46:49,792 - lightrag - INFO - kw_prompt result:
2025-01-07 18:46:50,579 - lightrag - INFO - Local query uses 200 entites, 214 relations, 6 text units
2025-01-07 18:46:51,500 - lightrag - INFO - Global query uses 43 entites, 172 relations, 6 text units
2025-01-07 18:48:05,684 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:48:05,684 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:48:05,701 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:48:05,715 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:48:05,961 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:48:06,322 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:48:07,718 - lightrag - INFO - kw_prompt result:
2025-01-07 18:48:08,571 - lightrag - INFO - Local query uses 200 entites, 214 relations, 6 text units
2025-01-07 18:48:09,405 - lightrag - INFO - Global query uses 41 entites, 198 relations, 6 text units
2025-01-07 18:50:00,044 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:50:00,044 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:50:00,061 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:50:00,076 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:50:00,323 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:50:00,685 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:51:00,511 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:51:00,511 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:51:00,527 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:51:00,542 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:51:00,782 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:51:01,143 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:51:20,523 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:51:20,523 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:51:20,540 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:51:20,554 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:51:20,798 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:51:21,202 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:51:22,909 - lightrag - INFO - kw_prompt result:
2025-01-07 18:51:24,159 - lightrag - INFO - Local query uses 200 entites, 150 relations, 6 text units
2025-01-07 18:51:24,947 - lightrag - INFO - Global query uses 51 entites, 200 relations, 6 text units
2025-01-07 18:52:08,367 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:52:08,368 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:52:08,384 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:52:08,399 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:52:08,644 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:52:09,008 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:52:10,134 - lightrag - INFO - kw_prompt result:
2025-01-07 18:52:11,474 - lightrag - INFO - Local query uses 200 entites, 120 relations, 6 text units
2025-01-07 18:52:12,230 - lightrag - INFO - Global query uses 45 entites, 200 relations, 6 text units
2025-01-07 18:54:21,336 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:54:21,336 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:54:21,353 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:54:21,368 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:54:21,616 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:54:21,982 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:54:23,896 - lightrag - INFO - kw_prompt result:
2025-01-07 18:54:25,141 - lightrag - INFO - Local query uses 200 entites, 233 relations, 6 text units
2025-01-07 18:54:26,218 - lightrag - INFO - Global query uses 45 entites, 200 relations, 6 text units
2025-01-07 18:58:35,316 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:58:35,316 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:58:35,333 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:58:35,347 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:58:35,593 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:58:35,960 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:58:37,419 - lightrag - INFO - kw_prompt result:
2025-01-07 18:58:38,637 - lightrag - INFO - Local query uses 200 entites, 120 relations, 6 text units
2025-01-07 18:58:39,651 - lightrag - INFO - Global query uses 45 entites, 200 relations, 6 text units
2025-01-07 18:59:03,628 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 18:59:03,628 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 18:59:03,645 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 18:59:03,660 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 18:59:03,903 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 18:59:04,268 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 18:59:05,838 - lightrag - INFO - kw_prompt result:
2025-01-07 18:59:07,258 - lightrag - INFO - Local query uses 200 entites, 67 relations, 6 text units
2025-01-07 18:59:08,073 - lightrag - INFO - Global query uses 41 entites, 198 relations, 6 text units
2025-01-07 19:03:06,201 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:03:06,201 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:03:06,217 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:03:06,232 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:03:06,478 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:03:06,842 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:03:08,537 - lightrag - INFO - kw_prompt result:
2025-01-07 19:03:09,504 - lightrag - INFO - Local query uses 200 entites, 67 relations, 6 text units
2025-01-07 19:03:10,532 - lightrag - INFO - Global query uses 22 entites, 15 relations, 6 text units
2025-01-07 19:04:13,610 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:04:13,611 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:04:13,628 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:04:13,643 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:04:13,892 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:04:14,260 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:04:15,695 - lightrag - INFO - kw_prompt result:
2025-01-07 19:04:16,794 - lightrag - INFO - Local query uses 200 entites, 147 relations, 6 text units
2025-01-07 19:04:17,691 - lightrag - INFO - Global query uses 36 entites, 163 relations, 6 text units
2025-01-07 19:06:08,173 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:06:08,173 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:06:08,189 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:06:08,204 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:06:08,445 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:06:08,807 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:06:10,498 - lightrag - INFO - kw_prompt result:
2025-01-07 19:06:10,498 - lightrag - WARNING - low_level_keywords is empty
2025-01-07 19:06:22,381 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:06:22,382 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:06:22,398 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:06:22,412 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:06:22,663 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:06:23,025 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:06:23,292 - lightrag - INFO - kw_prompt result:
2025-01-07 19:06:24,349 - lightrag - INFO - Local query uses 200 entites, 202 relations, 6 text units
2025-01-07 19:06:25,752 - lightrag - INFO - Global query uses 45 entites, 200 relations, 6 text units
2025-01-07 19:07:07,011 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:07:07,012 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:07:07,029 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:07:07,044 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:07:07,294 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:07:07,654 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:07:08,031 - lightrag - INFO - kw_prompt result:
2025-01-07 19:07:09,246 - lightrag - INFO - Local query uses 200 entites, 192 relations, 6 text units
2025-01-07 19:07:10,268 - lightrag - INFO - Global query uses 22 entites, 129 relations, 6 text units
2025-01-07 19:07:48,393 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:07:48,393 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:07:48,410 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:07:48,424 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:07:48,666 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:07:49,031 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:07:49,351 - lightrag - INFO - kw_prompt result:
2025-01-07 19:07:50,244 - lightrag - INFO - Local query uses 200 entites, 201 relations, 6 text units
2025-01-07 19:07:50,824 - lightrag - INFO - Global query uses 23 entites, 110 relations, 6 text units
2025-01-07 19:08:17,538 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:08:17,538 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:08:17,555 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:08:17,569 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:08:17,809 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:08:18,169 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:08:19,316 - lightrag - INFO - Local query uses 200 entites, 178 relations, 6 text units
2025-01-07 19:08:20,162 - lightrag - INFO - Global query uses 23 entites, 110 relations, 6 text units
2025-01-07 19:08:52,207 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:08:52,207 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:08:52,225 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:08:52,240 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:08:52,489 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:08:52,862 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:08:54,309 - lightrag - INFO - Local query uses 200 entites, 208 relations, 6 text units
2025-01-07 19:08:55,356 - lightrag - INFO - Global query uses 26 entites, 119 relations, 6 text units
2025-01-07 19:10:08,938 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:10:08,938 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:10:08,955 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:10:08,969 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:10:09,205 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:10:09,566 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:10:12,035 - lightrag - INFO - Local query uses 200 entites, 67 relations, 6 text units
2025-01-07 19:10:12,728 - lightrag - INFO - Global query uses 32 entites, 130 relations, 6 text units
2025-01-07 19:10:55,918 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:10:55,918 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:10:55,935 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:10:55,949 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:10:56,189 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:10:56,546 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:10:58,623 - lightrag - INFO - Local query uses 60 entites, 100 relations, 3 text units
2025-01-07 19:10:59,343 - lightrag - INFO - Global query uses 13 entites, 60 relations, 3 text units
2025-01-07 19:11:13,909 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:11:13,909 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:11:13,926 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:11:13,940 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:11:14,190 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:11:14,551 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:11:16,937 - lightrag - INFO - Local query uses 60 entites, 24 relations, 3 text units
2025-01-07 19:11:17,858 - lightrag - INFO - Global query uses 11 entites, 60 relations, 3 text units
2025-01-07 19:11:41,253 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:11:41,253 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:11:41,270 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:11:41,284 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:11:41,542 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:11:41,907 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:11:44,802 - lightrag - INFO - Local query uses 49 entites, 60 relations, 3 text units
2025-01-07 19:11:45,412 - lightrag - INFO - Global query uses 12 entites, 32 relations, 3 text units
2025-01-07 19:12:32,132 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:12:32,132 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:12:32,149 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:12:32,163 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:12:32,406 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:12:32,765 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:12:35,127 - lightrag - INFO - Local query uses 60 entites, 90 relations, 3 text units
2025-01-07 19:12:36,536 - lightrag - INFO - Global query uses 13 entites, 60 relations, 3 text units
2025-01-07 19:13:24,498 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:13:24,499 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:13:24,515 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:13:24,530 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:13:24,780 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:13:25,157 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:13:27,216 - lightrag - INFO - Local query uses 60 entites, 44 relations, 3 text units
2025-01-07 19:13:28,639 - lightrag - INFO - Global query uses 15 entites, 60 relations, 3 text units
2025-01-07 19:14:21,973 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:14:21,973 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:14:21,990 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:14:22,004 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:14:22,260 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:14:22,626 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:14:24,907 - lightrag - INFO - Local query uses 200 entites, 250 relations, 6 text units
2025-01-07 19:14:25,701 - lightrag - INFO - Global query uses 46 entites, 200 relations, 6 text units
2025-01-07 19:14:48,496 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:14:48,497 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:14:48,513 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:14:48,528 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:14:48,775 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:14:49,133 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:15:04,289 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:15:04,290 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:15:04,306 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:15:04,321 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:15:04,559 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:15:04,933 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:15:06,995 - lightrag - INFO - Local query uses 26 entites, 56 relations, 3 text units
2025-01-07 19:15:07,741 - lightrag - INFO - Global query uses 19 entites, 60 relations, 3 text units
2025-01-07 19:16:01,469 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:16:01,470 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:16:01,486 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:16:01,500 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:16:01,739 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:16:02,100 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:16:18,493 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:16:18,494 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:16:18,510 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:16:18,525 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:16:18,776 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:16:19,136 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:16:21,495 - lightrag - INFO - Local query uses 60 entites, 43 relations, 3 text units
2025-01-07 19:16:22,368 - lightrag - INFO - Global query uses 19 entites, 60 relations, 3 text units
2025-01-07 19:16:51,136 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:16:51,136 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:16:51,154 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:16:51,169 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:16:51,418 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:16:51,779 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:16:53,897 - lightrag - INFO - Local query uses 37 entites, 60 relations, 3 text units
2025-01-07 19:16:54,734 - lightrag - INFO - Global query uses 19 entites, 60 relations, 3 text units
2025-01-07 19:18:41,993 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:18:41,994 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:18:42,010 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:18:42,025 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:18:42,268 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:18:42,629 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:18:45,129 - lightrag - INFO - Local query uses 60 entites, 85 relations, 3 text units
2025-01-07 19:18:45,973 - lightrag - INFO - Global query uses 12 entites, 60 relations, 3 text units
2025-01-07 19:19:22,488 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-07 19:19:22,488 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-07 19:19:22,505 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-07 19:19:22,520 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-07 19:19:22,766 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-07 19:19:23,128 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-07 19:19:25,639 - lightrag - INFO - Local query uses 60 entites, 46 relations, 3 text units
2025-01-07 19:19:26,461 - lightrag - INFO - Global query uses 15 entites, 60 relations, 3 text units
2025-01-08 06:22:15,700 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-08 06:22:15,700 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-08 06:22:15,702 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-08 06:22:15,703 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-08 06:22:15,861 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 830 nodes, 344 edges
2025-01-08 06:23:29,122 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-08 06:23:29,122 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-08 06:23:29,123 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-08 06:23:29,125 - lightrag - INFO - Load KV text_chunks with 58 data
2025-01-08 06:23:29,272 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 830 nodes, 344 edges
2025-01-08 06:23:48,419 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-08 06:23:48,420 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 06:23:48,420 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 06:23:48,420 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 06:23:48,420 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-08 06:23:48,423 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 06:23:48,703 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-08 06:26:33,354 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 313, in _process_single_content
    final_result = await use_llm_func(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-08 06:26:33,359 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-08 07:07:32,179 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-08 07:07:32,179 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:07:32,179 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:07:32,179 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:07:32,180 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-08 07:07:32,182 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-08 07:07:32,184 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:07:32,454 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-08 07:20:10,864 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-08 07:20:10,864 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:20:10,864 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:20:10,865 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:20:10,865 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-08 07:20:10,867 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-08 07:20:10,869 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:20:11,212 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-08 07:20:13,982 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: model "phi3.5:Q8_0" not found, try pulling it first
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 313, in _process_single_content
    final_result = await use_llm_func(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: model "phi3.5:Q8_0" not found, try pulling it first

2025-01-08 07:20:13,987 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-08 07:20:39,589 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-08 07:20:39,589 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:20:39,589 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:20:39,589 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:20:39,590 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-08 07:20:39,592 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-08 07:20:39,593 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:20:39,877 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-08 07:20:43,423 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: model "phi3.5:Q8_0" not found, try pulling it first
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 313, in _process_single_content
    final_result = await use_llm_func(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: model "phi3.5:Q8_0" not found, try pulling it first

2025-01-08 07:20:43,427 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-08 07:22:57,001 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-08 07:22:57,002 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:22:57,002 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:22:57,002 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:22:57,003 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-08 07:22:57,005 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-08 07:22:57,007 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:22:57,288 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-08 07:26:26,364 - lightrag - INFO - Inserting entities into storage...
2025-01-08 07:26:26,364 - lightrag - INFO - Inserting relationships into storage...
2025-01-08 07:26:26,365 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-08 07:26:26,365 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-08 07:26:26,368 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-08 07:26:27,631 - lightrag - WARNING - No high level context found. Switching to local mode.
2025-01-08 07:26:27,631 - lightrag - ERROR - Error in get_kg_context: cannot access local variable 'll_entities_context' where it is not associated with a value
2025-01-08 07:29:02,906 - lightrag - INFO - Logger initialized for working directory: ./contemi
2025-01-08 07:29:02,906 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:29:02,906 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:29:02,906 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:29:02,907 - lightrag - INFO - Loaded graph from ./contemi/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-08 07:29:02,909 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-08 07:29:02,911 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:29:03,197 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-08 07:30:41,993 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-08 07:30:41,994 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:30:41,994 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:30:41,994 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:30:41,994 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-08 07:30:41,996 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:30:42,276 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-08 07:33:57,856 - lightrag - INFO - Inserting entities into storage...
2025-01-08 07:33:57,857 - lightrag - INFO - Inserting relationships into storage...
2025-01-08 07:33:57,857 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-08 07:33:57,858 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-08 07:33:57,860 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-08 07:33:58,543 - lightrag - WARNING - No JSON-like structure found in keywords extraction result
2025-01-08 07:38:06,696 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-08 07:38:06,697 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:38:06,697 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:38:06,697 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:38:06,697 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-08 07:38:06,699 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:38:06,979 - lightrag - INFO - Inserting 100 vectors to chunks
2025-01-08 07:39:37,170 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-08 07:39:37,170 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:39:37,170 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:39:37,171 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:39:37,171 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-08 07:39:37,173 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:39:37,467 - lightrag - INFO - Inserting 100 vectors to chunks
2025-01-08 07:41:02,671 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-08 07:41:02,671 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:41:02,672 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:41:02,672 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:41:02,672 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-08 07:41:02,674 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:41:02,955 - lightrag - INFO - Inserting 199 vectors to chunks
2025-01-08 07:42:00,686 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-08 07:42:00,687 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 07:42:00,687 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 07:42:00,687 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 07:42:00,688 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-08 07:42:00,689 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 07:42:00,971 - lightrag - INFO - Inserting 199 vectors to chunks
2025-01-08 08:06:45,020 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: [Errno 2] No such file or directory: './dickens/kv_store_doc_status.json'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 313, in _process_single_content
    final_result = await use_llm_func(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 431, in ainsert
    await self.doc_status.upsert({doc_id: doc_status})
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 445, in upsert
    await self.index_done_callback()
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 436, in index_done_callback
    write_json(self._data, self._file_name)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 154, in write_json
    with open(file_name, "w", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './dickens/kv_store_doc_status.json'

2025-01-08 08:06:45,021 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-08 08:07:16,647 - lightrag - INFO - Logger initialized for working directory: ./dickens
2025-01-08 08:07:16,647 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-08 08:07:16,647 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-08 08:07:16,647 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-08 08:07:16,648 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-08 08:07:16,650 - lightrag - INFO - Processing 1 new unique documents
2025-01-08 08:07:16,940 - lightrag - INFO - Inserting 42 vectors to chunks
2025-01-08 08:53:43,506 - lightrag - ERROR - Failed to process document doc-addb4618e1697da0445ec72a648e1f92: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 313, in _process_single_content
    final_result = await use_llm_func(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-08 08:53:43,510 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:21:05,028 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:21:05,029 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-09 18:21:05,045 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-09 18:21:05,060 - lightrag - INFO - Load KV text_chunks with 700 data
2025-01-09 18:21:05,297 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 4263 nodes, 3094 edges
2025-01-09 18:21:05,664 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-09 18:21:08,436 - lightrag - INFO - Local query uses 60 entites, 144 relations, 3 text units
2025-01-09 18:21:09,362 - lightrag - INFO - Global query uses 17 entites, 60 relations, 3 text units
2025-01-09 18:21:27,436 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:21:27,436 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-09 18:21:27,436 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:21:27,436 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:21:27,437 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-09 18:21:30,709 - lightrag - WARNING - No high level context found. Switching to local mode.
2025-01-09 18:21:57,620 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:21:57,620 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-09 18:21:57,620 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:21:57,620 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:21:57,621 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-09 18:22:07,311 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:22:07,311 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-09 18:22:07,311 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:22:07,311 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:22:07,312 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-09 18:22:10,607 - lightrag - WARNING - No high level context found. Switching to local mode.
2025-01-09 18:22:37,540 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:22:37,540 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-09 18:22:37,541 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:22:37,541 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:22:37,541 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-09 18:22:41,010 - lightrag - WARNING - No high level context found. Switching to local mode.
2025-01-09 18:23:17,612 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:23:17,612 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-09 18:23:17,613 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:23:17,613 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:23:17,613 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-09 18:23:17,614 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:23:17,861 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:27:12,522 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:27:12,523 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-09 18:27:12,523 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:27:12,523 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:27:12,523 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-09 18:27:12,524 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:27:12,777 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:27:36,194 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:27:36,195 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-09 18:27:36,195 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:27:36,195 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:27:36,195 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-09 18:27:36,196 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:27:36,445 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:30:25,643 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:30:25,649 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:30:25,651 - lightrag - INFO - Inserting 177 vectors to entities
2025-01-09 18:30:31,714 - lightrag - INFO - Inserting 38 vectors to relationships
2025-01-09 18:30:33,346 - lightrag - INFO - Writing graph with 177 nodes, 38 edges
2025-01-09 18:31:02,288 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:31:02,289 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-09 18:31:02,289 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-09 18:31:02,289 - lightrag - INFO - Load KV text_chunks with 5 data
2025-01-09 18:31:02,429 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 177 nodes, 38 edges
2025-01-09 18:31:02,438 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-09 18:31:02,438 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-09 18:31:05,000 - lightrag - INFO - Local query uses 32 entites, 31 relations, 3 text units
2025-01-09 18:31:05,750 - lightrag - INFO - Global query uses 35 entites, 37 relations, 3 text units
2025-01-09 18:33:02,209 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-09 18:33:02,209 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-09 18:33:02,209 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-09 18:33:02,210 - lightrag - INFO - Load KV text_chunks with 5 data
2025-01-09 18:33:02,346 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 177 nodes, 38 edges
2025-01-09 18:33:02,356 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-09 18:33:02,356 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:33:02,603 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:36:13,358 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:36:13,365 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:36:13,366 - lightrag - INFO - Inserting 117 vectors to entities
2025-01-09 18:36:16,120 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-09 18:36:18,329 - lightrag - INFO - Writing graph with 217 nodes, 59 edges
2025-01-09 18:36:21,106 - lightrag - INFO - Local query uses 12 entites, 9 relations, 3 text units
2025-01-09 18:36:21,776 - lightrag - INFO - Global query uses 36 entites, 45 relations, 3 text units
2025-01-09 18:39:06,791 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-09 18:39:06,791 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-09 18:39:06,791 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:39:06,791 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:39:06,792 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-09 18:39:06,792 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,066 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:39:07,088 - lightrag - ERROR - Failed to process document doc-b5860ca977bbce889ed121b79b32fbfd: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,089 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,090 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,094 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:39:07,113 - lightrag - ERROR - Failed to process document doc-5b3dfa2411d0617404e06b9c2c767cc4: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,115 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,116 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,121 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-09 18:39:07,140 - lightrag - ERROR - Failed to process document doc-0c27ee4a65e2affcc9b5802f2fc689d9: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,142 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,143 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,147 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:39:07,168 - lightrag - ERROR - Failed to process document doc-8be1db76071d0ec7b0098e69e1c15767: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,170 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,171 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,177 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:39:07,198 - lightrag - ERROR - Failed to process document doc-e3650a7f846fb31b585b077e58621773: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,199 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,200 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,203 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:39:07,223 - lightrag - ERROR - Failed to process document doc-06e5b70cc8a8ab8bb1c205db2a669138: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,381 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,382 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,386 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:39:07,406 - lightrag - ERROR - Failed to process document doc-655676a109b2b7f92a97e56711d1eed9: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,408 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,409 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,413 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:39:07,433 - lightrag - ERROR - Failed to process document doc-882f24393e571fc7df234bfa3ea589fd: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,435 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,435 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,439 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:39:07,459 - lightrag - ERROR - Failed to process document doc-e0b8a955c42e993d8791278de66c73a8: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,460 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,461 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,465 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:39:07,485 - lightrag - ERROR - Failed to process document doc-eea8e04f5787a102f5c9030a34acec5d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,487 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,488 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,492 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:39:07,512 - lightrag - ERROR - Failed to process document doc-41a3610f94d72f7568c27ff0331f5a47: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,514 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,515 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,518 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:39:07,537 - lightrag - ERROR - Failed to process document doc-d2cc44040f2efa79f15cd5b17e367712: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,539 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,540 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,544 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:39:07,564 - lightrag - ERROR - Failed to process document doc-18226d9c385d92b931763363e9ec6e60: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,566 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,567 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,570 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:39:07,591 - lightrag - ERROR - Failed to process document doc-57c1b43ddc75b57a62a1b83dd899dc59: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,593 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,593 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,597 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:39:07,618 - lightrag - ERROR - Failed to process document doc-81d24eaf37847691a960643a1ddf309e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,619 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,620 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,624 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:39:07,644 - lightrag - ERROR - Failed to process document doc-f45f88879cf0fa540571e302f5d8ad4a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-09 18:39:07,646 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:39:07,646 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:07,652 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-09 18:39:26,705 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-09 18:39:26,705 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-09 18:39:26,705 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:39:26,705 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:39:26,706 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-09 18:39:26,707 - lightrag - INFO - Loaded document status storage with 17 records
2025-01-09 18:39:26,707 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:39:26,961 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:40:24,883 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-09 18:40:24,883 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-09 18:40:24,884 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 18:40:24,884 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 18:40:24,884 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-09 18:40:24,885 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:40:25,136 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:40:50,368 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:40:50,368 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:40:50,368 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:40:50,369 - lightrag - ERROR - Failed to process document doc-b5860ca977bbce889ed121b79b32fbfd: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:40:50,370 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:40:50,371 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:40:50,374 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:41:04,003 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:41:04,004 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:41:04,004 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:41:04,004 - lightrag - ERROR - Failed to process document doc-5b3dfa2411d0617404e06b9c2c767cc4: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:41:04,006 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:41:04,007 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:41:04,012 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-09 18:41:33,483 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:41:33,483 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:41:33,483 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:41:33,484 - lightrag - ERROR - Failed to process document doc-0c27ee4a65e2affcc9b5802f2fc689d9: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:41:33,485 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:41:33,486 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:41:33,491 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:41:50,659 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:41:50,660 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:41:50,660 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:41:50,660 - lightrag - ERROR - Failed to process document doc-8be1db76071d0ec7b0098e69e1c15767: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:41:50,662 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:41:50,663 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:41:50,667 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:42:02,075 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:42:02,075 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:42:02,075 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:42:02,076 - lightrag - ERROR - Failed to process document doc-e3650a7f846fb31b585b077e58621773: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:42:02,077 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:42:02,078 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:42:02,082 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:42:17,126 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:42:17,126 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:42:17,126 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:42:17,127 - lightrag - ERROR - Failed to process document doc-06e5b70cc8a8ab8bb1c205db2a669138: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:42:17,128 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:42:17,129 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:42:17,133 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:42:32,818 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:42:32,818 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:42:32,818 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:42:32,819 - lightrag - ERROR - Failed to process document doc-655676a109b2b7f92a97e56711d1eed9: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:42:32,821 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:42:32,821 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:42:32,825 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:42:50,138 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:42:50,138 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:42:50,139 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:42:50,139 - lightrag - ERROR - Failed to process document doc-882f24393e571fc7df234bfa3ea589fd: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:42:50,141 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:42:50,142 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:42:50,145 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:43:00,109 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:43:00,109 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:43:00,109 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:43:00,110 - lightrag - ERROR - Failed to process document doc-e0b8a955c42e993d8791278de66c73a8: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:43:00,112 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:43:00,113 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:43:00,117 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:43:17,558 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:43:17,559 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:43:17,559 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:43:17,560 - lightrag - ERROR - Failed to process document doc-eea8e04f5787a102f5c9030a34acec5d: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:43:17,562 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:43:17,562 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:43:17,566 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:43:37,148 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:43:37,149 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:43:37,149 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:43:37,149 - lightrag - ERROR - Failed to process document doc-41a3610f94d72f7568c27ff0331f5a47: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:43:37,152 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:43:37,152 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:43:37,156 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:43:50,892 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:43:50,892 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:43:50,892 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:43:50,893 - lightrag - ERROR - Failed to process document doc-d2cc44040f2efa79f15cd5b17e367712: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:43:50,895 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:43:50,896 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:43:50,900 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:44:18,077 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:44:18,077 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:44:18,077 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:44:18,078 - lightrag - ERROR - Failed to process document doc-18226d9c385d92b931763363e9ec6e60: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:44:18,080 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:44:18,081 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:44:18,085 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:44:39,702 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:44:39,702 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:44:39,702 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:44:39,703 - lightrag - ERROR - Failed to process document doc-57c1b43ddc75b57a62a1b83dd899dc59: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:44:39,706 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:44:39,706 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:44:39,710 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:44:51,832 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:44:51,832 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:44:51,832 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:44:51,833 - lightrag - ERROR - Failed to process document doc-81d24eaf37847691a960643a1ddf309e: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:44:51,837 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:44:51,838 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:44:51,844 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:45:18,870 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:45:18,870 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:45:18,870 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:45:18,871 - lightrag - ERROR - Failed to process document doc-f45f88879cf0fa540571e302f5d8ad4a: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:45:18,873 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:45:18,874 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:45:18,880 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-09 18:45:45,973 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:45:45,973 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:45:45,973 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:45:45,974 - lightrag - ERROR - Failed to process document doc-6398ecf19b5154a8d21a3ea3e5105ec9: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:45:45,977 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:45:45,978 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:45:45,982 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:45:54,477 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:45:54,477 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:45:54,477 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:45:54,478 - lightrag - ERROR - Failed to process document doc-6a991ed282145f64e064fff919209461: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:45:54,481 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:45:54,482 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:45:54,486 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:46:22,244 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:46:22,244 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:46:22,244 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:46:22,245 - lightrag - ERROR - Failed to process document doc-cc98b51a7ed119bfddcf8a70751e0514: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:46:22,248 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:46:22,248 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:46:22,253 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:46:37,689 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:46:37,689 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:46:37,689 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:46:37,690 - lightrag - ERROR - Failed to process document doc-90db909e3b48889db8cc9ea2aff35dc6: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:46:37,693 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:46:37,694 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:46:37,699 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-09 18:47:10,188 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:47:10,188 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:47:10,188 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:47:10,189 - lightrag - ERROR - Failed to process document doc-79f3c86e16a37b924e3013024688012b: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:47:10,192 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:47:10,193 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:47:10,198 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:47:32,321 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:47:32,321 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:47:32,321 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:47:32,322 - lightrag - ERROR - Failed to process document doc-bdf60c1a1defbf675623975d2d742716: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:47:32,326 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:47:32,326 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:47:32,330 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:47:42,944 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:47:42,944 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:47:42,945 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:47:42,945 - lightrag - ERROR - Failed to process document doc-be612b6205cec2e5646720704afbf2da: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:47:42,949 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:47:42,950 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:47:42,954 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:48:08,116 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:48:08,116 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:48:08,116 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:48:08,117 - lightrag - ERROR - Failed to process document doc-907c73b01580f5cc5ff5e2f35ddd4f37: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:48:08,121 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:48:08,121 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:48:08,125 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:48:28,347 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:48:28,347 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:48:28,348 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:48:28,348 - lightrag - ERROR - Failed to process document doc-be115f82250890d43e96cbea7213fcb3: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:48:28,352 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:48:28,353 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:48:28,358 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:48:42,961 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:48:42,961 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:48:42,961 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:48:42,962 - lightrag - ERROR - Failed to process document doc-24e39c86da0f6c2b279f58bcc10b720f: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:48:42,966 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:48:42,967 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:48:42,971 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:49:22,278 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:49:22,278 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:49:22,279 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:49:22,279 - lightrag - ERROR - Failed to process document doc-8e8833e6681e3ffd71be51ccd7b8197b: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:49:22,283 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:49:22,284 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:49:22,288 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:49:54,596 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:49:54,596 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:49:54,596 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:49:54,597 - lightrag - ERROR - Failed to process document doc-d66fa85bfd24f8a111cde9d372107c7c: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:49:54,601 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:49:54,602 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:49:54,606 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:50:04,987 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:50:04,987 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:50:04,987 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:50:04,988 - lightrag - ERROR - Failed to process document doc-3683b1716f647f35b90c7bbb935be50f: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:50:04,992 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:50:04,993 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:50:04,997 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:50:34,049 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:50:34,049 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:50:34,049 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:50:34,050 - lightrag - ERROR - Failed to process document doc-4513c304ff30ab6439b2f5fedf139835: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:50:34,054 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:50:34,055 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:50:34,059 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:51:01,818 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:51:01,819 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:51:01,819 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:51:01,820 - lightrag - ERROR - Failed to process document doc-1dba45d42c2c53003feb1b58a2e1e42e: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:51:01,824 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:51:01,825 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:51:01,829 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:51:28,001 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:51:28,001 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:51:28,001 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:51:28,002 - lightrag - ERROR - Failed to process document doc-547a3b29e1e7e8032ed931fc33ba74b4: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:51:28,006 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:51:28,007 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:51:28,011 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:51:46,388 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:51:46,388 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:51:46,389 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:51:46,389 - lightrag - ERROR - Failed to process document doc-2c66d27908cf9635706335bf5056664f: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:51:46,394 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:51:46,395 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:51:46,399 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:52:00,534 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:52:00,534 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:52:00,535 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:52:00,535 - lightrag - ERROR - Failed to process document doc-158aca418ddfe42db9b34c4f47212f3b: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:52:00,540 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:52:00,541 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:52:00,546 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:52:34,936 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:52:34,937 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:52:34,937 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:52:34,938 - lightrag - ERROR - Failed to process document doc-024b6ef73c8c9114ffe090d793e16309: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:52:34,943 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:52:34,943 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:52:34,949 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:53:06,530 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:53:06,530 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:53:06,531 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:53:06,531 - lightrag - ERROR - Failed to process document doc-5d16c38f6b8a35bc8fb9465ff77c8ede: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:53:06,536 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:53:06,537 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:53:06,543 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-09 18:53:33,332 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:53:33,332 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:53:33,332 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:53:33,333 - lightrag - ERROR - Failed to process document doc-bb2f29945bde0601a7bb8c71b6fcbc74: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:53:33,338 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:53:33,339 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:53:33,345 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:54:03,080 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:54:03,080 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:54:03,080 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:54:03,081 - lightrag - ERROR - Failed to process document doc-005a628f3a40c943e224f859b652baf2: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:54:03,086 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:54:03,087 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:54:03,091 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:54:24,842 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:54:24,842 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:54:24,843 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:54:24,843 - lightrag - ERROR - Failed to process document doc-2c4743c55cf70cbb64e05b1583703337: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:54:24,849 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:54:24,850 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:54:24,854 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:54:55,452 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:54:55,452 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:54:55,452 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:54:55,453 - lightrag - ERROR - Failed to process document doc-08497a24f311a04030976dc805096271: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:54:55,458 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:54:55,459 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:54:55,463 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:55:13,160 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:55:13,160 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:55:13,160 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:55:13,161 - lightrag - ERROR - Failed to process document doc-e9bd3875f4512326517a6ef2060650bd: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:55:13,167 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:55:13,168 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:55:13,173 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:55:50,420 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:55:50,420 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:55:50,421 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:55:50,421 - lightrag - ERROR - Failed to process document doc-c0769ad02f8527499eba3b9ad984cd1d: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:55:50,427 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:55:50,428 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:55:50,432 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:56:17,120 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:56:17,121 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:56:17,121 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:56:17,122 - lightrag - ERROR - Failed to process document doc-b3c995c883ae2dbff41e5a69ba48ad68: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:56:17,127 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:56:17,128 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:56:17,132 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:56:44,411 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:56:44,411 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:56:44,411 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:56:44,412 - lightrag - ERROR - Failed to process document doc-94778810caa9e8197d4686636805f41f: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:56:44,418 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:56:44,419 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:56:44,424 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:56:58,069 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:56:58,069 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:56:58,069 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:56:58,070 - lightrag - ERROR - Failed to process document doc-7e444b205770775b5dacac7b021f9825: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:56:58,077 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:56:58,077 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:56:58,081 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:57:07,975 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:57:07,976 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:57:07,976 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:57:07,977 - lightrag - ERROR - Failed to process document doc-fefe96a1118bd9effd68edd082c54ba9: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:57:07,983 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:57:07,984 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:57:07,990 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:57:30,414 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:57:30,415 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:57:30,415 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:57:30,416 - lightrag - ERROR - Failed to process document doc-e5631e530eba4883400e9e94f8790b3f: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:57:30,422 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:57:30,423 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:57:30,427 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:58:09,275 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:58:09,275 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:58:09,275 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:58:09,276 - lightrag - ERROR - Failed to process document doc-3e50ffc3d31d018baadebdfa3ba9f1b4: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:58:09,282 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:58:09,283 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:58:09,287 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:58:38,744 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:58:38,744 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:58:38,744 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:58:38,745 - lightrag - ERROR - Failed to process document doc-dcc83413f7a3c748599bc15f814b988d: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:58:38,752 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:58:38,753 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:58:38,756 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 18:58:54,068 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:58:54,068 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:58:54,068 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:58:54,070 - lightrag - ERROR - Failed to process document doc-dcaa5544e27acccadca1adc6033f93c2: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:58:54,078 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:58:54,078 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:58:54,084 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 18:59:26,001 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:59:26,001 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:59:26,001 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:59:26,002 - lightrag - ERROR - Failed to process document doc-9256bf37e2761c90dccf8d5f07b8883a: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:59:26,009 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:59:26,009 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:59:26,014 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 18:59:49,081 - lightrag - INFO - Inserting entities into storage...
2025-01-09 18:59:49,081 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 18:59:49,081 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 18:59:49,082 - lightrag - ERROR - Failed to process document doc-ca2ca3b630c6efb2a5d34624a493ff6d: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 18:59:49,089 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 18:59:49,090 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 18:59:49,095 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 19:00:10,951 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:00:10,951 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:00:10,951 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:00:10,952 - lightrag - ERROR - Failed to process document doc-6d7b9b5f29a01cb11d1ec025a35a4c6e: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:00:10,959 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:00:10,960 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:00:10,965 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 19:00:31,503 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:00:31,504 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:00:31,504 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:00:31,505 - lightrag - ERROR - Failed to process document doc-fd8c7184021d8a263eeb36dc07b97307: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:00:31,512 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:00:31,513 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:00:31,518 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:00:48,650 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:00:48,650 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:00:48,650 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:00:48,651 - lightrag - ERROR - Failed to process document doc-910e70ff6ef008a9d3010671f2f3831c: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:00:48,658 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:00:48,659 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:00:48,665 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 19:01:22,662 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:01:22,662 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:01:22,663 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:01:22,663 - lightrag - ERROR - Failed to process document doc-cfdf1589fd2393c3ac624bb5ede971ff: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:01:22,671 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:01:22,672 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:01:22,676 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:01:49,185 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:01:49,185 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:01:49,185 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:01:49,186 - lightrag - ERROR - Failed to process document doc-8d7fc174c740b8ce5ad391b8fda72eca: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:01:49,194 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:01:49,195 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:01:49,201 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 19:02:25,761 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:02:25,762 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:02:25,762 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:02:25,763 - lightrag - ERROR - Failed to process document doc-04f860882981bb931acdc415b1245b1d: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:02:25,774 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:02:25,775 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:02:25,782 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:02:56,774 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:02:56,774 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:02:56,774 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:02:56,775 - lightrag - ERROR - Failed to process document doc-cdd316e4e4dacd1592e85402a6cf725e: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:02:56,782 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:02:56,783 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:02:56,789 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 19:03:22,202 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:03:22,203 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:03:22,203 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:03:22,204 - lightrag - ERROR - Failed to process document doc-1246e0dcdc635d7e2d8309749824e9fd: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:03:22,211 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:03:22,212 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:03:22,218 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 19:03:48,186 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:03:48,186 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:03:48,186 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:03:48,187 - lightrag - ERROR - Failed to process document doc-324e31221872f3eba1c22d8632d41dfd: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:03:48,195 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:03:48,196 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:03:48,202 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 19:04:13,853 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:04:13,853 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:04:13,853 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:04:13,854 - lightrag - ERROR - Failed to process document doc-32bf6d8aafe4cdaafc48c366ddd98124: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:04:13,862 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:04:13,863 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:04:13,867 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:04:39,980 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:04:39,980 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:04:39,981 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:04:39,982 - lightrag - ERROR - Failed to process document doc-88e810f9301c32a30cf2d50e2aa2a8e4: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:04:39,990 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:04:39,991 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:04:39,996 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 19:05:09,275 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:05:09,275 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:05:09,276 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:05:09,277 - lightrag - ERROR - Failed to process document doc-0efab6c6d1af1e2f8b9b4092a4b42cf7: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:05:09,285 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:05:09,286 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:05:09,290 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:05:33,361 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:05:33,362 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:05:33,362 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:05:33,363 - lightrag - ERROR - Failed to process document doc-02f4e3043bb1be6ee74a01ec472cc794: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:05:33,372 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:05:33,373 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:05:33,377 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-09 19:05:49,380 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:05:49,380 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:05:49,380 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:05:49,382 - lightrag - ERROR - Failed to process document doc-19a4dec464ace946431e1b9642507a8b: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:05:49,390 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:05:49,391 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:05:49,396 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 19:06:19,776 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:06:19,776 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:06:19,776 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:06:19,777 - lightrag - ERROR - Failed to process document doc-838a8c6f65548c753be483511b66505d: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:06:19,786 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:06:19,787 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:06:19,792 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:06:50,702 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:06:50,702 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:06:50,703 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:06:50,704 - lightrag - ERROR - Failed to process document doc-09e618a6208d6f13a62c113701678de8: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:06:50,712 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:06:50,713 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:06:50,720 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-09 19:07:31,200 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:07:31,200 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:07:31,200 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:07:31,201 - lightrag - ERROR - Failed to process document doc-671bd6ee4fe2bc79f58c819b2aea4192: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:07:31,210 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:07:31,211 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:07:31,216 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:08:09,139 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:08:09,139 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:08:09,139 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:08:09,141 - lightrag - ERROR - Failed to process document doc-48e8438aa6314bb645cc0281c1eb3025: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:08:09,149 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:08:09,150 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:08:09,155 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:08:40,470 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:08:40,470 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:08:40,471 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:08:40,472 - lightrag - ERROR - Failed to process document doc-0a7ced13c5bf885f0a6f96271b962cda: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:08:40,481 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:08:40,482 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:08:40,487 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:09:03,881 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:09:03,881 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:09:03,881 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:09:03,883 - lightrag - ERROR - Failed to process document doc-a77921fdd1ac08159ee6738c9ae42298: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:09:03,897 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:09:03,898 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:09:03,905 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:09:26,569 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:09:26,569 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:09:26,569 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:09:26,570 - lightrag - ERROR - Failed to process document doc-414f103b505fa4e79efb85055a928e20: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:09:26,580 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:09:26,580 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:09:26,585 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:09:52,716 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:09:52,716 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:09:52,716 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:09:52,717 - lightrag - ERROR - Failed to process document doc-a8b7ce8ebd7f19ab2579b9cf340bd0f4: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:09:52,726 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:09:52,727 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:09:52,732 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:10:21,168 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:10:21,168 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:10:21,168 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:10:21,170 - lightrag - ERROR - Failed to process document doc-92d4c6b3c5bd0d124a0a8d2b659e8bc2: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:10:21,185 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:10:21,186 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:10:21,190 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:10:51,329 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:10:51,330 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:10:51,330 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:10:51,331 - lightrag - ERROR - Failed to process document doc-db6d76bf698c784785563e881c38bd76: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:10:51,341 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:10:51,341 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:10:51,346 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:11:27,188 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:11:27,188 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:11:27,188 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:11:27,189 - lightrag - ERROR - Failed to process document doc-dc893821778ee35bda85d53219ed6144: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:11:27,199 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:11:27,200 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:11:27,205 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:11:53,570 - lightrag - INFO - Inserting entities into storage...
2025-01-09 19:11:53,570 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 19:11:53,571 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-09 19:11:53,572 - lightrag - ERROR - Failed to process document doc-bc7309a93dd499de04a5ff53e07a3364: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-09 19:11:53,582 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-09 19:11:53,582 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:11:53,587 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 19:12:56,894 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-09 19:12:56,894 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-09 19:12:56,895 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-09 19:12:56,895 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-09 19:12:56,895 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-09 19:12:56,896 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 19:12:57,153 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 20:14:21,881 - lightrag - INFO - Inserting entities into storage...
2025-01-09 20:14:21,890 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 20:14:21,892 - lightrag - INFO - Inserting 103 vectors to entities
2025-01-09 20:14:23,652 - lightrag - INFO - Inserting 34 vectors to relationships
2025-01-09 20:14:23,889 - lightrag - INFO - Writing graph with 131 nodes, 34 edges
2025-01-09 20:14:23,897 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 20:14:23,900 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-09 21:18:38,862 - lightrag - INFO - Inserting entities into storage...
2025-01-09 21:18:38,872 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 21:18:38,872 - lightrag - WARNING - Didn't extract any relationships
2025-01-09 21:18:38,873 - lightrag - INFO - Inserting 47 vectors to entities
2025-01-09 21:18:40,226 - lightrag - INFO - Inserting 0 vectors to relationships
2025-01-09 21:18:40,226 - lightrag - WARNING - You insert an empty data to vector DB
2025-01-09 21:18:40,234 - lightrag - INFO - Writing graph with 162 nodes, 34 edges
2025-01-09 21:18:40,237 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 21:18:40,243 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-09 21:25:23,845 - lightrag - INFO - Inserting entities into storage...
2025-01-09 21:25:23,861 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 21:25:23,863 - lightrag - INFO - Inserting 148 vectors to entities
2025-01-09 21:25:25,940 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-09 21:25:26,091 - lightrag - INFO - Writing graph with 295 nodes, 55 edges
2025-01-09 21:25:26,100 - lightrag - INFO - Processing 1 new unique documents
2025-01-09 21:25:26,105 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-09 21:32:29,484 - lightrag - INFO - Inserting entities into storage...
2025-01-09 21:32:29,497 - lightrag - INFO - Inserting relationships into storage...
2025-01-09 21:32:29,500 - lightrag - INFO - Inserting 143 vectors to entities
2025-01-09 21:32:31,496 - lightrag - INFO - Inserting 97 vectors to relationships
2025-01-10 02:54:33,942 - lightrag - INFO - Writing graph with 459 nodes, 152 edges
2025-01-10 02:54:33,956 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 02:54:33,960 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 02:55:37,643 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 02:55:37,643 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 02:55:37,644 - lightrag - INFO - Load KV full_docs with 4 data
2025-01-10 02:55:37,645 - lightrag - INFO - Load KV text_chunks with 20 data
2025-01-10 02:55:37,788 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 459 nodes, 152 edges
2025-01-10 02:55:37,796 - lightrag - INFO - Loaded document status storage with 5 records
2025-01-10 02:55:37,796 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 02:55:37,796 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 02:55:37,797 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 02:55:37,797 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 02:55:37,797 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 02:55:38,062 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 02:57:03,775 - lightrag - INFO - Inserting entities into storage...
2025-01-10 02:57:03,784 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 02:57:03,786 - lightrag - INFO - Inserting 105 vectors to entities
2025-01-10 02:57:04,513 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-10 02:57:04,710 - lightrag - INFO - Writing graph with 519 nodes, 178 edges
2025-01-10 02:57:04,723 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 02:57:04,727 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 02:58:06,875 - lightrag - INFO - Inserting entities into storage...
2025-01-10 02:58:06,887 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 02:58:06,888 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-10 02:58:07,191 - lightrag - INFO - Inserting 43 vectors to relationships
2025-01-10 02:58:07,485 - lightrag - INFO - Writing graph with 552 nodes, 221 edges
2025-01-10 02:58:07,499 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 02:58:07,503 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 02:59:57,395 - lightrag - INFO - Inserting entities into storage...
2025-01-10 02:59:57,408 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 02:59:57,409 - lightrag - INFO - Inserting 70 vectors to entities
2025-01-10 02:59:57,886 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-10 02:59:58,185 - lightrag - INFO - Writing graph with 585 nodes, 261 edges
2025-01-10 02:59:58,201 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 02:59:58,205 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:02:07,891 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:02:07,904 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:02:07,906 - lightrag - INFO - Inserting 98 vectors to entities
2025-01-10 03:02:08,573 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-10 03:02:08,740 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:02:08,757 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:02:08,760 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 03:10:19,450 - lightrag - ERROR - Failed to process document doc-e0b8a955c42e993d8791278de66c73a8: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 316, in _process_single_content
    glean_result = await use_llm_func(continue_prompt, history_messages=history)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-10 03:10:19,477 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:19,497 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:19,501 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:10:19,522 - lightrag - ERROR - Failed to process document doc-eea8e04f5787a102f5c9030a34acec5d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:19,549 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:19,563 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:19,566 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:10:19,587 - lightrag - ERROR - Failed to process document doc-41a3610f94d72f7568c27ff0331f5a47: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:19,615 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:19,630 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:19,633 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 03:10:19,654 - lightrag - ERROR - Failed to process document doc-d2cc44040f2efa79f15cd5b17e367712: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:19,681 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:19,694 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:19,698 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:10:19,718 - lightrag - ERROR - Failed to process document doc-18226d9c385d92b931763363e9ec6e60: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:19,745 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:19,759 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:19,763 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:10:19,783 - lightrag - ERROR - Failed to process document doc-57c1b43ddc75b57a62a1b83dd899dc59: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:19,811 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:19,828 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:19,833 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 03:10:19,856 - lightrag - ERROR - Failed to process document doc-81d24eaf37847691a960643a1ddf309e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:19,882 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:19,896 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:19,899 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:10:19,920 - lightrag - ERROR - Failed to process document doc-f45f88879cf0fa540571e302f5d8ad4a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:19,948 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:19,961 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:19,967 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 03:10:19,987 - lightrag - ERROR - Failed to process document doc-6398ecf19b5154a8d21a3ea3e5105ec9: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:20,014 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:20,027 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:20,031 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 03:10:20,051 - lightrag - ERROR - Failed to process document doc-6a991ed282145f64e064fff919209461: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:20,078 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:20,092 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:20,096 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:10:20,119 - lightrag - ERROR - Failed to process document doc-cc98b51a7ed119bfddcf8a70751e0514: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:20,148 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:20,163 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:20,167 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:10:20,189 - lightrag - ERROR - Failed to process document doc-90db909e3b48889db8cc9ea2aff35dc6: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:20,217 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:20,232 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:20,237 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 03:10:20,260 - lightrag - ERROR - Failed to process document doc-79f3c86e16a37b924e3013024688012b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:20,288 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:20,303 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:20,308 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:10:20,328 - lightrag - ERROR - Failed to process document doc-bdf60c1a1defbf675623975d2d742716: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:20,357 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:20,518 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:20,522 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 03:10:20,542 - lightrag - ERROR - Failed to process document doc-be612b6205cec2e5646720704afbf2da: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:20,570 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:20,585 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:20,589 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:10:20,609 - lightrag - ERROR - Failed to process document doc-907c73b01580f5cc5ff5e2f35ddd4f37: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:20,637 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:20,652 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:20,656 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:10:20,676 - lightrag - ERROR - Failed to process document doc-be115f82250890d43e96cbea7213fcb3: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 03:10:20,705 - lightrag - INFO - Writing graph with 614 nodes, 283 edges
2025-01-10 03:10:20,720 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:20,725 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:10:52,909 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 03:10:52,909 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 03:10:52,909 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 03:10:52,909 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 03:10:52,910 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 03:10:52,911 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:10:53,170 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:12:59,525 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:12:59,532 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:12:59,534 - lightrag - INFO - Inserting 197 vectors to entities
2025-01-10 03:13:02,401 - lightrag - INFO - Inserting 29 vectors to relationships
2025-01-10 03:13:04,461 - lightrag - INFO - Writing graph with 197 nodes, 29 edges
2025-01-10 03:13:04,475 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:13:04,479 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:23:21,989 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:23:22,012 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:23:22,014 - lightrag - INFO - Inserting 281 vectors to entities
2025-01-10 03:23:25,820 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-10 03:23:26,968 - lightrag - INFO - Writing graph with 326 nodes, 40 edges
2025-01-10 03:23:26,988 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:23:26,995 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 03:27:58,559 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:27:58,579 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:27:58,581 - lightrag - INFO - Inserting 320 vectors to entities
2025-01-10 03:28:02,179 - lightrag - INFO - Inserting 39 vectors to relationships
2025-01-10 03:28:04,613 - lightrag - INFO - Writing graph with 380 nodes, 79 edges
2025-01-10 03:28:04,620 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:28:04,625 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:29:32,559 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:29:32,574 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:29:32,576 - lightrag - INFO - Inserting 210 vectors to entities
2025-01-10 03:29:35,481 - lightrag - INFO - Inserting 51 vectors to relationships
2025-01-10 03:29:37,356 - lightrag - INFO - Writing graph with 466 nodes, 127 edges
2025-01-10 03:29:37,370 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:29:37,375 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:33:02,212 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:33:02,232 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:33:02,233 - lightrag - INFO - Inserting 214 vectors to entities
2025-01-10 03:33:05,177 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-10 03:33:06,631 - lightrag - INFO - Writing graph with 482 nodes, 144 edges
2025-01-10 03:33:06,648 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:33:06,652 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:35:02,739 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:35:02,752 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:35:02,754 - lightrag - INFO - Inserting 118 vectors to entities
2025-01-10 03:35:05,677 - lightrag - INFO - Inserting 49 vectors to relationships
2025-01-10 03:35:07,893 - lightrag - INFO - Writing graph with 492 nodes, 179 edges
2025-01-10 03:35:07,909 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:35:07,913 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:37:40,972 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:37:41,002 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:37:41,005 - lightrag - INFO - Inserting 295 vectors to entities
2025-01-10 03:37:44,421 - lightrag - INFO - Inserting 34 vectors to relationships
2025-01-10 03:37:47,236 - lightrag - INFO - Writing graph with 635 nodes, 193 edges
2025-01-10 03:37:47,263 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:37:47,267 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:41:43,010 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:41:43,043 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:41:43,045 - lightrag - INFO - Inserting 270 vectors to entities
2025-01-10 03:41:46,377 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-10 03:41:48,081 - lightrag - INFO - Writing graph with 651 nodes, 209 edges
2025-01-10 03:41:48,105 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:41:48,108 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 03:43:32,211 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:43:32,236 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:43:32,237 - lightrag - INFO - Inserting 183 vectors to entities
2025-01-10 03:43:35,124 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-10 03:43:36,647 - lightrag - INFO - Writing graph with 664 nodes, 216 edges
2025-01-10 03:43:36,673 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:43:36,676 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:45:20,903 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:45:20,944 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:45:20,945 - lightrag - INFO - Inserting 253 vectors to entities
2025-01-10 03:45:24,262 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-10 03:45:25,352 - lightrag - INFO - Writing graph with 679 nodes, 229 edges
2025-01-10 03:45:25,375 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:45:25,379 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:49:09,832 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:49:13,019 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:49:13,022 - lightrag - INFO - Inserting 284 vectors to entities
2025-01-10 03:49:16,327 - lightrag - INFO - Inserting 39 vectors to relationships
2025-01-10 03:49:19,046 - lightrag - INFO - Writing graph with 686 nodes, 261 edges
2025-01-10 03:49:19,066 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:49:19,070 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 03:51:40,811 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 03:51:40,811 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 03:51:40,811 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 03:51:40,811 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 03:51:40,812 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 03:51:40,813 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:51:41,056 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:52:21,113 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 03:52:21,114 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 03:52:21,114 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 03:52:21,114 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 03:52:21,114 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 03:52:21,115 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:52:21,365 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:52:29,944 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:52:29,979 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:52:29,980 - lightrag - INFO - Inserting 177 vectors to entities
2025-01-10 03:52:32,796 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-10 03:52:35,234 - lightrag - INFO - Writing graph with 692 nodes, 282 edges
2025-01-10 03:52:35,262 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:52:35,267 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:53:39,526 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:53:39,526 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:53:39,527 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-10 03:53:39,527 - lightrag - ERROR - Failed to process document doc-b5860ca977bbce889ed121b79b32fbfd: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-10 03:53:39,528 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 03:53:39,529 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:53:39,533 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:55:15,721 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 03:55:15,722 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 03:55:15,722 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 03:55:15,722 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 03:55:15,723 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-10 03:55:15,724 - lightrag - INFO - Loaded document status storage with 2 records
2025-01-10 03:55:15,724 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:55:15,974 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:55:28,609 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 03:55:28,609 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 03:55:28,610 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 03:55:28,610 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 03:55:28,610 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 03:55:28,611 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:55:28,871 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:56:24,911 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 03:56:24,912 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 03:56:24,912 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 03:56:24,912 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 03:56:24,913 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-10 03:56:24,913 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:56:25,164 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 03:57:59,542 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:57:59,612 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:57:59,614 - lightrag - INFO - Inserting 243 vectors to entities
2025-01-10 03:58:02,760 - lightrag - INFO - Inserting 29 vectors to relationships
2025-01-10 03:58:04,803 - lightrag - INFO - Writing graph with 713 nodes, 302 edges
2025-01-10 03:58:04,834 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 03:58:04,840 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 03:58:11,447 - lightrag - INFO - Inserting entities into storage...
2025-01-10 03:58:11,447 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 03:58:11,447 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-10 03:58:11,448 - lightrag - ERROR - Failed to process document doc-b5860ca977bbce889ed121b79b32fbfd: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 401, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-10 03:58:11,448 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 03:58:12,509 - lightrag - WARNING - No high level context found. Switching to local mode.
2025-01-10 04:01:21,947 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:01:22,010 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:01:22,012 - lightrag - INFO - Inserting 282 vectors to entities
2025-01-10 04:01:25,410 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-10 04:01:27,524 - lightrag - INFO - Writing graph with 722 nodes, 315 edges
2025-01-10 04:01:27,551 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:01:27,555 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 04:04:28,231 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:04:32,806 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:04:32,808 - lightrag - INFO - Inserting 204 vectors to entities
2025-01-10 04:04:36,131 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-10 04:04:37,569 - lightrag - INFO - Writing graph with 730 nodes, 316 edges
2025-01-10 04:04:37,798 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:04:37,801 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:07:00,037 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:07:04,942 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:07:04,945 - lightrag - INFO - Inserting 279 vectors to entities
2025-01-10 04:07:09,295 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-10 04:07:11,082 - lightrag - INFO - Writing graph with 739 nodes, 317 edges
2025-01-10 04:07:11,113 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:07:11,119 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 04:11:43,887 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:11:50,422 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:11:50,425 - lightrag - INFO - Inserting 337 vectors to entities
2025-01-10 04:11:54,262 - lightrag - INFO - Inserting 48 vectors to relationships
2025-01-10 04:11:56,904 - lightrag - INFO - Writing graph with 797 nodes, 356 edges
2025-01-10 04:11:56,935 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:11:56,939 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 04:15:45,631 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:15:50,403 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:15:50,406 - lightrag - INFO - Inserting 236 vectors to entities
2025-01-10 04:15:53,925 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-10 04:15:56,298 - lightrag - INFO - Writing graph with 820 nodes, 366 edges
2025-01-10 04:15:56,322 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:15:56,326 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:19:58,874 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:20:07,761 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:20:07,764 - lightrag - INFO - Inserting 235 vectors to entities
2025-01-10 04:20:13,457 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-10 04:20:15,703 - lightrag - INFO - Writing graph with 822 nodes, 369 edges
2025-01-10 04:20:15,958 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:20:15,988 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:23:49,337 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:23:55,772 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:23:55,776 - lightrag - INFO - Inserting 208 vectors to entities
2025-01-10 04:23:59,340 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-10 04:24:01,588 - lightrag - INFO - Writing graph with 832 nodes, 381 edges
2025-01-10 04:24:01,619 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:24:01,626 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 04:26:07,469 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:26:31,958 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:26:31,961 - lightrag - INFO - Inserting 294 vectors to entities
2025-01-10 04:26:35,452 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-10 04:26:37,491 - lightrag - INFO - Writing graph with 850 nodes, 397 edges
2025-01-10 04:26:37,516 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:26:37,520 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 04:29:53,877 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:30:00,343 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:30:00,347 - lightrag - INFO - Inserting 297 vectors to entities
2025-01-10 04:30:03,988 - lightrag - INFO - Inserting 46 vectors to relationships
2025-01-10 04:30:05,968 - lightrag - INFO - Writing graph with 859 nodes, 420 edges
2025-01-10 04:30:06,222 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:30:06,226 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 04:31:26,212 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 04:31:26,212 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-10 04:31:26,213 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 04:31:26,213 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 04:31:26,214 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-10 04:31:26,215 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-10 04:31:26,215 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:31:26,466 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 04:33:02,833 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:33:10,825 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:33:10,832 - lightrag - INFO - Inserting 196 vectors to entities
2025-01-10 04:33:14,232 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-10 04:33:15,967 - lightrag - INFO - Writing graph with 863 nodes, 429 edges
2025-01-10 04:33:16,010 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:33:16,015 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:36:57,115 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:37:03,108 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:37:03,114 - lightrag - INFO - Inserting 264 vectors to entities
2025-01-10 04:37:07,106 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-10 04:37:09,497 - lightrag - INFO - Writing graph with 874 nodes, 436 edges
2025-01-10 04:37:09,578 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:37:09,584 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:38:38,242 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 04:38:38,243 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 04:38:38,243 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 04:38:38,243 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 04:38:38,243 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 04:38:38,244 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:38:38,498 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 04:40:52,537 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:41:06,253 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:41:06,259 - lightrag - INFO - Inserting 290 vectors to entities
2025-01-10 04:41:09,967 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-10 04:41:11,799 - lightrag - INFO - Writing graph with 892 nodes, 440 edges
2025-01-10 04:41:11,859 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:41:11,865 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:46:27,609 - lightrag - ERROR - Failed to process document doc-b5860ca977bbce889ed121b79b32fbfd: [Errno 2] No such file or directory: './contemi_opensrc/kv_store_doc_status.json'
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 316, in _process_single_content
    glean_result = await use_llm_func(continue_prompt, history_messages=history)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: POST predict: Post "http://127.0.0.1:34915/completion": EOF

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 431, in ainsert
    await self.doc_status.upsert({doc_id: doc_status})
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 445, in upsert
    await self.index_done_callback()
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 436, in index_done_callback
    write_json(self._data, self._file_name)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 154, in write_json
    with open(file_name, "w", encoding="utf-8") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: './contemi_opensrc/kv_store_doc_status.json'

2025-01-10 04:46:27,610 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:46:47,365 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 04:46:47,365 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 04:46:47,365 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 04:46:47,366 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 04:46:47,366 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 04:46:47,367 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:46:47,617 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 04:47:33,518 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:47:36,672 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:47:36,679 - lightrag - INFO - Inserting 118 vectors to entities
2025-01-10 04:47:39,702 - lightrag - INFO - Inserting 34 vectors to relationships
2025-01-10 04:47:42,498 - lightrag - INFO - Writing graph with 912 nodes, 463 edges
2025-01-10 04:47:42,539 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 04:47:42,545 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 04:50:35,300 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 04:50:35,300 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 04:50:35,301 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 04:50:35,301 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 04:50:35,301 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 04:50:35,303 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 04:50:35,559 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:48,785 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 04:52:48,786 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 04:52:48,786 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 04:52:48,786 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 04:52:48,786 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-10 04:52:48,788 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 04:52:49,044 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 04:52:49,067 - lightrag - ERROR - Failed to process document doc-8be1db76071d0ec7b0098e69e1c15767: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,068 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,072 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,092 - lightrag - ERROR - Failed to process document doc-5b3dfa2411d0617404e06b9c2c767cc4: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,094 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,098 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,118 - lightrag - ERROR - Failed to process document doc-06e5b70cc8a8ab8bb1c205db2a669138: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,119 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,123 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,144 - lightrag - ERROR - Failed to process document doc-655676a109b2b7f92a97e56711d1eed9: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,145 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,148 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 04:52:49,168 - lightrag - ERROR - Failed to process document doc-e0b8a955c42e993d8791278de66c73a8: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,169 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,172 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,192 - lightrag - ERROR - Failed to process document doc-eea8e04f5787a102f5c9030a34acec5d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,328 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,333 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 04:52:49,354 - lightrag - ERROR - Failed to process document doc-b5860ca977bbce889ed121b79b32fbfd: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,355 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,359 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,379 - lightrag - ERROR - Failed to process document doc-882f24393e571fc7df234bfa3ea589fd: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,380 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,384 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,404 - lightrag - ERROR - Failed to process document doc-e3650a7f846fb31b585b077e58621773: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,406 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,411 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 04:52:49,431 - lightrag - ERROR - Failed to process document doc-0c27ee4a65e2affcc9b5802f2fc689d9: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,432 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,434 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 04:52:49,438 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,457 - lightrag - ERROR - Failed to process document doc-90db909e3b48889db8cc9ea2aff35dc6: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,459 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,462 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,482 - lightrag - ERROR - Failed to process document doc-57c1b43ddc75b57a62a1b83dd899dc59: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,483 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,486 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 04:52:49,506 - lightrag - ERROR - Failed to process document doc-d2cc44040f2efa79f15cd5b17e367712: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,508 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,512 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,532 - lightrag - ERROR - Failed to process document doc-41a3610f94d72f7568c27ff0331f5a47: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,534 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,538 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:52:49,557 - lightrag - ERROR - Failed to process document doc-f45f88879cf0fa540571e302f5d8ad4a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,559 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,563 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 04:52:49,583 - lightrag - ERROR - Failed to process document doc-18226d9c385d92b931763363e9ec6e60: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 04:52:49,584 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-10 04:52:49,590 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 04:54:02,880 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 04:54:02,881 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 04:54:02,881 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 04:54:02,881 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 04:54:02,881 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 04:54:02,883 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 04:54:03,148 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 04:59:24,922 - lightrag - INFO - Inserting entities into storage...
2025-01-10 04:59:24,933 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 04:59:24,935 - lightrag - INFO - Inserting 303 vectors to entities
2025-01-10 04:59:28,405 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-10 04:59:30,438 - lightrag - INFO - Writing graph with 305 nodes, 31 edges
2025-01-10 04:59:30,449 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:04:44,425 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:04:44,440 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:04:44,441 - lightrag - INFO - Inserting 275 vectors to entities
2025-01-10 05:04:47,750 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-10 05:04:49,219 - lightrag - INFO - Writing graph with 328 nodes, 35 edges
2025-01-10 05:04:49,230 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:06:49,656 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:06:49,675 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:06:49,676 - lightrag - INFO - Inserting 262 vectors to entities
2025-01-10 05:06:53,060 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-10 05:06:54,814 - lightrag - INFO - Writing graph with 338 nodes, 46 edges
2025-01-10 05:06:54,826 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:10:25,174 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:10:25,187 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:10:25,189 - lightrag - INFO - Inserting 161 vectors to entities
2025-01-10 05:10:28,311 - lightrag - INFO - Inserting 34 vectors to relationships
2025-01-10 05:10:30,264 - lightrag - INFO - Writing graph with 352 nodes, 75 edges
2025-01-10 05:10:30,285 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:12:25,379 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:12:25,393 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:12:25,395 - lightrag - INFO - Inserting 147 vectors to entities
2025-01-10 05:12:28,703 - lightrag - INFO - Inserting 36 vectors to relationships
2025-01-10 05:12:31,523 - lightrag - INFO - Writing graph with 366 nodes, 110 edges
2025-01-10 05:12:31,541 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 05:13:57,312 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:13:57,332 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:13:57,334 - lightrag - INFO - Inserting 180 vectors to entities
2025-01-10 05:14:00,108 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-10 05:14:00,863 - lightrag - INFO - Writing graph with 374 nodes, 114 edges
2025-01-10 05:14:00,880 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 05:17:10,804 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:17:10,852 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:17:10,855 - lightrag - INFO - Inserting 315 vectors to entities
2025-01-10 05:17:14,194 - lightrag - INFO - Inserting 45 vectors to relationships
2025-01-10 05:17:16,806 - lightrag - INFO - Writing graph with 418 nodes, 152 edges
2025-01-10 05:17:16,834 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 05:18:59,285 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:18:59,298 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:18:59,300 - lightrag - INFO - Inserting 97 vectors to entities
2025-01-10 05:19:01,983 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-10 05:19:04,272 - lightrag - INFO - Writing graph with 440 nodes, 181 edges
2025-01-10 05:19:04,296 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:23:27,484 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:23:27,521 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:23:27,523 - lightrag - INFO - Inserting 280 vectors to entities
2025-01-10 05:23:31,094 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-10 05:23:32,988 - lightrag - INFO - Writing graph with 457 nodes, 207 edges
2025-01-10 05:23:33,005 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 05:26:50,010 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:26:53,480 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:26:53,483 - lightrag - INFO - Inserting 207 vectors to entities
2025-01-10 05:26:56,309 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-10 05:26:58,741 - lightrag - INFO - Writing graph with 490 nodes, 234 edges
2025-01-10 05:26:58,765 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 05:26:58,769 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:30:42,051 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:30:42,087 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:30:42,089 - lightrag - INFO - Inserting 224 vectors to entities
2025-01-10 05:30:45,265 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-10 05:30:47,358 - lightrag - INFO - Writing graph with 519 nodes, 248 edges
2025-01-10 05:30:47,376 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 05:33:37,074 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:33:37,120 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:33:37,122 - lightrag - INFO - Inserting 222 vectors to entities
2025-01-10 05:33:40,493 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-10 05:33:42,602 - lightrag - INFO - Writing graph with 537 nodes, 270 edges
2025-01-10 05:33:42,627 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 05:36:50,158 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:36:50,198 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:36:50,199 - lightrag - INFO - Inserting 196 vectors to entities
2025-01-10 05:36:53,325 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-10 05:36:54,795 - lightrag - INFO - Writing graph with 546 nodes, 273 edges
2025-01-10 05:36:54,825 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:38:52,933 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:38:52,998 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:38:53,000 - lightrag - INFO - Inserting 276 vectors to entities
2025-01-10 05:38:56,530 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-10 05:38:58,266 - lightrag - INFO - Writing graph with 554 nodes, 280 edges
2025-01-10 05:38:58,296 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 05:41:36,856 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:41:36,901 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:41:36,903 - lightrag - INFO - Inserting 178 vectors to entities
2025-01-10 05:41:39,612 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-10 05:41:41,332 - lightrag - INFO - Writing graph with 558 nodes, 290 edges
2025-01-10 05:41:41,361 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:43:57,443 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:44:00,820 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:44:00,822 - lightrag - INFO - Inserting 261 vectors to entities
2025-01-10 05:44:04,041 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-10 05:44:05,452 - lightrag - INFO - Writing graph with 577 nodes, 293 edges
2025-01-10 05:44:05,480 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 05:47:39,998 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:47:45,398 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:47:45,400 - lightrag - INFO - Inserting 266 vectors to entities
2025-01-10 05:47:49,190 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-10 05:47:51,586 - lightrag - INFO - Writing graph with 579 nodes, 301 edges
2025-01-10 05:47:51,613 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 05:50:12,328 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:50:17,101 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:50:17,105 - lightrag - INFO - Inserting 332 vectors to entities
2025-01-10 05:50:20,775 - lightrag - INFO - Inserting 50 vectors to relationships
2025-01-10 05:50:23,535 - lightrag - INFO - Writing graph with 623 nodes, 334 edges
2025-01-10 05:50:23,556 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:55:21,643 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:55:25,688 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:55:25,691 - lightrag - INFO - Inserting 280 vectors to entities
2025-01-10 05:55:29,095 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-10 05:55:31,865 - lightrag - INFO - Writing graph with 633 nodes, 355 edges
2025-01-10 05:55:31,898 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 05:59:35,565 - lightrag - INFO - Inserting entities into storage...
2025-01-10 05:59:43,654 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 05:59:43,656 - lightrag - INFO - Inserting 229 vectors to entities
2025-01-10 05:59:47,221 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-10 05:59:48,370 - lightrag - INFO - Writing graph with 642 nodes, 356 edges
2025-01-10 05:59:48,392 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 05:59:48,396 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 06:03:02,442 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:03:11,705 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:03:11,709 - lightrag - INFO - Inserting 237 vectors to entities
2025-01-10 06:03:15,114 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-10 06:03:17,537 - lightrag - INFO - Writing graph with 665 nodes, 364 edges
2025-01-10 06:03:17,567 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:07:03,399 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:07:12,051 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:07:12,054 - lightrag - INFO - Inserting 276 vectors to entities
2025-01-10 06:07:15,450 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-10 06:07:17,331 - lightrag - INFO - Writing graph with 668 nodes, 368 edges
2025-01-10 06:07:17,355 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:08:15,598 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 06:08:15,598 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 06:08:15,599 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 06:08:15,599 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 06:08:15,599 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-10 06:08:15,601 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 06:08:15,866 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 06:11:09,164 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:11:16,234 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:11:16,237 - lightrag - INFO - Inserting 267 vectors to entities
2025-01-10 06:11:19,831 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-10 06:11:21,065 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:11:21,075 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:11:21,077 - lightrag - INFO - Inserting 62 vectors to entities
2025-01-10 06:11:21,518 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-10 06:11:21,753 - lightrag - INFO - Writing graph with 73 nodes, 33 edges
2025-01-10 06:11:21,761 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:11:22,154 - lightrag - INFO - Writing graph with 682 nodes, 377 edges
2025-01-10 06:11:22,179 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:15:11,843 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:15:16,175 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:15:16,177 - lightrag - INFO - Inserting 290 vectors to entities
2025-01-10 06:15:19,707 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-10 06:15:21,487 - lightrag - INFO - Writing graph with 701 nodes, 397 edges
2025-01-10 06:15:21,514 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:19:20,961 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:19:27,097 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:19:27,100 - lightrag - INFO - Inserting 258 vectors to entities
2025-01-10 06:19:33,220 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-10 06:19:35,058 - lightrag - INFO - Writing graph with 711 nodes, 403 edges
2025-01-10 06:19:35,092 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 06:19:40,392 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 06:19:40,392 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 06:19:40,393 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-10 06:19:40,393 - lightrag - INFO - Load KV text_chunks with 5 data
2025-01-10 06:19:40,395 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 73 nodes, 33 edges
2025-01-10 06:19:40,398 - lightrag - INFO - Loaded document status storage with 2 records
2025-01-10 06:19:40,399 - lightrag - INFO - Processing 9 new unique documents
2025-01-10 06:19:40,664 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 06:21:04,571 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:21:04,580 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:21:04,580 - lightrag - INFO - Inserting 83 vectors to entities
2025-01-10 06:21:05,181 - lightrag - INFO - Inserting 1 vectors to relationships
2025-01-10 06:21:05,213 - lightrag - INFO - Writing graph with 147 nodes, 34 edges
2025-01-10 06:21:05,224 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:21:49,762 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:21:53,758 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:21:53,760 - lightrag - INFO - Inserting 128 vectors to entities
2025-01-10 06:21:57,095 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-10 06:21:57,897 - lightrag - INFO - Writing graph with 712 nodes, 405 edges
2025-01-10 06:21:57,934 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 06:22:39,739 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:22:39,748 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:22:39,749 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-10 06:22:40,026 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-10 06:22:40,233 - lightrag - INFO - Writing graph with 195 nodes, 66 edges
2025-01-10 06:22:40,242 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:25:29,376 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:25:34,217 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:25:34,222 - lightrag - INFO - Inserting 292 vectors to entities
2025-01-10 06:25:37,556 - lightrag - INFO - Inserting 35 vectors to relationships
2025-01-10 06:25:39,725 - lightrag - INFO - Writing graph with 714 nodes, 419 edges
2025-01-10 06:25:39,752 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 06:25:40,975 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:25:40,987 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:25:40,989 - lightrag - INFO - Inserting 87 vectors to entities
2025-01-10 06:25:41,591 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-10 06:25:41,880 - lightrag - INFO - Writing graph with 287 nodes, 106 edges
2025-01-10 06:25:41,894 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 06:28:30,948 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:28:38,377 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:28:38,380 - lightrag - INFO - Inserting 203 vectors to entities
2025-01-10 06:28:41,377 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-10 06:28:42,855 - lightrag - INFO - Writing graph with 720 nodes, 430 edges
2025-01-10 06:28:42,882 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:28:56,770 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:28:56,778 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:28:56,780 - lightrag - INFO - Inserting 118 vectors to entities
2025-01-10 06:28:57,581 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-10 06:28:57,813 - lightrag - INFO - Writing graph with 382 nodes, 136 edges
2025-01-10 06:28:57,828 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:30:26,592 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:30:26,603 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:30:26,604 - lightrag - INFO - Inserting 61 vectors to entities
2025-01-10 06:30:27,048 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-10 06:30:27,135 - lightrag - INFO - Writing graph with 409 nodes, 145 edges
2025-01-10 06:30:27,151 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 06:31:55,785 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:31:59,695 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:31:59,699 - lightrag - INFO - Inserting 269 vectors to entities
2025-01-10 06:32:02,862 - lightrag - INFO - Inserting 36 vectors to relationships
2025-01-10 06:32:05,747 - lightrag - INFO - Writing graph with 741 nodes, 452 edges
2025-01-10 06:32:05,785 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 06:34:13,725 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:34:20,441 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:34:20,446 - lightrag - INFO - Inserting 343 vectors to entities
2025-01-10 06:34:24,418 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-10 06:34:26,858 - lightrag - INFO - Writing graph with 812 nodes, 468 edges
2025-01-10 06:34:26,895 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 06:34:26,900 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 06:35:39,940 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:35:39,948 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:35:39,950 - lightrag - INFO - Inserting 130 vectors to entities
2025-01-10 06:35:41,924 - lightrag - INFO - Inserting 83 vectors to relationships
2025-01-10 06:35:42,511 - lightrag - INFO - Writing graph with 558 nodes, 227 edges
2025-01-10 06:35:42,528 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:36:25,928 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:36:32,717 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:36:32,720 - lightrag - INFO - Inserting 291 vectors to entities
2025-01-10 06:36:37,348 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-10 06:36:39,166 - lightrag - INFO - Writing graph with 821 nodes, 480 edges
2025-01-10 06:36:39,204 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:38:42,319 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:38:42,329 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:38:42,331 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-10 06:38:42,600 - lightrag - INFO - Inserting 55 vectors to relationships
2025-01-10 06:38:42,972 - lightrag - INFO - Writing graph with 573 nodes, 281 edges
2025-01-10 06:38:42,991 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:40:08,563 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:40:23,264 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:40:23,266 - lightrag - INFO - Inserting 241 vectors to entities
2025-01-10 06:40:26,252 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-10 06:40:28,360 - lightrag - INFO - Writing graph with 824 nodes, 485 edges
2025-01-10 06:40:28,401 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 06:42:05,287 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:42:05,295 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:42:05,296 - lightrag - INFO - Inserting 119 vectors to entities
2025-01-10 06:42:06,111 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-10 06:42:06,260 - lightrag - INFO - Writing graph with 616 nodes, 297 edges
2025-01-10 06:42:06,282 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:42:48,197 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:42:54,236 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:42:54,239 - lightrag - INFO - Inserting 276 vectors to entities
2025-01-10 06:42:57,713 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-10 06:42:59,500 - lightrag - INFO - Writing graph with 829 nodes, 492 edges
2025-01-10 06:42:59,538 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 06:44:04,220 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:44:09,229 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:44:09,232 - lightrag - INFO - Inserting 156 vectors to entities
2025-01-10 06:44:12,168 - lightrag - INFO - Inserting 41 vectors to relationships
2025-01-10 06:44:14,863 - lightrag - INFO - Writing graph with 852 nodes, 523 edges
2025-01-10 06:44:15,181 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 06:44:46,046 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:44:46,056 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:44:46,057 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-10 06:44:46,312 - lightrag - INFO - Inserting 34 vectors to relationships
2025-01-10 06:44:46,578 - lightrag - INFO - Writing graph with 636 nodes, 331 edges
2025-01-10 06:44:46,597 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 06:44:46,601 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:46:53,025 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:47:10,987 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:47:10,991 - lightrag - INFO - Inserting 319 vectors to entities
2025-01-10 06:47:14,552 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-10 06:47:16,421 - lightrag - INFO - Writing graph with 872 nodes, 533 edges
2025-01-10 06:47:16,452 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:47:48,558 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:47:48,564 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:47:48,566 - lightrag - INFO - Inserting 85 vectors to entities
2025-01-10 06:47:49,185 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-10 06:47:49,386 - lightrag - INFO - Writing graph with 665 nodes, 356 edges
2025-01-10 06:47:49,408 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 06:49:15,875 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:49:22,323 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:49:22,324 - lightrag - INFO - Inserting 256 vectors to entities
2025-01-10 06:49:25,794 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-10 06:49:28,129 - lightrag - INFO - Writing graph with 879 nodes, 549 edges
2025-01-10 06:49:28,170 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:53:08,221 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:53:15,809 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:53:15,813 - lightrag - INFO - Inserting 274 vectors to entities
2025-01-10 06:53:19,190 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-10 06:53:21,394 - lightrag - INFO - Writing graph with 879 nodes, 550 edges
2025-01-10 06:53:21,437 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:54:19,320 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:54:23,136 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:54:23,138 - lightrag - INFO - Inserting 133 vectors to entities
2025-01-10 06:54:25,737 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-10 06:54:27,063 - lightrag - INFO - Writing graph with 881 nodes, 554 edges
2025-01-10 06:54:27,097 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 06:56:56,400 - lightrag - INFO - Inserting entities into storage...
2025-01-10 06:57:03,604 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 06:57:03,612 - lightrag - INFO - Inserting 286 vectors to entities
2025-01-10 06:57:07,039 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-10 06:57:09,057 - lightrag - INFO - Writing graph with 883 nodes, 561 edges
2025-01-10 06:57:09,353 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:00:03,452 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:00:13,160 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:00:13,161 - lightrag - INFO - Inserting 210 vectors to entities
2025-01-10 07:00:16,377 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-10 07:00:18,092 - lightrag - INFO - Writing graph with 889 nodes, 575 edges
2025-01-10 07:00:18,134 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 07:00:18,138 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:04:37,250 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:04:44,177 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:04:44,180 - lightrag - INFO - Inserting 284 vectors to entities
2025-01-10 07:04:47,747 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-10 07:04:49,166 - lightrag - INFO - Writing graph with 903 nodes, 578 edges
2025-01-10 07:04:49,204 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:07:49,207 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:07:56,392 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:07:56,396 - lightrag - INFO - Inserting 229 vectors to entities
2025-01-10 07:07:59,318 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-10 07:08:01,674 - lightrag - INFO - Writing graph with 907 nodes, 581 edges
2025-01-10 07:08:01,722 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:11:36,929 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 07:11:36,929 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 07:11:36,930 - lightrag - INFO - Load KV full_docs with 11 data
2025-01-10 07:11:36,931 - lightrag - INFO - Load KV text_chunks with 47 data
2025-01-10 07:11:37,086 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 665 nodes, 356 edges
2025-01-10 07:11:37,104 - lightrag - INFO - Loaded document status storage with 12 records
2025-01-10 07:11:37,105 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 07:11:37,106 - lightrag - INFO - Processing 9 new unique documents
2025-01-10 07:11:37,362 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:12:00,738 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:12:08,957 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:12:08,961 - lightrag - INFO - Inserting 237 vectors to entities
2025-01-10 07:12:12,036 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-10 07:12:13,946 - lightrag - INFO - Writing graph with 916 nodes, 586 edges
2025-01-10 07:12:13,983 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:13:39,281 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:13:39,284 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:13:39,285 - lightrag - INFO - Inserting 25 vectors to entities
2025-01-10 07:13:39,475 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-10 07:13:39,678 - lightrag - INFO - Writing graph with 692 nodes, 380 edges
2025-01-10 07:13:39,700 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:14:46,428 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:14:53,457 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:14:53,459 - lightrag - INFO - Inserting 248 vectors to entities
2025-01-10 07:14:56,669 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-10 07:14:58,439 - lightrag - INFO - Writing graph with 920 nodes, 597 edges
2025-01-10 07:14:58,714 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:15:04,178 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:15:04,181 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:15:04,182 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-10 07:15:04,387 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-10 07:15:04,495 - lightrag - INFO - Writing graph with 710 nodes, 390 edges
2025-01-10 07:15:04,519 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:16:53,450 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:16:53,461 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:16:53,463 - lightrag - INFO - Inserting 44 vectors to entities
2025-01-10 07:16:53,811 - lightrag - INFO - Inserting 38 vectors to relationships
2025-01-10 07:16:54,115 - lightrag - INFO - Writing graph with 761 nodes, 424 edges
2025-01-10 07:16:54,139 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:18:03,283 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:18:08,461 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:18:08,465 - lightrag - INFO - Inserting 229 vectors to entities
2025-01-10 07:18:11,625 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-10 07:18:13,961 - lightrag - INFO - Writing graph with 965 nodes, 609 edges
2025-01-10 07:18:13,996 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:19:48,995 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:19:54,138 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:19:54,142 - lightrag - INFO - Inserting 164 vectors to entities
2025-01-10 07:19:57,154 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-10 07:19:59,088 - lightrag - INFO - Writing graph with 970 nodes, 614 edges
2025-01-10 07:19:59,125 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:20:13,721 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:20:13,735 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:20:13,736 - lightrag - INFO - Inserting 112 vectors to entities
2025-01-10 07:20:14,555 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-10 07:20:14,727 - lightrag - INFO - Writing graph with 824 nodes, 442 edges
2025-01-10 07:20:14,753 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:24:01,439 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:24:01,453 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:24:01,454 - lightrag - INFO - Inserting 130 vectors to entities
2025-01-10 07:24:02,416 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-10 07:24:02,568 - lightrag - INFO - Writing graph with 855 nodes, 454 edges
2025-01-10 07:24:02,591 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:24:07,558 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:24:15,199 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:24:15,201 - lightrag - INFO - Inserting 247 vectors to entities
2025-01-10 07:24:18,290 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-10 07:24:20,147 - lightrag - INFO - Writing graph with 988 nodes, 620 edges
2025-01-10 07:24:20,190 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:26:20,224 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:26:20,231 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:26:20,232 - lightrag - INFO - Inserting 65 vectors to entities
2025-01-10 07:26:20,754 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-10 07:26:20,902 - lightrag - INFO - Writing graph with 871 nodes, 465 edges
2025-01-10 07:26:20,932 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 07:26:24,346 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:26:29,706 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:26:29,709 - lightrag - INFO - Inserting 191 vectors to entities
2025-01-10 07:26:32,844 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-10 07:26:35,412 - lightrag - INFO - Writing graph with 1003 nodes, 631 edges
2025-01-10 07:26:35,449 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:30:06,293 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:30:06,310 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:30:06,312 - lightrag - INFO - Inserting 122 vectors to entities
2025-01-10 07:30:07,260 - lightrag - INFO - Inserting 47 vectors to relationships
2025-01-10 07:30:07,642 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:30:07,671 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:30:12,336 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:30:26,327 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:30:26,331 - lightrag - INFO - Inserting 286 vectors to entities
2025-01-10 07:30:29,725 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-10 07:30:31,697 - lightrag - INFO - Writing graph with 1005 nodes, 634 edges
2025-01-10 07:30:31,735 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:33:12,205 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:33:16,620 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:33:21,301 - lightrag - INFO - Inserting 167 vectors to entities
2025-01-10 07:33:24,975 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-10 07:33:26,930 - lightrag - INFO - Writing graph with 1006 nodes, 639 edges
2025-01-10 07:33:26,966 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 07:33:26,971 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:35:39,336 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:35:46,056 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:35:46,060 - lightrag - INFO - Inserting 299 vectors to entities
2025-01-10 07:35:49,784 - lightrag - INFO - Inserting 37 vectors to relationships
2025-01-10 07:35:51,819 - lightrag - INFO - Writing graph with 1024 nodes, 654 edges
2025-01-10 07:35:51,869 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:39:36,499 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:39:42,155 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:39:42,159 - lightrag - INFO - Inserting 219 vectors to entities
2025-01-10 07:39:45,341 - lightrag - INFO - Inserting 29 vectors to relationships
2025-01-10 07:39:47,834 - lightrag - INFO - Writing graph with 1043 nodes, 666 edges
2025-01-10 07:39:47,882 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:40:32,217 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 07:40:32,217 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 07:40:32,218 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-10 07:40:32,220 - lightrag - INFO - Load KV text_chunks with 75 data
2025-01-10 07:40:32,376 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 925 nodes, 511 edges
2025-01-10 07:40:32,400 - lightrag - INFO - Loaded document status storage with 19 records
2025-01-10 07:40:32,401 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 07:40:32,402 - lightrag - INFO - Processing 2 new unique documents
2025-01-10 07:40:32,646 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:42:24,349 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:42:35,086 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:42:35,090 - lightrag - INFO - Inserting 286 vectors to entities
2025-01-10 07:42:38,531 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-10 07:42:40,390 - lightrag - INFO - Writing graph with 1051 nodes, 675 edges
2025-01-10 07:42:40,441 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:44:21,346 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:44:28,680 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:44:32,806 - lightrag - INFO - Inserting 156 vectors to entities
2025-01-10 07:44:35,625 - lightrag - INFO - Inserting 34 vectors to relationships
2025-01-10 07:44:37,954 - lightrag - INFO - Writing graph with 1067 nodes, 688 edges
2025-01-10 07:44:38,265 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:31,961 - lightrag - ERROR - Failed to process document doc-f45f88879cf0fa540571e302f5d8ad4a: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 392, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 379, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 316, in _process_single_content
    glean_result = await use_llm_func(continue_prompt, history_messages=history)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-10 07:45:32,010 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,040 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:32,061 - lightrag - ERROR - Failed to process document doc-57c1b43ddc75b57a62a1b83dd899dc59: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:32,103 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,127 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 07:45:32,131 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:32,152 - lightrag - ERROR - Failed to process document doc-4513c304ff30ab6439b2f5fedf139835: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:32,195 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,221 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:32,241 - lightrag - ERROR - Failed to process document doc-907c73b01580f5cc5ff5e2f35ddd4f37: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:32,285 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,310 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:45:32,331 - lightrag - ERROR - Failed to process document doc-be612b6205cec2e5646720704afbf2da: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:32,373 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,398 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:32,419 - lightrag - ERROR - Failed to process document doc-be115f82250890d43e96cbea7213fcb3: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:32,462 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,486 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:32,506 - lightrag - ERROR - Failed to process document doc-d66fa85bfd24f8a111cde9d372107c7c: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:32,549 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,574 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:45:32,596 - lightrag - ERROR - Failed to process document doc-3683b1716f647f35b90c7bbb935be50f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:32,639 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,664 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:45:32,685 - lightrag - ERROR - Failed to process document doc-8e8833e6681e3ffd71be51ccd7b8197b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:32,728 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,756 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 07:45:32,777 - lightrag - ERROR - Failed to process document doc-79f3c86e16a37b924e3013024688012b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:32,820 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:32,991 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:45:33,015 - lightrag - ERROR - Failed to process document doc-bdf60c1a1defbf675623975d2d742716: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:33,065 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:33,094 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:33,118 - lightrag - ERROR - Failed to process document doc-24e39c86da0f6c2b279f58bcc10b720f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:33,167 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:33,193 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 07:45:33,197 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:45:33,221 - lightrag - ERROR - Failed to process document doc-158aca418ddfe42db9b34c4f47212f3b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:33,271 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:33,300 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:33,323 - lightrag - ERROR - Failed to process document doc-08497a24f311a04030976dc805096271: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:33,371 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:33,402 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 07:45:33,426 - lightrag - ERROR - Failed to process document doc-bb2f29945bde0601a7bb8c71b6fcbc74: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:33,475 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:33,504 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:33,528 - lightrag - ERROR - Failed to process document doc-2c4743c55cf70cbb64e05b1583703337: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:33,577 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:33,606 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:33,630 - lightrag - ERROR - Failed to process document doc-1dba45d42c2c53003feb1b58a2e1e42e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:33,679 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:33,709 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:45:50,832 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 07:45:50,832 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 07:45:50,834 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-10 07:45:50,835 - lightrag - INFO - Load KV text_chunks with 75 data
2025-01-10 07:45:50,997 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 925 nodes, 511 edges
2025-01-10 07:45:51,023 - lightrag - INFO - Loaded document status storage with 36 records
2025-01-10 07:45:51,024 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 07:45:51,025 - lightrag - INFO - Processing 2 new unique documents
2025-01-10 07:45:51,312 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:51,339 - lightrag - ERROR - Failed to process document doc-f45f88879cf0fa540571e302f5d8ad4a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:51,394 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:51,424 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:51,448 - lightrag - ERROR - Failed to process document doc-57c1b43ddc75b57a62a1b83dd899dc59: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:51,496 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:51,518 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 07:45:51,523 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:51,545 - lightrag - ERROR - Failed to process document doc-24e39c86da0f6c2b279f58bcc10b720f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:51,595 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:51,622 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:45:51,644 - lightrag - ERROR - Failed to process document doc-8e8833e6681e3ffd71be51ccd7b8197b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:51,688 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:51,713 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:45:51,736 - lightrag - ERROR - Failed to process document doc-3683b1716f647f35b90c7bbb935be50f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:51,785 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:51,814 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 07:45:51,836 - lightrag - ERROR - Failed to process document doc-79f3c86e16a37b924e3013024688012b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:51,881 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:51,907 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 07:45:51,929 - lightrag - ERROR - Failed to process document doc-be612b6205cec2e5646720704afbf2da: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:51,974 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,002 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:45:52,024 - lightrag - ERROR - Failed to process document doc-bdf60c1a1defbf675623975d2d742716: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:52,069 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,096 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:52,118 - lightrag - ERROR - Failed to process document doc-d66fa85bfd24f8a111cde9d372107c7c: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:52,163 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,331 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:52,353 - lightrag - ERROR - Failed to process document doc-4513c304ff30ab6439b2f5fedf139835: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:52,398 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,424 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:52,446 - lightrag - ERROR - Failed to process document doc-907c73b01580f5cc5ff5e2f35ddd4f37: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:52,491 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,516 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:52,538 - lightrag - ERROR - Failed to process document doc-be115f82250890d43e96cbea7213fcb3: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:52,583 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,606 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 07:45:52,610 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:52,632 - lightrag - ERROR - Failed to process document doc-1dba45d42c2c53003feb1b58a2e1e42e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:52,676 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,702 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:52,723 - lightrag - ERROR - Failed to process document doc-2c66d27908cf9635706335bf5056664f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:52,768 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,795 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:45:52,817 - lightrag - ERROR - Failed to process document doc-005a628f3a40c943e224f859b652baf2: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:52,861 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,887 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:45:52,909 - lightrag - ERROR - Failed to process document doc-08497a24f311a04030976dc805096271: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 432, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 389, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-10 07:45:52,954 - lightrag - INFO - Writing graph with 925 nodes, 511 edges
2025-01-10 07:45:52,982 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 07:46:13,005 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 07:46:13,006 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 07:46:13,007 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-10 07:46:13,009 - lightrag - INFO - Load KV text_chunks with 75 data
2025-01-10 07:46:13,166 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 925 nodes, 511 edges
2025-01-10 07:46:13,191 - lightrag - INFO - Loaded document status storage with 38 records
2025-01-10 07:46:13,192 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 07:46:13,193 - lightrag - INFO - Processing 2 new unique documents
2025-01-10 07:46:13,458 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:46:45,013 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:46:53,393 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:46:53,396 - lightrag - INFO - Inserting 277 vectors to entities
2025-01-10 07:46:57,153 - lightrag - INFO - Inserting 36 vectors to relationships
2025-01-10 07:46:59,509 - lightrag - INFO - Writing graph with 1074 nodes, 717 edges
2025-01-10 07:46:59,563 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:47:58,298 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:47:58,312 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:47:58,314 - lightrag - INFO - Inserting 125 vectors to entities
2025-01-10 07:47:59,250 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-10 07:47:59,458 - lightrag - INFO - Writing graph with 959 nodes, 534 edges
2025-01-10 07:47:59,486 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:48:34,722 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:48:43,792 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:48:46,634 - lightrag - INFO - Inserting 280 vectors to entities
2025-01-10 07:48:50,876 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-10 07:48:52,976 - lightrag - INFO - Writing graph with 1086 nodes, 720 edges
2025-01-10 07:48:53,023 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:51:22,315 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:51:29,157 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:51:29,162 - lightrag - INFO - Inserting 297 vectors to entities
2025-01-10 07:51:32,672 - lightrag - INFO - Inserting 51 vectors to relationships
2025-01-10 07:51:35,024 - lightrag - INFO - Writing graph with 1100 nodes, 749 edges
2025-01-10 07:51:35,067 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:53:46,375 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:53:52,521 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:53:52,526 - lightrag - INFO - Inserting 189 vectors to entities
2025-01-10 07:53:55,368 - lightrag - INFO - Inserting 47 vectors to relationships
2025-01-10 07:53:57,878 - lightrag - INFO - Writing graph with 1123 nodes, 772 edges
2025-01-10 07:53:57,924 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 07:56:06,067 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:56:14,289 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:56:14,292 - lightrag - INFO - Inserting 275 vectors to entities
2025-01-10 07:56:17,541 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-10 07:56:19,515 - lightrag - INFO - Writing graph with 1125 nodes, 775 edges
2025-01-10 07:56:19,572 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 07:58:26,179 - lightrag - INFO - Inserting entities into storage...
2025-01-10 07:58:33,095 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 07:58:36,645 - lightrag - INFO - Inserting 192 vectors to entities
2025-01-10 07:58:39,737 - lightrag - INFO - Inserting 49 vectors to relationships
2025-01-10 07:58:42,393 - lightrag - INFO - Writing graph with 1148 nodes, 799 edges
2025-01-10 07:58:42,441 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 07:58:42,447 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 08:00:50,357 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:00:59,687 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:00:59,691 - lightrag - INFO - Inserting 293 vectors to entities
2025-01-10 08:01:03,117 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-10 08:01:06,295 - lightrag - INFO - Writing graph with 1161 nodes, 811 edges
2025-01-10 08:01:06,347 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 08:02:12,021 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 08:02:12,021 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 08:02:12,022 - lightrag - INFO - Load KV full_docs with 19 data
2025-01-10 08:02:12,024 - lightrag - INFO - Load KV text_chunks with 79 data
2025-01-10 08:02:12,180 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 959 nodes, 534 edges
2025-01-10 08:02:12,205 - lightrag - INFO - Loaded document status storage with 38 records
2025-01-10 08:02:12,206 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 08:02:12,207 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 08:02:12,461 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:04:37,212 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:04:42,681 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:04:42,689 - lightrag - INFO - Inserting 214 vectors to entities
2025-01-10 08:04:45,591 - lightrag - INFO - Inserting 56 vectors to relationships
2025-01-10 08:04:47,866 - lightrag - INFO - Writing graph with 1174 nodes, 837 edges
2025-01-10 08:04:47,909 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 08:06:22,224 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:06:25,241 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:06:25,242 - lightrag - INFO - Inserting 153 vectors to entities
2025-01-10 08:06:26,429 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-10 08:06:26,560 - lightrag - INFO - Writing graph with 1004 nodes, 541 edges
2025-01-10 08:06:26,587 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 08:06:26,591 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:08:24,433 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:08:24,446 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:08:24,447 - lightrag - INFO - Inserting 56 vectors to entities
2025-01-10 08:08:24,920 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-10 08:08:25,085 - lightrag - INFO - Writing graph with 1024 nodes, 556 edges
2025-01-10 08:08:25,113 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 08:08:45,837 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:08:57,131 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:08:57,136 - lightrag - INFO - Inserting 328 vectors to entities
2025-01-10 08:09:00,943 - lightrag - INFO - Inserting 37 vectors to relationships
2025-01-10 08:09:03,515 - lightrag - INFO - Writing graph with 1214 nodes, 863 edges
2025-01-10 08:09:03,562 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:10:27,655 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:10:27,663 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:10:27,664 - lightrag - INFO - Inserting 52 vectors to entities
2025-01-10 08:10:28,105 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-10 08:10:28,263 - lightrag - INFO - Writing graph with 1043 nodes, 571 edges
2025-01-10 08:10:28,296 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-10 08:10:39,290 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:10:45,562 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:10:45,565 - lightrag - INFO - Inserting 282 vectors to entities
2025-01-10 08:10:49,433 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-10 08:10:54,305 - lightrag - INFO - Writing graph with 1217 nodes, 876 edges
2025-01-10 08:10:54,347 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 08:13:55,135 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:14:02,263 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:14:02,267 - lightrag - INFO - Inserting 212 vectors to entities
2025-01-10 08:14:05,587 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-10 08:14:07,671 - lightrag - INFO - Writing graph with 1219 nodes, 879 edges
2025-01-10 08:14:07,726 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:15:48,465 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:15:48,481 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:15:48,483 - lightrag - INFO - Inserting 132 vectors to entities
2025-01-10 08:15:50,521 - lightrag - INFO - Inserting 37 vectors to relationships
2025-01-10 08:15:50,847 - lightrag - INFO - Writing graph with 1097 nodes, 606 edges
2025-01-10 08:15:50,879 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:17:27,379 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:17:36,098 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:17:36,102 - lightrag - INFO - Inserting 271 vectors to entities
2025-01-10 08:17:42,423 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-10 08:17:44,852 - lightrag - INFO - Writing graph with 1221 nodes, 881 edges
2025-01-10 08:17:45,140 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 08:18:55,123 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:18:55,138 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:18:55,138 - lightrag - INFO - Inserting 69 vectors to entities
2025-01-10 08:18:55,710 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-10 08:18:55,824 - lightrag - INFO - Writing graph with 1118 nodes, 610 edges
2025-01-10 08:18:55,864 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 08:19:12,352 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:19:16,432 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:19:16,436 - lightrag - INFO - Inserting 157 vectors to entities
2025-01-10 08:19:19,366 - lightrag - INFO - Inserting 36 vectors to relationships
2025-01-10 08:19:21,735 - lightrag - INFO - Writing graph with 1235 nodes, 906 edges
2025-01-10 08:19:21,794 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:21:13,657 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:21:27,222 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:21:27,225 - lightrag - INFO - Inserting 242 vectors to entities
2025-01-10 08:21:30,497 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-10 08:21:32,763 - lightrag - INFO - Writing graph with 1243 nodes, 909 edges
2025-01-10 08:21:32,818 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 08:22:23,591 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 08:22:23,592 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 08:22:23,594 - lightrag - INFO - Load KV full_docs with 24 data
2025-01-10 08:22:23,596 - lightrag - INFO - Load KV text_chunks with 100 data
2025-01-10 08:22:23,760 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1118 nodes, 610 edges
2025-01-10 08:22:23,789 - lightrag - INFO - Loaded document status storage with 38 records
2025-01-10 08:22:23,791 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 08:22:23,792 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 08:22:23,793 - lightrag - INFO - Processing 6 new unique documents
2025-01-10 08:22:24,046 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:23:42,913 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:23:52,166 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:23:55,149 - lightrag - INFO - Inserting 290 vectors to entities
2025-01-10 08:23:58,753 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-10 08:24:01,043 - lightrag - INFO - Writing graph with 1259 nodes, 920 edges
2025-01-10 08:24:01,098 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:24:27,757 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:24:27,761 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:24:27,762 - lightrag - INFO - Inserting 22 vectors to entities
2025-01-10 08:24:27,966 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-10 08:24:28,139 - lightrag - INFO - Writing graph with 1124 nodes, 621 edges
2025-01-10 08:24:28,175 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:26:51,985 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:26:55,161 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:26:55,163 - lightrag - INFO - Inserting 99 vectors to entities
2025-01-10 08:26:56,063 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-10 08:26:56,292 - lightrag - INFO - Writing graph with 1129 nodes, 636 edges
2025-01-10 08:26:56,325 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 08:27:45,315 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:27:52,696 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:27:52,700 - lightrag - INFO - Inserting 235 vectors to entities
2025-01-10 08:27:56,031 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-10 08:27:58,126 - lightrag - INFO - Writing graph with 1264 nodes, 926 edges
2025-01-10 08:27:58,386 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 08:27:58,391 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:30:30,725 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:30:30,754 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:30:30,756 - lightrag - INFO - Inserting 183 vectors to entities
2025-01-10 08:30:32,297 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-10 08:30:32,544 - lightrag - INFO - Writing graph with 1172 nodes, 660 edges
2025-01-10 08:30:32,579 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 08:31:39,947 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:31:48,649 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:31:48,652 - lightrag - INFO - Inserting 279 vectors to entities
2025-01-10 08:31:52,271 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-10 08:31:54,207 - lightrag - INFO - Writing graph with 1269 nodes, 927 edges
2025-01-10 08:31:54,261 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:32:38,655 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:32:38,674 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:32:38,675 - lightrag - INFO - Inserting 90 vectors to entities
2025-01-10 08:32:39,467 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-10 08:32:39,716 - lightrag - INFO - Writing graph with 1220 nodes, 685 edges
2025-01-10 08:32:39,752 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:34:39,680 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:34:39,695 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:34:39,697 - lightrag - INFO - Inserting 60 vectors to entities
2025-01-10 08:34:40,140 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-10 08:34:40,402 - lightrag - INFO - Writing graph with 1260 nodes, 714 edges
2025-01-10 08:34:40,439 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 08:35:57,334 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:36:06,396 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:36:06,400 - lightrag - INFO - Inserting 278 vectors to entities
2025-01-10 08:36:09,523 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-10 08:36:11,987 - lightrag - INFO - Writing graph with 1275 nodes, 929 edges
2025-01-10 08:36:12,041 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:37:16,815 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:37:16,838 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:37:16,841 - lightrag - INFO - Inserting 101 vectors to entities
2025-01-10 08:37:17,776 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-10 08:37:18,057 - lightrag - INFO - Writing graph with 1293 nodes, 745 edges
2025-01-10 08:37:18,242 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 08:37:18,247 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 08:39:44,699 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:39:44,711 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:39:44,713 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-10 08:39:45,103 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-10 08:39:45,463 - lightrag - INFO - Writing graph with 1339 nodes, 784 edges
2025-01-10 08:39:45,504 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:40:02,075 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:40:10,488 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:40:10,492 - lightrag - INFO - Inserting 236 vectors to entities
2025-01-10 08:40:13,730 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-10 08:40:15,634 - lightrag - INFO - Writing graph with 1276 nodes, 931 edges
2025-01-10 08:40:15,692 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:42:08,081 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:42:08,102 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:42:08,104 - lightrag - INFO - Inserting 86 vectors to entities
2025-01-10 08:42:08,890 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-10 08:42:09,188 - lightrag - INFO - Writing graph with 1385 nodes, 808 edges
2025-01-10 08:42:09,230 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-10 08:42:15,810 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:42:31,860 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:42:31,863 - lightrag - INFO - Inserting 232 vectors to entities
2025-01-10 08:42:34,834 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-10 08:42:37,312 - lightrag - INFO - Writing graph with 1292 nodes, 949 edges
2025-01-10 08:42:37,600 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:44:50,388 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:44:50,394 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:44:50,395 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-10 08:44:50,752 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-10 08:44:50,915 - lightrag - INFO - Writing graph with 1396 nodes, 817 edges
2025-01-10 08:44:50,958 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-10 08:47:07,847 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:47:13,769 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:47:13,774 - lightrag - INFO - Inserting 273 vectors to entities
2025-01-10 08:47:17,371 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-10 08:47:20,055 - lightrag - INFO - Writing graph with 1299 nodes, 950 edges
2025-01-10 08:47:20,110 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:50:12,325 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:50:26,210 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:50:26,216 - lightrag - INFO - Inserting 287 vectors to entities
2025-01-10 08:50:29,824 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-10 08:50:32,262 - lightrag - INFO - Writing graph with 1307 nodes, 951 edges
2025-01-10 08:50:32,315 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:52:01,007 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 08:52:01,007 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 08:52:01,010 - lightrag - INFO - Load KV full_docs with 33 data
2025-01-10 08:52:01,012 - lightrag - INFO - Load KV text_chunks with 134 data
2025-01-10 08:52:01,182 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1396 nodes, 817 edges
2025-01-10 08:52:01,219 - lightrag - INFO - Loaded document status storage with 39 records
2025-01-10 08:52:01,221 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 08:52:01,221 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 08:52:01,222 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 08:52:01,223 - lightrag - INFO - Processing 7 new unique documents
2025-01-10 08:52:01,471 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:54:13,334 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:54:30,902 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:54:30,907 - lightrag - INFO - Inserting 277 vectors to entities
2025-01-10 08:54:34,435 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-10 08:54:36,531 - lightrag - INFO - Writing graph with 1309 nodes, 953 edges
2025-01-10 08:54:36,596 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 08:55:39,020 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 08:55:39,020 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 08:55:39,021 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 08:55:39,021 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 08:55:39,021 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 08:55:39,041 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 08:55:39,651 - lightrag - INFO - Inserting 431 vectors to chunks
2025-01-10 08:57:31,803 - lightrag - INFO - Inserting entities into storage...
2025-01-10 08:57:46,784 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 08:57:46,787 - lightrag - INFO - Inserting 286 vectors to entities
2025-01-10 08:57:50,314 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-10 08:57:51,925 - lightrag - INFO - Writing graph with 1314 nodes, 953 edges
2025-01-10 08:57:51,974 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 09:01:03,206 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-10 09:01:03,207 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 09:01:03,207 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-10 09:01:03,207 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-10 09:01:03,207 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-10 09:01:03,222 - lightrag - INFO - Processing 1 new unique documents
2025-01-10 09:01:03,843 - lightrag - INFO - Inserting 431 vectors to chunks
2025-01-10 09:02:21,350 - lightrag - INFO - Inserting entities into storage...
2025-01-10 09:02:29,547 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 09:02:29,550 - lightrag - INFO - Inserting 265 vectors to entities
2025-01-10 09:02:32,947 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-10 09:02:35,052 - lightrag - INFO - Writing graph with 1317 nodes, 959 edges
2025-01-10 09:02:35,111 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 09:05:12,902 - lightrag - INFO - Inserting entities into storage...
2025-01-10 09:05:24,314 - lightrag - INFO - Inserting relationships into storage...
2025-01-10 09:05:24,320 - lightrag - INFO - Inserting 279 vectors to entities
2025-01-10 09:05:27,756 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-10 09:05:30,439 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-10 09:05:30,496 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 09:05:30,501 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 09:06:22,313 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:06:22,313 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 09:06:22,319 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:06:22,326 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:06:22,504 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:06:22,602 - lightrag - INFO - Loaded document status storage with 81 records
2025-01-10 09:06:22,604 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 09:06:22,604 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 09:06:22,605 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 09:06:22,606 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 09:06:22,606 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 09:06:22,607 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 09:06:22,608 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 09:06:22,609 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-10 09:06:22,609 - lightrag - INFO - Processing 10 new unique documents
2025-01-10 09:06:22,857 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-10 09:06:58,316 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:06:58,317 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-10 09:06:58,323 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:06:58,329 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:06:58,501 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:06:58,599 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:07:01,433 - lightrag - INFO - Local query uses 60 entites, 56 relations, 3 text units
2025-01-10 09:07:02,226 - lightrag - INFO - Global query uses 11 entites, 53 relations, 3 text units
2025-01-10 09:07:33,688 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:07:33,688 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-10 09:07:33,694 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:07:33,701 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:07:33,879 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:07:33,978 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:07:36,185 - lightrag - INFO - Local query uses 60 entites, 58 relations, 3 text units
2025-01-10 09:07:37,042 - lightrag - INFO - Global query uses 19 entites, 60 relations, 3 text units
2025-01-10 09:07:51,908 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:07:51,909 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-10 09:07:51,915 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:07:51,922 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:07:52,101 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:07:52,199 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:07:54,062 - lightrag - INFO - Local query uses 60 entites, 81 relations, 3 text units
2025-01-10 09:07:54,816 - lightrag - INFO - Global query uses 11 entites, 49 relations, 3 text units
2025-01-10 09:09:10,900 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:09:10,900 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-10 09:09:10,906 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:09:10,914 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:09:11,091 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:09:11,195 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:09:14,157 - lightrag - INFO - Local query uses 60 entites, 53 relations, 3 text units
2025-01-10 09:09:14,924 - lightrag - INFO - Global query uses 16 entites, 60 relations, 3 text units
2025-01-10 09:10:15,260 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:10:15,260 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-10 09:10:15,266 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:10:15,273 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:10:15,474 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:10:15,572 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:10:17,277 - lightrag - INFO - kw_prompt result:
2025-01-10 09:10:18,360 - lightrag - INFO - Local query uses 51 entites, 97 relations, 3 text units
2025-01-10 09:10:19,263 - lightrag - INFO - Global query uses 24 entites, 60 relations, 3 text units
2025-01-10 09:11:48,988 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:11:48,988 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:11:48,995 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:11:49,001 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:11:49,179 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:11:49,276 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:11:51,007 - lightrag - INFO - kw_prompt result:
2025-01-10 09:11:52,052 - lightrag - INFO - Local query uses 60 entites, 42 relations, 3 text units
2025-01-10 09:11:52,689 - lightrag - INFO - Global query uses 15 entites, 60 relations, 3 text units
2025-01-10 09:18:41,726 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:18:41,726 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:18:41,733 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:18:41,740 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:18:41,918 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:18:42,016 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:19:47,899 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:19:47,900 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:19:47,906 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:19:47,912 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:19:48,100 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:19:48,200 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:20:39,794 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:20:39,795 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:20:39,801 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:20:39,807 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:20:39,984 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:20:40,081 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:21:20,888 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:21:20,889 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:21:20,895 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:21:20,901 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:21:20,940 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:21:21,038 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:22:29,280 - lightrag - INFO - Creating a new event loop in main thread.
2025-01-10 09:30:32,323 - lightrag - INFO - Logger initialized for working directory: contemi_openai
2025-01-10 09:30:32,323 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:30:32,330 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:30:32,336 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:30:32,380 - lightrag - INFO - Loaded graph from contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:32:53,623 - lightrag - INFO - Logger initialized for working directory: contemi_openai
2025-01-10 09:32:53,624 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:32:53,630 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:32:53,636 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:32:53,679 - lightrag - INFO - Loaded graph from contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:32:53,777 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:34:42,722 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:34:42,723 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:34:42,729 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:34:42,735 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:34:42,775 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:34:42,872 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:42:22,158 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:42:22,158 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:42:22,164 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:42:22,170 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:42:22,211 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:42:22,307 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:42:35,324 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:42:35,324 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:42:35,330 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:42:35,336 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:42:35,377 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:42:35,472 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:43:40,600 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:43:40,600 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:43:40,606 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:43:40,612 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:43:40,652 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:43:40,745 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:43:50,717 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:43:50,717 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:43:50,723 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:43:50,729 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:43:50,769 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:43:50,863 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:44:16,299 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:44:16,300 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:44:16,306 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:44:16,312 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:44:16,352 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:44:16,448 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:49:17,424 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:49:17,425 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:49:17,430 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:49:17,436 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:49:17,475 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:49:17,570 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:51:02,902 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:51:02,902 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:51:02,909 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:51:02,915 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:51:02,954 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:51:03,051 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:52:11,798 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 09:52:11,798 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 09:52:11,804 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 09:52:11,809 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 09:52:11,850 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 09:52:11,944 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 09:52:31,514 - lightrag - INFO - Creating a new event loop in main thread.
2025-01-10 13:40:00,864 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 13:40:00,865 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 13:40:00,871 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 13:40:00,878 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 13:40:00,918 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 13:40:01,017 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 13:42:18,292 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 13:42:18,292 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 13:42:18,298 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 13:42:18,305 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 13:42:18,346 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 13:42:18,445 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 13:42:42,551 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 13:42:42,552 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 13:42:42,558 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 13:42:42,564 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 13:42:42,604 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 13:42:42,703 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 13:43:17,753 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 13:43:17,753 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 13:43:17,759 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 13:43:17,766 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 13:43:17,807 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 13:43:35,357 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 13:43:35,357 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 13:43:35,364 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 13:43:35,371 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 13:43:35,418 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 13:43:35,517 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 13:50:48,408 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 13:50:48,408 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 13:50:48,415 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 13:50:48,421 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 13:50:48,461 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 13:50:48,560 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 13:50:50,592 - lightrag - INFO - kw_prompt result:
2025-01-10 13:50:51,848 - lightrag - INFO - Local query uses 60 entites, 95 relations, 3 text units
2025-01-10 13:50:52,591 - lightrag - INFO - Global query uses 24 entites, 60 relations, 3 text units
2025-01-10 13:51:40,121 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-10 13:51:40,121 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-10 13:51:40,127 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-10 13:51:40,134 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-10 13:51:40,174 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-10 13:51:40,273 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-10 13:51:41,586 - lightrag - INFO - kw_prompt result:
2025-01-10 13:51:42,747 - lightrag - INFO - Local query uses 60 entites, 101 relations, 3 text units
2025-01-10 13:51:43,893 - lightrag - INFO - Global query uses 26 entites, 60 relations, 3 text units
2025-01-11 01:09:11,869 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 01:09:11,870 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 01:09:11,876 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-11 01:09:11,883 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-11 01:09:11,923 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-11 01:09:12,019 - lightrag - INFO - Loaded document status storage with 82 records
2025-01-11 01:09:12,020 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 01:09:12,021 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 01:09:12,022 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 01:09:12,023 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 01:09:12,023 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 01:09:12,024 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 01:09:12,025 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 01:09:12,026 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 01:09:12,027 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 01:09:15,284 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:27,649 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 02:00:27,649 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 02:00:27,655 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-11 02:00:27,662 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-11 02:00:27,700 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-11 02:00:27,795 - lightrag - INFO - Loaded document status storage with 83 records
2025-01-11 02:00:27,796 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:00:27,797 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:00:27,798 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:00:27,799 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:00:27,799 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:00:27,800 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:00:27,801 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:00:27,802 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:00:27,802 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 02:00:31,830 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:31,833 - lightrag - ERROR - Failed to process document doc-4c2242c80f43cd4b11e9a39e2d46acf3: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:32,015 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:32,064 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:32,066 - lightrag - ERROR - Failed to process document doc-b12ad93c8ccb2340f05cfafc90e36be6: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:32,228 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:32,271 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:32,273 - lightrag - ERROR - Failed to process document doc-ea758f69c411a20ce6869e8ff4a3e435: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:32,439 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:32,483 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:32,484 - lightrag - ERROR - Failed to process document doc-07704e9957edbd6980f70434b105ab3c: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:32,648 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:32,692 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:32,694 - lightrag - ERROR - Failed to process document doc-2499557de86f33df98b945a4c9395f4f: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:32,856 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:32,912 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:32,914 - lightrag - ERROR - Failed to process document doc-bfe7f9a6a79e2a081d373d849d0b1341: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:33,084 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:33,128 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:33,130 - lightrag - ERROR - Failed to process document doc-153b93412c83eccd356c3052c8a9481c: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:33,301 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:33,344 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:33,346 - lightrag - ERROR - Failed to process document doc-21a8a810f54c44190b96999b56dda1dd: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:33,511 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:33,555 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:33,556 - lightrag - ERROR - Failed to process document doc-d425f8430b28cdbf398e2284bebc2bf7: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:33,725 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:33,769 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:33,771 - lightrag - ERROR - Failed to process document doc-48b53a1aee4b63f9aef6c16277686195: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:33,935 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:33,978 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 02:00:33,983 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 02:00:33,985 - lightrag - ERROR - Failed to process document doc-2a595c475f66d0ee54cf5b8939a8107d: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-11 02:00:34,150 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:00:34,356 - lightrag - INFO - Writing graph with 1325 nodes, 963 edges
2025-01-11 02:02:47,162 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 02:02:47,162 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 02:02:47,168 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-11 02:02:47,175 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-11 02:02:47,213 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-11 02:06:17,607 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 02:06:17,608 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 02:06:17,613 - lightrag - INFO - Load KV full_docs with 80 data
2025-01-11 02:06:17,620 - lightrag - INFO - Load KV text_chunks with 316 data
2025-01-11 02:06:17,659 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1325 nodes, 963 edges
2025-01-11 02:06:17,756 - lightrag - INFO - Loaded document status storage with 29 records
2025-01-11 02:06:17,757 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:06:17,758 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 02:06:17,759 - lightrag - INFO - Processing 1 new unique documents
2025-01-11 02:06:18,015 - lightrag - INFO - Inserting 6 vectors to chunks
2025-01-11 02:10:39,140 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 02:10:39,140 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 02:10:39,140 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 02:10:39,140 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 02:10:39,141 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 02:10:39,158 - lightrag - INFO - Processing 1 new unique documents
2025-01-11 02:10:39,766 - lightrag - INFO - Inserting 431 vectors to chunks
2025-01-11 03:46:20,993 - lightrag - INFO - Inserting entities into storage...
2025-01-11 03:47:18,551 - lightrag - ERROR - Failed to process document doc-3064a6842e9b5f92ffccd8c65ec75f51: RetryError[<Future at 0x78a0659df8d0 state=finished raised RateLimitError>]
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 87, in openai_complete_if_cache
    response = await openai_async_client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/resources/chat/completions.py", line 1720, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1849, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1543, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1629, in _request
    return await self._retry_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1676, in _retry_request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1629, in _request
    return await self._retry_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1676, in _retry_request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1644, in _request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o-mini in organization org-UtrVUsfGpRINGO0QzXcCQOyp on tokens per min (TPM): Limit 200000, Used 199120, Requested 4471. Please try again in 1.077s. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 420, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 490, in extract_entities
    all_entities_data.append(await result)
                             ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 204, in _merge_nodes_then_upsert
    description = await _handle_entity_relation_summary(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 121, in _handle_entity_relation_summary
    summary = await use_llm_func(use_prompt, max_tokens=summary_max_tokens)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 597, in gpt_4o_mini_complete
    return await openai_complete_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x78a0659df8d0 state=finished raised RateLimitError>]

2025-01-11 03:47:18,733 - lightrag - INFO - Writing graph with 1746 nodes, 0 edges
2025-01-11 03:47:36,269 - lightrag - INFO - kw_prompt result:
2025-01-11 03:47:36,270 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 04:04:19,224 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:04:19,360 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 04:04:19,360 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:04:19,360 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:04:19,386 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1746 nodes, 0 edges
2025-01-11 04:04:19,399 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 04:04:19,410 - lightrag - INFO - Processing 1 new unique documents
2025-01-11 04:04:20,022 - lightrag - INFO - Inserting 431 vectors to chunks
2025-01-11 04:04:25,135 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:05:12,598 - lightrag - ERROR - Failed to process document doc-3064a6842e9b5f92ffccd8c65ec75f51: RetryError[<Future at 0x712c880c1390 state=finished raised RateLimitError>]
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 87, in openai_complete_if_cache
    response = await openai_async_client.chat.completions.create(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/resources/chat/completions.py", line 1720, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1849, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1543, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1629, in _request
    return await self._retry_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1676, in _retry_request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1629, in _request
    return await self._retry_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1676, in _retry_request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_base_client.py", line 1644, in _request
    raise self._make_status_error_from_response(err.response) from None
openai.RateLimitError: Error code: 429 - {'error': {'message': 'Rate limit reached for gpt-4o-mini in organization org-UtrVUsfGpRINGO0QzXcCQOyp on tokens per min (TPM): Limit 200000, Used 197077, Requested 5179. Please try again in 676ms. Visit https://platform.openai.com/account/rate-limits to learn more.', 'type': 'tokens', 'param': None, 'code': 'rate_limit_exceeded'}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 420, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 490, in extract_entities
    all_entities_data.append(await result)
                             ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 204, in _merge_nodes_then_upsert
    description = await _handle_entity_relation_summary(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 121, in _handle_entity_relation_summary
    summary = await use_llm_func(use_prompt, max_tokens=summary_max_tokens)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 597, in gpt_4o_mini_complete
    return await openai_complete_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 419, in exc_check
    raise retry_exc from fut.exception()
tenacity.RetryError: RetryError[<Future at 0x712c880c1390 state=finished raised RateLimitError>]

2025-01-11 04:05:12,790 - lightrag - INFO - Writing graph with 1810 nodes, 0 edges
2025-01-11 04:05:21,791 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:05:21,939 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 04:05:21,940 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:05:21,940 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:05:21,970 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1810 nodes, 0 edges
2025-01-11 04:05:21,983 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 04:05:21,994 - lightrag - INFO - Processing 1 new unique documents
2025-01-11 04:05:22,592 - lightrag - INFO - Inserting 431 vectors to chunks
2025-01-11 04:05:27,496 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:06:43,834 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:06:43,970 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 04:06:43,970 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:06:43,970 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:06:44,000 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1810 nodes, 0 edges
2025-01-11 04:06:44,013 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 04:06:44,025 - lightrag - INFO - Processing 1 new unique documents
2025-01-11 04:06:44,623 - lightrag - INFO - Inserting 431 vectors to chunks
2025-01-11 04:06:49,961 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:07:24,278 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:07:24,414 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 04:07:24,415 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:07:24,415 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:07:24,444 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1810 nodes, 0 edges
2025-01-11 04:07:24,456 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 04:07:24,468 - lightrag - INFO - Processing 1 new unique documents
2025-01-11 04:07:25,080 - lightrag - INFO - Inserting 431 vectors to chunks
2025-01-11 04:07:30,191 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:09:17,007 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:09:17,143 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 04:09:17,144 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:09:17,144 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:09:17,174 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1810 nodes, 0 edges
2025-01-11 04:09:17,187 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 04:09:17,199 - lightrag - INFO - Processing 1 new unique documents
2025-01-11 04:09:17,808 - lightrag - INFO - Inserting 431 vectors to chunks
2025-01-11 04:09:23,065 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:09:44,162 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:09:44,297 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 04:09:44,298 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:09:44,298 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:09:44,327 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1810 nodes, 0 edges
2025-01-11 04:09:44,340 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 04:09:46,021 - lightrag - INFO - kw_prompt result:
2025-01-11 04:09:46,022 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 04:17:53,702 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:17:53,835 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 04:17:53,836 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:17:53,836 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:17:53,868 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1810 nodes, 0 edges
2025-01-11 04:17:53,881 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 04:17:55,756 - lightrag - INFO - kw_prompt result:
2025-01-11 04:17:55,756 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 04:20:57,143 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:20:57,277 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 04:20:57,277 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:20:57,277 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:20:57,306 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1810 nodes, 0 edges
2025-01-11 04:20:57,318 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 04:30:50,736 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:30:50,736 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 04:30:50,737 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:30:50,737 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:30:50,737 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 04:31:17,175 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:31:17,176 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 04:31:17,176 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:31:17,176 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:31:17,176 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 04:31:17,177 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 04:31:17,426 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:31:38,442 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 04:31:38,442 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 04:31:38,442 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:31:38,442 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:31:38,443 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 04:31:38,444 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 04:31:38,691 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:31:59,357 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:31:59,359 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:31:59,360 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-11 04:32:19,889 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 04:32:21,118 - lightrag - INFO - Writing graph with 35 nodes, 17 edges
2025-01-11 04:32:21,134 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:32:45,503 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:32:45,506 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:32:45,507 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-11 04:32:47,930 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 04:32:49,785 - lightrag - INFO - Writing graph with 51 nodes, 34 edges
2025-01-11 04:32:49,788 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:33:21,910 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:33:21,913 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:33:21,915 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-11 04:33:24,039 - lightrag - INFO - Inserting 29 vectors to relationships
2025-01-11 04:33:26,348 - lightrag - INFO - Writing graph with 69 nodes, 62 edges
2025-01-11 04:33:26,353 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:33:50,198 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:33:50,202 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:33:50,203 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-11 04:33:52,535 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-11 04:33:54,031 - lightrag - INFO - Writing graph with 84 nodes, 74 edges
2025-01-11 04:33:54,036 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:34:14,087 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:34:14,091 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:34:14,092 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-11 04:34:16,022 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-11 04:34:20,063 - lightrag - INFO - Writing graph with 97 nodes, 107 edges
2025-01-11 04:34:20,069 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 04:34:46,320 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:34:46,327 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:34:46,328 - lightrag - INFO - Inserting 68 vectors to entities
2025-01-11 04:34:49,271 - lightrag - INFO - Inserting 35 vectors to relationships
2025-01-11 04:34:51,906 - lightrag - INFO - Writing graph with 130 nodes, 139 edges
2025-01-11 04:34:51,914 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:35:15,926 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:35:15,932 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:35:15,933 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 04:35:18,405 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 04:35:20,418 - lightrag - INFO - Writing graph with 133 nodes, 152 edges
2025-01-11 04:35:20,425 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:35:49,154 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:35:49,160 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:35:49,161 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-11 04:35:51,517 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-11 04:35:53,328 - lightrag - INFO - Writing graph with 142 nodes, 168 edges
2025-01-11 04:35:53,335 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:36:22,797 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:36:22,803 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:36:22,804 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 04:36:25,193 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-11 04:36:27,440 - lightrag - INFO - Writing graph with 150 nodes, 195 edges
2025-01-11 04:36:27,448 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:36:32,636 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 04:36:32,637 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 04:36:32,637 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 04:36:32,637 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 04:36:32,638 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 04:36:32,639 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 04:36:32,919 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:37:02,458 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:37:02,467 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:37:02,468 - lightrag - INFO - Inserting 51 vectors to entities
2025-01-11 04:37:04,671 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-11 04:37:06,366 - lightrag - INFO - Writing graph with 162 nodes, 217 edges
2025-01-11 04:37:06,373 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 04:37:06,375 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:37:21,107 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:37:21,117 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:37:21,120 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-11 04:37:21,438 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-11 04:37:21,679 - lightrag - INFO - Writing graph with 62 nodes, 32 edges
2025-01-11 04:37:21,688 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:37:29,209 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:37:33,237 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:37:33,239 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-11 04:37:35,398 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 04:37:37,368 - lightrag - INFO - Writing graph with 166 nodes, 226 edges
2025-01-11 04:37:37,376 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:38:05,861 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:38:05,867 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:38:05,869 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-11 04:38:06,117 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-11 04:38:06,242 - lightrag - INFO - Writing graph with 89 nodes, 46 edges
2025-01-11 04:38:06,246 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:38:13,746 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:38:13,754 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:38:13,755 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-11 04:38:15,875 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-11 04:38:17,646 - lightrag - INFO - Writing graph with 182 nodes, 237 edges
2025-01-11 04:38:17,658 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 04:38:31,523 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:38:31,524 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:38:31,525 - lightrag - INFO - Inserting 11 vectors to entities
2025-01-11 04:38:31,624 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-11 04:38:31,757 - lightrag - INFO - Writing graph with 105 nodes, 60 edges
2025-01-11 04:38:31,763 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:38:51,064 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:38:51,071 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:38:51,073 - lightrag - INFO - Inserting 63 vectors to entities
2025-01-11 04:38:53,352 - lightrag - INFO - Inserting 38 vectors to relationships
2025-01-11 04:38:55,795 - lightrag - INFO - Writing graph with 226 nodes, 274 edges
2025-01-11 04:38:55,809 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:39:06,246 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:39:06,253 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:39:06,254 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-11 04:39:06,519 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 04:39:06,674 - lightrag - INFO - Writing graph with 128 nodes, 76 edges
2025-01-11 04:39:06,680 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:39:42,096 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:39:42,099 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:39:42,100 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 04:39:42,407 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 04:39:42,549 - lightrag - INFO - Writing graph with 149 nodes, 93 edges
2025-01-11 04:39:42,554 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:39:55,268 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:39:55,277 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:39:55,279 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 04:39:57,522 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-11 04:39:59,634 - lightrag - INFO - Writing graph with 229 nodes, 286 edges
2025-01-11 04:39:59,644 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:40:22,227 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:40:22,231 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:40:22,231 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-11 04:40:22,572 - lightrag - INFO - Inserting 4 vectors to relationships
2025-01-11 04:40:22,637 - lightrag - INFO - Writing graph with 172 nodes, 96 edges
2025-01-11 04:40:22,643 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:40:26,763 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:40:26,771 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:40:26,773 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-11 04:40:28,833 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-11 04:40:31,186 - lightrag - INFO - Writing graph with 231 nodes, 290 edges
2025-01-11 04:40:31,198 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 04:41:19,045 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:41:19,048 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:41:19,049 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-11 04:41:19,269 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 04:41:19,391 - lightrag - INFO - Writing graph with 184 nodes, 107 edges
2025-01-11 04:41:19,398 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:41:28,680 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:41:32,382 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:41:32,384 - lightrag - INFO - Inserting 60 vectors to entities
2025-01-11 04:41:34,882 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-11 04:41:36,881 - lightrag - INFO - Writing graph with 263 nodes, 311 edges
2025-01-11 04:41:36,895 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 04:41:59,622 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:41:59,626 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:41:59,627 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-11 04:41:59,971 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-11 04:42:00,087 - lightrag - INFO - Writing graph with 213 nodes, 117 edges
2025-01-11 04:42:00,095 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:42:53,107 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:42:53,111 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:42:53,112 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-11 04:42:53,341 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-11 04:42:53,617 - lightrag - INFO - Writing graph with 250 nodes, 149 edges
2025-01-11 04:42:53,626 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 04:43:55,816 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:43:55,838 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:43:55,841 - lightrag - INFO - Inserting 302 vectors to entities
2025-01-11 04:43:59,596 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-11 04:44:02,130 - lightrag - INFO - Writing graph with 529 nodes, 321 edges
2025-01-11 04:44:02,144 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:44:08,916 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:44:08,918 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:44:08,919 - lightrag - INFO - Inserting 24 vectors to entities
2025-01-11 04:44:09,119 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-11 04:44:09,261 - lightrag - INFO - Writing graph with 274 nodes, 163 edges
2025-01-11 04:44:09,270 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 04:44:09,273 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:44:36,138 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:44:36,148 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:44:36,151 - lightrag - INFO - Inserting 43 vectors to entities
2025-01-11 04:44:38,642 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-11 04:44:40,790 - lightrag - INFO - Writing graph with 540 nodes, 332 edges
2025-01-11 04:44:40,809 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:44:45,466 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:44:45,470 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:44:45,471 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-11 04:44:45,763 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-11 04:44:45,872 - lightrag - INFO - Writing graph with 287 nodes, 170 edges
2025-01-11 04:44:45,882 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 04:45:12,529 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:45:17,036 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:45:17,039 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 04:45:20,167 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-11 04:45:22,287 - lightrag - INFO - Writing graph with 546 nodes, 336 edges
2025-01-11 04:45:22,303 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:45:59,167 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:45:59,170 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:45:59,172 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-11 04:45:59,454 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-11 04:45:59,713 - lightrag - INFO - Writing graph with 308 nodes, 200 edges
2025-01-11 04:45:59,723 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:46:07,877 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:46:10,971 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:46:10,975 - lightrag - INFO - Inserting 51 vectors to entities
2025-01-11 04:46:13,149 - lightrag - INFO - Inserting 48 vectors to relationships
2025-01-11 04:46:15,686 - lightrag - INFO - Writing graph with 566 nodes, 361 edges
2025-01-11 04:46:15,701 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 04:46:15,703 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:46:57,115 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:46:57,117 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:46:57,118 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-11 04:46:57,387 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 04:46:57,588 - lightrag - INFO - Writing graph with 341 nodes, 223 edges
2025-01-11 04:46:57,599 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:47:08,774 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:47:13,498 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:47:13,501 - lightrag - INFO - Inserting 54 vectors to entities
2025-01-11 04:47:15,802 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-11 04:47:18,315 - lightrag - INFO - Writing graph with 578 nodes, 365 edges
2025-01-11 04:47:18,332 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:47:34,084 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:47:36,490 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:47:36,492 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 04:47:38,726 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 04:47:40,358 - lightrag - INFO - Writing graph with 582 nodes, 374 edges
2025-01-11 04:47:40,375 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:47:58,570 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:47:58,573 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:47:58,575 - lightrag - INFO - Inserting 23 vectors to entities
2025-01-11 04:47:58,786 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-11 04:47:59,039 - lightrag - INFO - Writing graph with 377 nodes, 249 edges
2025-01-11 04:47:59,054 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:48:14,364 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:48:18,703 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:48:18,708 - lightrag - INFO - Inserting 68 vectors to entities
2025-01-11 04:48:20,901 - lightrag - INFO - Inserting 45 vectors to relationships
2025-01-11 04:48:23,158 - lightrag - INFO - Writing graph with 615 nodes, 401 edges
2025-01-11 04:48:23,177 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 04:48:39,681 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:48:43,824 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:48:43,827 - lightrag - INFO - Inserting 55 vectors to entities
2025-01-11 04:48:46,016 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-11 04:48:48,405 - lightrag - INFO - Writing graph with 630 nodes, 423 edges
2025-01-11 04:48:48,429 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:49:11,272 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:49:13,585 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:49:13,588 - lightrag - INFO - Inserting 61 vectors to entities
2025-01-11 04:49:15,902 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-11 04:49:18,324 - lightrag - INFO - Writing graph with 651 nodes, 438 edges
2025-01-11 04:49:18,343 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:49:38,548 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:49:41,963 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:49:41,965 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-11 04:49:44,157 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-11 04:49:45,756 - lightrag - INFO - Writing graph with 664 nodes, 442 edges
2025-01-11 04:49:45,779 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:50:08,457 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:50:11,500 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:50:11,502 - lightrag - INFO - Inserting 50 vectors to entities
2025-01-11 04:50:13,888 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-11 04:50:16,462 - lightrag - INFO - Writing graph with 666 nodes, 452 edges
2025-01-11 04:50:16,481 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:50:34,500 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:50:34,509 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:50:34,511 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 04:50:36,600 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 04:50:38,229 - lightrag - INFO - Writing graph with 677 nodes, 465 edges
2025-01-11 04:50:38,248 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:51:05,165 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:51:09,933 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:51:09,938 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-11 04:51:12,845 - lightrag - INFO - Inserting 34 vectors to relationships
2025-01-11 04:51:14,973 - lightrag - INFO - Writing graph with 685 nodes, 474 edges
2025-01-11 04:51:14,993 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:51:48,931 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:51:52,718 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:51:52,723 - lightrag - INFO - Inserting 60 vectors to entities
2025-01-11 04:51:55,486 - lightrag - INFO - Inserting 49 vectors to relationships
2025-01-11 04:51:57,604 - lightrag - INFO - Writing graph with 702 nodes, 489 edges
2025-01-11 04:51:57,638 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 04:51:57,641 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:52:17,898 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:52:21,354 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:52:21,355 - lightrag - INFO - Inserting 44 vectors to entities
2025-01-11 04:52:23,726 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-11 04:52:26,153 - lightrag - INFO - Writing graph with 715 nodes, 499 edges
2025-01-11 04:52:26,174 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:52:49,742 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:52:53,346 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:52:53,350 - lightrag - INFO - Inserting 53 vectors to entities
2025-01-11 04:52:55,205 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-11 04:52:57,404 - lightrag - INFO - Writing graph with 728 nodes, 520 edges
2025-01-11 04:52:57,425 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:53:20,615 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:53:24,727 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:53:24,731 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-11 04:53:27,030 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-11 04:53:29,015 - lightrag - INFO - Writing graph with 730 nodes, 525 edges
2025-01-11 04:53:29,036 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:53:44,173 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:53:49,258 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:53:49,260 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-11 04:53:51,459 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-11 04:53:53,071 - lightrag - INFO - Writing graph with 742 nodes, 531 edges
2025-01-11 04:53:53,093 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:54:11,595 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:54:17,704 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:54:17,707 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 04:54:19,955 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 04:54:21,793 - lightrag - INFO - Writing graph with 745 nodes, 533 edges
2025-01-11 04:54:21,815 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:54:43,101 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:54:47,111 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:54:47,113 - lightrag - INFO - Inserting 49 vectors to entities
2025-01-11 04:54:49,224 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-11 04:54:51,066 - lightrag - INFO - Writing graph with 759 nodes, 547 edges
2025-01-11 04:54:51,091 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 04:55:12,057 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:55:14,861 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:55:14,863 - lightrag - INFO - Inserting 74 vectors to entities
2025-01-11 04:55:17,389 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-11 04:55:19,298 - lightrag - INFO - Writing graph with 791 nodes, 563 edges
2025-01-11 04:55:19,322 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:55:48,898 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:55:51,917 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:55:51,921 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-11 04:55:53,744 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-11 04:55:55,846 - lightrag - INFO - Writing graph with 801 nodes, 576 edges
2025-01-11 04:55:55,872 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 04:56:00,197 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 04:56:00,203 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-11 04:56:00,204 - lightrag - INFO - Load KV full_docs with 14 data
2025-01-11 04:56:00,205 - lightrag - INFO - Load KV text_chunks with 34 data
2025-01-11 04:56:00,214 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 377 nodes, 249 edges
2025-01-11 04:56:00,222 - lightrag - INFO - Loaded document status storage with 16 records
2025-01-11 04:56:00,223 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 04:56:00,224 - lightrag - INFO - Processing 6 new unique documents
2025-01-11 04:56:00,473 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:56:46,844 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:56:46,849 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:56:46,850 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 04:56:47,142 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 04:56:47,312 - lightrag - INFO - Writing graph with 393 nodes, 265 edges
2025-01-11 04:56:47,330 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:57:16,330 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:57:20,570 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:57:20,573 - lightrag - INFO - Inserting 295 vectors to entities
2025-01-11 04:57:24,177 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-11 04:57:26,284 - lightrag - INFO - Writing graph with 829 nodes, 599 edges
2025-01-11 04:57:26,308 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:57:46,577 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:57:51,616 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:57:51,618 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-11 04:57:53,660 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-11 04:57:55,648 - lightrag - INFO - Writing graph with 839 nodes, 612 edges
2025-01-11 04:57:55,672 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 04:57:55,674 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:58:08,901 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:58:11,687 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:58:11,690 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-11 04:58:13,768 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-11 04:58:15,858 - lightrag - INFO - Writing graph with 842 nodes, 619 edges
2025-01-11 04:58:15,886 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 04:58:24,171 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:58:24,178 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:58:24,180 - lightrag - INFO - Inserting 24 vectors to entities
2025-01-11 04:58:24,408 - lightrag - INFO - Inserting 45 vectors to relationships
2025-01-11 04:58:24,794 - lightrag - INFO - Writing graph with 444 nodes, 307 edges
2025-01-11 04:58:24,810 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 04:58:37,133 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:58:40,985 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:58:40,989 - lightrag - INFO - Inserting 56 vectors to entities
2025-01-11 04:58:43,053 - lightrag - INFO - Inserting 29 vectors to relationships
2025-01-11 04:58:45,458 - lightrag - INFO - Writing graph with 855 nodes, 624 edges
2025-01-11 04:58:45,485 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:59:05,208 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:59:09,265 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:59:09,268 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 04:59:13,056 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-11 04:59:15,134 - lightrag - INFO - Writing graph with 858 nodes, 640 edges
2025-01-11 04:59:15,158 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 04:59:44,918 - lightrag - INFO - Inserting entities into storage...
2025-01-11 04:59:48,045 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 04:59:48,052 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 04:59:50,491 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-11 04:59:52,578 - lightrag - INFO - Writing graph with 860 nodes, 642 edges
2025-01-11 04:59:52,604 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:00:18,749 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:00:21,717 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:00:21,721 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 05:00:23,879 - lightrag - INFO - Inserting 37 vectors to relationships
2025-01-11 05:00:26,161 - lightrag - INFO - Writing graph with 862 nodes, 653 edges
2025-01-11 05:00:26,187 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:00:49,147 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:00:52,194 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:00:52,197 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-11 05:00:54,623 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-11 05:00:57,165 - lightrag - INFO - Writing graph with 870 nodes, 674 edges
2025-01-11 05:00:57,194 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:01:16,320 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:01:16,332 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:01:16,334 - lightrag - INFO - Inserting 43 vectors to entities
2025-01-11 05:01:18,555 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 05:01:20,415 - lightrag - INFO - Writing graph with 873 nodes, 679 edges
2025-01-11 05:01:20,441 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:01:38,512 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:01:42,460 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:01:42,463 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-11 05:01:44,597 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-11 05:01:46,513 - lightrag - INFO - Writing graph with 876 nodes, 682 edges
2025-01-11 05:01:46,540 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:02:13,437 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:02:16,229 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:02:16,234 - lightrag - INFO - Inserting 59 vectors to entities
2025-01-11 05:02:18,619 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-11 05:02:20,961 - lightrag - INFO - Writing graph with 893 nodes, 687 edges
2025-01-11 05:02:20,988 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:02:31,858 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:02:31,871 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:02:31,875 - lightrag - INFO - Inserting 54 vectors to entities
2025-01-11 05:02:32,352 - lightrag - INFO - Inserting 89 vectors to relationships
2025-01-11 05:02:33,070 - lightrag - INFO - Writing graph with 574 nodes, 394 edges
2025-01-11 05:02:33,087 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:02:46,232 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:02:50,173 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:02:50,177 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-11 05:02:52,410 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 05:02:55,074 - lightrag - INFO - Writing graph with 893 nodes, 688 edges
2025-01-11 05:02:55,099 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:02:55,103 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:03:30,822 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:03:30,835 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:03:30,841 - lightrag - INFO - Inserting 73 vectors to entities
2025-01-11 05:03:33,264 - lightrag - INFO - Inserting 50 vectors to relationships
2025-01-11 05:03:35,943 - lightrag - INFO - Writing graph with 920 nodes, 707 edges
2025-01-11 05:03:35,973 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:03:57,670 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:04:01,744 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:04:01,749 - lightrag - INFO - Inserting 49 vectors to entities
2025-01-11 05:04:04,344 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-11 05:04:06,745 - lightrag - INFO - Writing graph with 933 nodes, 714 edges
2025-01-11 05:04:06,776 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:04:29,104 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:04:29,110 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:04:29,111 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 05:04:29,532 - lightrag - INFO - Inserting 29 vectors to relationships
2025-01-11 05:04:29,798 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:04:29,815 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:04:38,595 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:04:45,003 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:04:45,012 - lightrag - INFO - Inserting 64 vectors to entities
2025-01-11 05:04:47,490 - lightrag - INFO - Inserting 61 vectors to relationships
2025-01-11 05:04:49,810 - lightrag - INFO - Writing graph with 948 nodes, 733 edges
2025-01-11 05:04:49,840 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:05:09,588 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:05:13,896 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:05:13,900 - lightrag - INFO - Inserting 71 vectors to entities
2025-01-11 05:05:17,679 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-11 05:05:20,205 - lightrag - INFO - Writing graph with 988 nodes, 739 edges
2025-01-11 05:05:20,235 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:05:42,108 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:05:44,916 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:05:44,920 - lightrag - INFO - Inserting 53 vectors to entities
2025-01-11 05:05:47,735 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 05:05:49,724 - lightrag - INFO - Writing graph with 996 nodes, 745 edges
2025-01-11 05:05:49,753 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:06:14,795 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:06:19,111 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:06:19,116 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-11 05:06:21,536 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-11 05:06:23,335 - lightrag - INFO - Writing graph with 1002 nodes, 753 edges
2025-01-11 05:06:23,366 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:06:46,581 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:06:50,402 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:06:50,405 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 05:06:53,047 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 05:06:55,075 - lightrag - INFO - Writing graph with 1011 nodes, 760 edges
2025-01-11 05:06:55,106 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:07:31,291 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:07:36,714 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:07:36,723 - lightrag - INFO - Inserting 69 vectors to entities
2025-01-11 05:07:39,411 - lightrag - INFO - Inserting 55 vectors to relationships
2025-01-11 05:07:41,882 - lightrag - INFO - Writing graph with 1033 nodes, 777 edges
2025-01-11 05:07:41,914 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:08:09,270 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:08:13,170 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:08:13,176 - lightrag - INFO - Inserting 55 vectors to entities
2025-01-11 05:08:15,381 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-11 05:08:18,594 - lightrag - INFO - Writing graph with 1051 nodes, 781 edges
2025-01-11 05:08:18,625 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:08:43,355 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:08:46,963 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:08:49,743 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-11 05:08:52,214 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-11 05:08:54,258 - lightrag - INFO - Writing graph with 1053 nodes, 784 edges
2025-01-11 05:08:54,287 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:08:54,290 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:09:12,365 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:09:16,400 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:09:16,406 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 05:09:18,854 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-11 05:09:21,112 - lightrag - INFO - Writing graph with 1054 nodes, 789 edges
2025-01-11 05:09:21,145 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:09:43,855 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:09:47,175 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:09:49,744 - lightrag - INFO - Inserting 61 vectors to entities
2025-01-11 05:09:52,101 - lightrag - INFO - Inserting 48 vectors to relationships
2025-01-11 05:09:55,956 - lightrag - INFO - Writing graph with 1070 nodes, 809 edges
2025-01-11 05:09:55,989 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:10:14,368 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:10:19,618 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:10:22,329 - lightrag - INFO - Inserting 49 vectors to entities
2025-01-11 05:10:25,141 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-11 05:10:27,436 - lightrag - INFO - Writing graph with 1080 nodes, 816 edges
2025-01-11 05:10:27,469 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:10:43,248 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:10:46,914 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:10:49,045 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-11 05:10:51,247 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 05:10:53,300 - lightrag - INFO - Writing graph with 1082 nodes, 819 edges
2025-01-11 05:10:53,332 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:11:06,986 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:11:10,242 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:11:10,245 - lightrag - INFO - Inserting 43 vectors to entities
2025-01-11 05:11:12,808 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 05:11:15,099 - lightrag - INFO - Writing graph with 1093 nodes, 829 edges
2025-01-11 05:11:15,131 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:11:30,697 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:11:36,190 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:11:42,318 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 05:11:44,415 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 05:11:46,331 - lightrag - INFO - Writing graph with 1095 nodes, 832 edges
2025-01-11 05:11:46,365 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:11:46,910 - lightrag - ERROR - Failed to process document doc-05135db5bdf79f8e990c0d5cd95618cc: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 420, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 468, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 403, in _process_single_content
    glean_result = await _user_llm_func_with_cache(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 374, in _user_llm_func_with_cache
    res: str = await use_llm_func(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-11 05:11:46,962 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:46,981 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:11:47,006 - lightrag - ERROR - Failed to process document doc-d7ccad49e8b02ca09d44e7767258fe87: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,048 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,065 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:11:47,068 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:11:47,089 - lightrag - ERROR - Failed to process document doc-f18b9597926261c74f20e01473bcbf86: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,130 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,150 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:11:47,171 - lightrag - ERROR - Failed to process document doc-cf232ad85094b654a1392e31897cb640: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,215 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,234 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:11:47,256 - lightrag - ERROR - Failed to process document doc-0465fea8173e1c60d402a28d480216c8: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,299 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,318 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:11:47,339 - lightrag - ERROR - Failed to process document doc-1220486513f4b4c1cdb02996fd7e9b83: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,381 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,400 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:11:47,422 - lightrag - ERROR - Failed to process document doc-744a779e89fff6df607e57d1d1ad64f6: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,464 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,482 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:11:47,503 - lightrag - ERROR - Failed to process document doc-5f668d0e8882dfc33dfa6ae94ef81b73: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,544 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,562 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:11:47,584 - lightrag - ERROR - Failed to process document doc-cb5d460df418413cbb3399219c82dfe6: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,626 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,644 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:11:47,664 - lightrag - ERROR - Failed to process document doc-c324c21801b9e891ee9be986693f1504: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,706 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,723 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:11:47,743 - lightrag - ERROR - Failed to process document doc-db61f9b985aff9038b9e2e4d139d883d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,790 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,808 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:11:47,830 - lightrag - ERROR - Failed to process document doc-f18ba8979d52cc20dcc653f8e1e72b72: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,871 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,886 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:11:47,889 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:11:47,909 - lightrag - ERROR - Failed to process document doc-0ef67cc8476cc4fb3216a72f303b7c9b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:47,951 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:47,969 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:11:47,990 - lightrag - ERROR - Failed to process document doc-48677cd9f2d8fa25acd62f3b86369b42: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:48,030 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:48,048 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:11:48,069 - lightrag - ERROR - Failed to process document doc-a490e48f4d6ddb4885cd5caa3fcc079e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:48,111 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:48,128 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:11:48,148 - lightrag - ERROR - Failed to process document doc-db4bc517bbf074bc982272bfa7f581b4: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:48,189 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:48,209 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 05:11:48,229 - lightrag - ERROR - Failed to process document doc-bd91c0dc5fcf2042b0220440a4a7def1: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:11:48,270 - lightrag - INFO - Writing graph with 615 nodes, 421 edges
2025-01-11 05:11:48,290 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:12:10,896 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 05:12:10,908 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-11 05:12:10,909 - lightrag - INFO - Load KV full_docs with 18 data
2025-01-11 05:12:10,910 - lightrag - INFO - Load KV text_chunks with 46 data
2025-01-11 05:12:10,924 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 615 nodes, 421 edges
2025-01-11 05:12:10,940 - lightrag - INFO - Loaded document status storage with 37 records
2025-01-11 05:12:10,941 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 05:12:10,942 - lightrag - INFO - Processing 2 new unique documents
2025-01-11 05:12:11,189 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:12:13,531 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:12:17,299 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:12:17,310 - lightrag - INFO - Inserting 69 vectors to entities
2025-01-11 05:12:19,640 - lightrag - INFO - Inserting 47 vectors to relationships
2025-01-11 05:12:22,010 - lightrag - INFO - Writing graph with 1115 nodes, 853 edges
2025-01-11 05:12:22,045 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:12:33,173 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:12:33,176 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:12:33,177 - lightrag - INFO - Inserting 19 vectors to entities
2025-01-11 05:12:33,372 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 05:12:33,560 - lightrag - INFO - Writing graph with 633 nodes, 438 edges
2025-01-11 05:12:33,586 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:12:35,725 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:12:39,184 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:12:39,189 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 05:12:41,686 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-11 05:12:44,409 - lightrag - INFO - Writing graph with 1121 nodes, 866 edges
2025-01-11 05:12:44,450 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:13:02,473 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:13:05,319 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:13:07,803 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 05:13:10,397 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 05:13:12,308 - lightrag - INFO - Writing graph with 1123 nodes, 876 edges
2025-01-11 05:13:12,341 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:13:35,967 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:13:39,441 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:13:41,901 - lightrag - INFO - Inserting 55 vectors to entities
2025-01-11 05:13:44,804 - lightrag - INFO - Inserting 46 vectors to relationships
2025-01-11 05:13:47,217 - lightrag - INFO - Writing graph with 1130 nodes, 882 edges
2025-01-11 05:13:47,250 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:13:47,253 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:13:53,747 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:13:53,751 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:13:53,758 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-11 05:13:54,047 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-11 05:13:54,411 - lightrag - INFO - Writing graph with 680 nodes, 478 edges
2025-01-11 05:13:54,428 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:13:54,431 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:14:03,143 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:14:06,799 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:14:06,802 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 05:14:09,054 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 05:14:10,428 - lightrag - INFO - Writing graph with 1130 nodes, 883 edges
2025-01-11 05:14:10,462 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:14:31,427 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:14:36,057 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:14:38,488 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-11 05:14:40,967 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-11 05:14:43,012 - lightrag - INFO - Writing graph with 1137 nodes, 887 edges
2025-01-11 05:14:43,063 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:14:44,063 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:14:44,068 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:14:44,069 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-11 05:14:44,365 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 05:14:44,537 - lightrag - INFO - Writing graph with 694 nodes, 492 edges
2025-01-11 05:14:44,556 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:15:01,323 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:15:04,701 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:15:04,705 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 05:15:07,195 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 05:15:09,468 - lightrag - INFO - Writing graph with 1138 nodes, 894 edges
2025-01-11 05:15:09,504 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:15:28,249 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:15:31,742 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:15:34,690 - lightrag - INFO - Inserting 44 vectors to entities
2025-01-11 05:15:37,158 - lightrag - INFO - Inserting 29 vectors to relationships
2025-01-11 05:15:40,000 - lightrag - INFO - Writing graph with 1139 nodes, 898 edges
2025-01-11 05:15:40,036 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:15:57,737 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:16:01,060 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:16:02,992 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 05:16:03,236 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:16:04,911 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-11 05:16:06,589 - lightrag - INFO - Writing graph with 1139 nodes, 898 edges
2025-01-11 05:16:06,623 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:16:06,666 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:16:06,668 - lightrag - INFO - Inserting 21 vectors to entities
2025-01-11 05:16:06,891 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 05:16:07,090 - lightrag - INFO - Writing graph with 702 nodes, 505 edges
2025-01-11 05:16:07,112 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:16:21,271 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:16:24,362 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:16:27,389 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 05:16:29,509 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-11 05:16:31,356 - lightrag - INFO - Writing graph with 1139 nodes, 898 edges
2025-01-11 05:16:31,393 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:16:55,947 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:16:59,097 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:16:59,101 - lightrag - INFO - Inserting 74 vectors to entities
2025-01-11 05:17:01,575 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-11 05:17:03,935 - lightrag - INFO - Writing graph with 1173 nodes, 920 edges
2025-01-11 05:17:03,970 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:17:19,042 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:17:22,934 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:17:22,937 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-11 05:17:25,315 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 05:17:27,402 - lightrag - INFO - Writing graph with 1173 nodes, 930 edges
2025-01-11 05:17:27,439 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:17:43,788 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:17:47,369 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:17:50,011 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-11 05:17:52,235 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-11 05:17:54,573 - lightrag - INFO - Writing graph with 1175 nodes, 937 edges
2025-01-11 05:17:54,613 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:18:03,518 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:18:03,525 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:18:03,527 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-11 05:18:03,928 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-11 05:18:04,219 - lightrag - INFO - Writing graph with 758 nodes, 534 edges
2025-01-11 05:18:04,247 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:18:16,694 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:18:19,656 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:18:19,664 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-11 05:18:21,990 - lightrag - INFO - Inserting 38 vectors to relationships
2025-01-11 05:18:24,296 - lightrag - INFO - Writing graph with 1181 nodes, 946 edges
2025-01-11 05:18:24,330 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:18:24,333 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:18:40,699 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:18:43,951 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:18:43,954 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 05:18:46,467 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 05:18:48,420 - lightrag - INFO - Writing graph with 1183 nodes, 948 edges
2025-01-11 05:18:48,457 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:19:03,075 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:19:05,937 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:19:05,940 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-11 05:19:08,528 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 05:19:10,670 - lightrag - INFO - Writing graph with 1185 nodes, 952 edges
2025-01-11 05:19:10,706 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:19:31,065 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:19:31,831 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:19:31,834 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:19:31,835 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-11 05:19:32,101 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 05:19:32,336 - lightrag - INFO - Writing graph with 777 nodes, 555 edges
2025-01-11 05:19:32,357 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:19:34,894 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:19:34,898 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-11 05:19:37,298 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-11 05:19:39,425 - lightrag - INFO - Writing graph with 1191 nodes, 958 edges
2025-01-11 05:19:39,464 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:19:55,741 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:19:59,334 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:19:59,337 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 05:20:01,620 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-11 05:20:03,562 - lightrag - INFO - Writing graph with 1194 nodes, 959 edges
2025-01-11 05:20:03,598 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:20:10,408 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:20:10,412 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:20:10,413 - lightrag - INFO - Inserting 25 vectors to entities
2025-01-11 05:20:10,664 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-11 05:20:10,799 - lightrag - INFO - Writing graph with 783 nodes, 562 edges
2025-01-11 05:20:10,822 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:20:23,672 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:20:27,961 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:20:32,253 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-11 05:20:34,855 - lightrag - INFO - Inserting 34 vectors to relationships
2025-01-11 05:20:37,290 - lightrag - INFO - Writing graph with 1195 nodes, 963 edges
2025-01-11 05:20:37,328 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:20:54,875 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:20:57,581 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:20:57,584 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-11 05:20:59,956 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 05:21:02,311 - lightrag - INFO - Writing graph with 1196 nodes, 972 edges
2025-01-11 05:21:02,348 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:21:17,922 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:21:23,482 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:21:23,485 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 05:21:25,909 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-11 05:21:27,481 - lightrag - INFO - Writing graph with 1196 nodes, 972 edges
2025-01-11 05:21:27,517 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:21:31,885 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:21:31,895 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:21:31,896 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-11 05:21:32,307 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 05:21:32,520 - lightrag - INFO - Writing graph with 822 nodes, 581 edges
2025-01-11 05:21:32,544 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:21:52,851 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:21:57,004 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:21:59,672 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 05:22:02,455 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-11 05:22:05,148 - lightrag - INFO - Writing graph with 1197 nodes, 973 edges
2025-01-11 05:22:05,184 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:22:20,496 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:22:24,017 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:22:27,175 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 05:22:29,709 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 05:22:31,679 - lightrag - INFO - Writing graph with 1198 nodes, 975 edges
2025-01-11 05:22:31,717 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:22:50,777 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:22:53,858 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:22:53,860 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 05:22:56,251 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 05:22:58,913 - lightrag - INFO - Writing graph with 1198 nodes, 981 edges
2025-01-11 05:22:58,949 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:22:58,953 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:23:12,772 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:23:13,057 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:23:16,661 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:23:16,663 - lightrag - INFO - Inserting 54 vectors to entities
2025-01-11 05:23:16,929 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:23:16,932 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-11 05:23:17,201 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-11 05:23:17,455 - lightrag - INFO - Writing graph with 856 nodes, 598 edges
2025-01-11 05:23:17,480 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:23:19,365 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-11 05:23:21,400 - lightrag - INFO - Writing graph with 1200 nodes, 982 edges
2025-01-11 05:23:21,437 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:23:41,179 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:23:45,850 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:23:48,791 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 05:23:50,935 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 05:23:53,052 - lightrag - INFO - Writing graph with 1203 nodes, 983 edges
2025-01-11 05:23:53,092 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:24:04,187 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:24:07,166 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:24:07,169 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 05:24:09,858 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-11 05:24:11,602 - lightrag - INFO - Writing graph with 1203 nodes, 983 edges
2025-01-11 05:24:11,640 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:24:27,779 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:24:31,385 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:24:31,390 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-11 05:24:33,981 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 05:24:36,242 - lightrag - INFO - Writing graph with 1206 nodes, 986 edges
2025-01-11 05:24:36,279 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:24:45,269 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:24:45,284 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:24:45,285 - lightrag - INFO - Inserting 54 vectors to entities
2025-01-11 05:24:45,828 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-11 05:24:46,058 - lightrag - INFO - Writing graph with 890 nodes, 618 edges
2025-01-11 05:24:46,082 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:24:51,207 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:24:54,645 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:24:54,650 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 05:24:57,098 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 05:24:59,202 - lightrag - INFO - Writing graph with 1206 nodes, 987 edges
2025-01-11 05:24:59,241 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:25:15,589 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:25:20,795 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:25:20,799 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 05:25:22,985 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-11 05:25:25,146 - lightrag - INFO - Writing graph with 1209 nodes, 988 edges
2025-01-11 05:25:25,183 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:25:47,116 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:25:52,889 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:25:52,894 - lightrag - INFO - Inserting 44 vectors to entities
2025-01-11 05:25:55,500 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 05:25:57,570 - lightrag - INFO - Writing graph with 1211 nodes, 989 edges
2025-01-11 05:25:57,608 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:26:10,586 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:26:13,066 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:26:13,070 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 05:26:15,597 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-11 05:26:17,363 - lightrag - INFO - Writing graph with 1212 nodes, 989 edges
2025-01-11 05:26:17,401 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:26:34,821 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:26:45,339 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:26:48,184 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-11 05:26:50,250 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 05:26:52,249 - lightrag - INFO - Writing graph with 1214 nodes, 991 edges
2025-01-11 05:26:52,286 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:27:09,952 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:27:14,522 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:27:14,531 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 05:27:17,320 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-11 05:27:19,778 - lightrag - INFO - Writing graph with 1215 nodes, 992 edges
2025-01-11 05:27:19,817 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:27:19,820 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:27:39,577 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:27:39,590 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:27:39,967 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 05:27:39,983 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-11 05:27:39,984 - lightrag - INFO - Load KV full_docs with 28 data
2025-01-11 05:27:39,985 - lightrag - INFO - Load KV text_chunks with 74 data
2025-01-11 05:27:40,005 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 890 nodes, 618 edges
2025-01-11 05:27:40,027 - lightrag - INFO - Loaded document status storage with 37 records
2025-01-11 05:27:40,028 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 05:27:40,029 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 05:27:40,029 - lightrag - INFO - Processing 2 new unique documents
2025-01-11 05:27:40,272 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:27:42,094 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 05:27:44,458 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-11 05:27:47,379 - lightrag - INFO - Writing graph with 1215 nodes, 992 edges
2025-01-11 05:27:47,417 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:28:11,323 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:28:14,852 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:28:19,152 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 05:28:20,880 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-11 05:28:23,766 - lightrag - INFO - Writing graph with 1215 nodes, 997 edges
2025-01-11 05:28:23,804 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:28:36,577 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:28:40,320 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:28:42,791 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-11 05:28:43,149 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:28:45,189 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-11 05:28:47,421 - lightrag - INFO - Writing graph with 1215 nodes, 999 edges
2025-01-11 05:28:47,460 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:28:52,805 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:28:52,807 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 05:28:53,217 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-11 05:28:53,484 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:28:53,515 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:29:03,198 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:29:06,077 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:29:06,081 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 05:29:08,311 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 05:29:10,667 - lightrag - INFO - Writing graph with 1216 nodes, 999 edges
2025-01-11 05:29:10,705 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:29:35,832 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:29:35,846 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:29:35,849 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-11 05:29:37,858 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-11 05:29:39,821 - lightrag - INFO - Writing graph with 1217 nodes, 1003 edges
2025-01-11 05:29:39,860 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:29:54,572 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:30:00,192 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:30:00,197 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 05:30:02,492 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 05:30:04,190 - lightrag - INFO - Writing graph with 1217 nodes, 1006 edges
2025-01-11 05:30:04,227 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:30:22,557 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:30:26,434 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:30:29,780 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 05:30:32,071 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-11 05:30:34,624 - lightrag - INFO - Writing graph with 1217 nodes, 1008 edges
2025-01-11 05:30:34,675 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:30:58,277 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:31:02,466 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:31:05,510 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 05:31:07,949 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-11 05:31:10,417 - lightrag - INFO - Writing graph with 1218 nodes, 1010 edges
2025-01-11 05:31:10,454 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:31:24,986 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:31:29,394 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:31:31,967 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-11 05:31:34,251 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-11 05:31:35,867 - lightrag - INFO - Writing graph with 1218 nodes, 1010 edges
2025-01-11 05:31:35,906 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:31:53,426 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:31:53,436 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:31:57,441 - lightrag - INFO - Inserting 29 vectors to entities
2025-01-11 05:31:59,516 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 05:32:01,878 - lightrag - INFO - Writing graph with 1220 nodes, 1013 edges
2025-01-11 05:32:01,916 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:32:01,920 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:32:17,269 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:32:20,384 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:32:20,388 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 05:32:22,825 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 05:32:24,849 - lightrag - INFO - Writing graph with 1222 nodes, 1013 edges
2025-01-11 05:32:24,888 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:32:41,414 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:32:44,941 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:32:44,946 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-11 05:32:47,370 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 05:32:50,038 - lightrag - INFO - Writing graph with 1224 nodes, 1015 edges
2025-01-11 05:32:50,076 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:33:12,602 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:33:52,082 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:33:55,271 - lightrag - INFO - Inserting 54 vectors to entities
2025-01-11 05:33:57,707 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 05:33:59,967 - lightrag - INFO - Writing graph with 1229 nodes, 1015 edges
2025-01-11 05:34:00,007 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:03,210 - lightrag - ERROR - Failed to process document doc-f18ba8979d52cc20dcc653f8e1e72b72: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 420, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 468, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 400, in _process_single_content
    final_result = await _user_llm_func_with_cache(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 378, in _user_llm_func_with_cache
    res: str = await use_llm_func(input_text)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-11 05:34:03,272 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:03,295 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:34:03,298 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:03,319 - lightrag - ERROR - Failed to process document doc-48677cd9f2d8fa25acd62f3b86369b42: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:03,382 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:03,408 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:03,429 - lightrag - ERROR - Failed to process document doc-db4bc517bbf074bc982272bfa7f581b4: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:03,491 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:03,518 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 05:34:03,538 - lightrag - ERROR - Failed to process document doc-bd91c0dc5fcf2042b0220440a4a7def1: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:03,601 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:03,627 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:34:03,652 - lightrag - ERROR - Failed to process document doc-4dcccec77a2e49ea27f75ed9294007a2: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:03,715 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:03,741 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:03,763 - lightrag - ERROR - Failed to process document doc-a490e48f4d6ddb4885cd5caa3fcc079e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:03,825 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:03,850 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:03,870 - lightrag - ERROR - Failed to process document doc-0e905ef847809fb5b528423bf17638ac: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:03,931 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:03,956 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:03,980 - lightrag - ERROR - Failed to process document doc-3390abcaab347a4dd0b7cb472f33f76b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:04,043 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:04,069 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:34:04,090 - lightrag - ERROR - Failed to process document doc-7c668b969a39abc6f2951374a4e8384b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:04,154 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:04,178 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:34:04,199 - lightrag - ERROR - Failed to process document doc-b28697989f3a7833a344098c194f725a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:04,261 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:04,286 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:04,306 - lightrag - ERROR - Failed to process document doc-0ef67cc8476cc4fb3216a72f303b7c9b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:04,368 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:04,391 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:34:04,393 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:04,413 - lightrag - ERROR - Failed to process document doc-35d53738f9b1688b8aa450fd32289bfc: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:04,475 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:04,499 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:04,519 - lightrag - ERROR - Failed to process document doc-5c0c296871b8ec5b9ced4b30b651ff1a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:04,581 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:04,605 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:34:04,626 - lightrag - ERROR - Failed to process document doc-3f7e228aed24913e1af96e7e84388a27: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:04,688 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:04,715 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:04,735 - lightrag - ERROR - Failed to process document doc-429e2a324d28eeb96967210982181a2f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:04,811 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:04,838 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:34:04,858 - lightrag - ERROR - Failed to process document doc-620a337c6ee01c5cbdaf6b8fe0404281: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:04,921 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:04,945 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:04,965 - lightrag - ERROR - Failed to process document doc-71a358cae0b97516f05dd813241769f0: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 05:34:05,027 - lightrag - INFO - Writing graph with 915 nodes, 639 edges
2025-01-11 05:34:05,051 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:34:15,886 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:34:19,169 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 05:34:19,188 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-11 05:34:19,190 - lightrag - INFO - Load KV full_docs with 29 data
2025-01-11 05:34:19,191 - lightrag - INFO - Load KV text_chunks with 76 data
2025-01-11 05:34:19,213 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 915 nodes, 639 edges
2025-01-11 05:34:19,236 - lightrag - INFO - Loaded document status storage with 48 records
2025-01-11 05:34:19,237 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 05:34:19,238 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 05:34:19,238 - lightrag - INFO - Processing 1 new unique documents
2025-01-11 05:34:19,499 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:34:22,968 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:34:25,946 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-11 05:34:28,897 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 05:34:30,710 - lightrag - INFO - Writing graph with 1232 nodes, 1015 edges
2025-01-11 05:34:30,748 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:34:46,061 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:34:48,756 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:34:48,760 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-11 05:34:50,637 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-11 05:34:52,473 - lightrag - INFO - Writing graph with 1232 nodes, 1017 edges
2025-01-11 05:34:52,513 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:35:15,626 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:35:20,005 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:35:20,008 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 05:35:22,625 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 05:35:25,736 - lightrag - INFO - Writing graph with 1237 nodes, 1018 edges
2025-01-11 05:35:25,778 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:35:45,647 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:35:45,656 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:35:45,663 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-11 05:35:48,171 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-11 05:35:50,983 - lightrag - INFO - Writing graph with 1238 nodes, 1018 edges
2025-01-11 05:35:51,022 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:36:52,899 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:36:56,414 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:36:56,419 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 05:36:59,195 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-11 05:37:01,260 - lightrag - INFO - Writing graph with 1238 nodes, 1020 edges
2025-01-11 05:37:01,299 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:37:25,108 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:37:33,727 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:37:33,736 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-11 05:37:35,718 - lightrag - INFO - Inserting 34 vectors to relationships
2025-01-11 05:37:38,714 - lightrag - INFO - Writing graph with 1238 nodes, 1022 edges
2025-01-11 05:37:38,755 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:37:58,776 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:38:01,933 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:38:04,693 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 05:38:07,318 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-11 05:38:09,668 - lightrag - INFO - Writing graph with 1238 nodes, 1026 edges
2025-01-11 05:38:09,705 - lightrag - INFO - Processing 5 new unique documents
2025-01-11 05:38:09,708 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:38:30,975 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:38:34,215 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:38:37,253 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-11 05:38:40,008 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 05:38:40,090 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:38:42,035 - lightrag - INFO - Writing graph with 1241 nodes, 1030 edges
2025-01-11 05:38:42,074 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:38:56,547 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:38:56,549 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-11 05:38:56,957 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-11 05:38:57,240 - lightrag - INFO - Writing graph with 924 nodes, 660 edges
2025-01-11 05:38:57,270 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 05:38:57,272 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:39:01,931 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:39:05,049 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:39:05,053 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 05:39:07,509 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 05:39:09,759 - lightrag - INFO - Writing graph with 1241 nodes, 1031 edges
2025-01-11 05:39:09,799 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:39:24,675 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:39:28,374 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:39:31,836 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 05:39:34,371 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 05:39:36,555 - lightrag - INFO - Writing graph with 1241 nodes, 1031 edges
2025-01-11 05:39:36,595 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:40:01,403 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:40:04,740 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:40:04,747 - lightrag - INFO - Inserting 54 vectors to entities
2025-01-11 05:40:07,528 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 05:40:09,901 - lightrag - INFO - Writing graph with 1249 nodes, 1031 edges
2025-01-11 05:40:09,941 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:40:19,876 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:40:19,886 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:40:19,889 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 05:40:20,260 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 05:40:20,510 - lightrag - INFO - Writing graph with 936 nodes, 675 edges
2025-01-11 05:40:20,536 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:40:33,254 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:40:37,544 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:40:37,556 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-11 05:40:39,998 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-11 05:40:43,729 - lightrag - INFO - Writing graph with 1250 nodes, 1031 edges
2025-01-11 05:40:44,922 - lightrag - INFO - kw_prompt result:
2025-01-11 05:40:44,923 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 05:40:45,792 - lightrag - INFO - Local query uses 24 entites, 44 relations, 3 text units
2025-01-11 05:40:46,501 - lightrag - INFO - Global query uses 13 entites, 60 relations, 4 text units
2025-01-11 05:41:16,388 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:41:16,390 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:41:16,391 - lightrag - INFO - Inserting 15 vectors to entities
2025-01-11 05:41:16,548 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-11 05:41:16,723 - lightrag - INFO - Writing graph with 950 nodes, 685 edges
2025-01-11 05:41:16,750 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:42:16,546 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:42:26,825 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:42:26,826 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-11 05:42:27,237 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 05:42:27,455 - lightrag - INFO - Writing graph with 981 nodes, 703 edges
2025-01-11 05:42:27,484 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 05:46:08,975 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:46:15,998 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:46:16,001 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-11 05:46:16,409 - lightrag - INFO - Inserting 52 vectors to relationships
2025-01-11 05:46:16,899 - lightrag - INFO - Writing graph with 1032 nodes, 752 edges
2025-01-11 05:46:16,927 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:48:19,139 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:48:19,141 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:48:19,143 - lightrag - INFO - Inserting 16 vectors to entities
2025-01-11 05:48:19,295 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-11 05:48:19,591 - lightrag - INFO - Writing graph with 1054 nodes, 780 edges
2025-01-11 05:48:19,621 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 05:49:27,985 - lightrag - INFO - Inserting entities into storage...
2025-01-11 05:49:27,994 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 05:49:27,995 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-11 05:49:28,285 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 05:49:28,512 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 05:49:28,543 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 05:58:10,072 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 05:58:10,133 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 05:58:10,138 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 05:58:10,142 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 05:58:10,176 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 05:58:10,258 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:00:38,258 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:00:38,319 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:00:38,324 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:00:38,328 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:00:38,363 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:00:38,443 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:02:01,145 - lightrag - INFO - kw_prompt result:
2025-01-11 06:02:01,145 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 06:02:02,102 - lightrag - INFO - Local query uses 5 entites, 7 relations, 4 text units
2025-01-11 06:02:02,788 - lightrag - INFO - Global query uses 14 entites, 35 relations, 4 text units
2025-01-11 06:02:36,036 - lightrag - INFO - kw_prompt result:
2025-01-11 06:02:36,036 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 06:02:36,769 - lightrag - INFO - Local query uses 19 entites, 46 relations, 3 text units
2025-01-11 06:02:37,545 - lightrag - INFO - Global query uses 13 entites, 35 relations, 4 text units
2025-01-11 06:03:56,494 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:03:56,555 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:03:56,560 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:03:56,565 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:03:56,599 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:03:56,679 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:04:01,664 - lightrag - INFO - kw_prompt result:
2025-01-11 06:04:01,664 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 06:04:02,599 - lightrag - INFO - Local query uses 23 entites, 61 relations, 3 text units
2025-01-11 06:04:03,310 - lightrag - INFO - Global query uses 14 entites, 59 relations, 4 text units
2025-01-11 06:04:21,707 - lightrag - INFO - kw_prompt result:
2025-01-11 06:04:21,707 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 06:04:22,442 - lightrag - INFO - Local query uses 60 entites, 21 relations, 3 text units
2025-01-11 06:04:23,592 - lightrag - INFO - Global query uses 13 entites, 36 relations, 4 text units
2025-01-11 06:06:16,678 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:06:16,740 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:06:16,745 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:06:16,750 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:06:16,783 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:06:16,868 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:07:04,578 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:07:04,643 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:07:04,648 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:07:04,653 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:07:04,689 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:07:04,771 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:08:03,276 - lightrag - ERROR - Failed to process document doc-0e905ef847809fb5b528423bf17638ac: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 420, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 468, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 403, in _process_single_content
    glean_result = await _user_llm_func_with_cache(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 374, in _user_llm_func_with_cache
    res: str = await use_llm_func(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-11 06:08:03,360 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:03,396 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 06:08:03,428 - lightrag - ERROR - Failed to process document doc-b28697989f3a7833a344098c194f725a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:03,511 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:03,552 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 06:08:03,572 - lightrag - ERROR - Failed to process document doc-bd91c0dc5fcf2042b0220440a4a7def1: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:03,659 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:03,695 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 06:08:03,716 - lightrag - ERROR - Failed to process document doc-3390abcaab347a4dd0b7cb472f33f76b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:03,792 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:03,820 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 06:08:03,823 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 06:08:03,844 - lightrag - ERROR - Failed to process document doc-620a337c6ee01c5cbdaf6b8fe0404281: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:03,921 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:03,950 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 06:08:03,971 - lightrag - ERROR - Failed to process document doc-cba2596113ddacaa49e5bb3de7e91c5f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:04,048 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:04,078 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 06:08:04,099 - lightrag - ERROR - Failed to process document doc-5576bf4fbb2c96bf9e51bc0d936ccb7a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:04,176 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:04,205 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 06:08:04,226 - lightrag - ERROR - Failed to process document doc-35d53738f9b1688b8aa450fd32289bfc: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:04,304 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:04,334 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 06:08:04,355 - lightrag - ERROR - Failed to process document doc-ed9c26e91fe18f205148db036a271784: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:04,431 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:04,461 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 06:08:04,481 - lightrag - ERROR - Failed to process document doc-71a358cae0b97516f05dd813241769f0: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:04,558 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:04,588 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 06:08:04,608 - lightrag - ERROR - Failed to process document doc-5c0c296871b8ec5b9ced4b30b651ff1a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:04,685 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:04,715 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 06:08:04,735 - lightrag - ERROR - Failed to process document doc-560032e91c0a85545e20af1d653e18aa: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:04,813 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:04,843 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 06:08:04,864 - lightrag - ERROR - Failed to process document doc-3f7e228aed24913e1af96e7e84388a27: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:04,942 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:04,972 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 06:08:04,994 - lightrag - ERROR - Failed to process document doc-429e2a324d28eeb96967210982181a2f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:05,073 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:05,100 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 06:08:05,103 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 06:08:05,125 - lightrag - ERROR - Failed to process document doc-29e882970b77c2b5f3587d6a440e113a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:05,204 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:05,236 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 06:08:05,257 - lightrag - ERROR - Failed to process document doc-cb0e7bf014e2f0e0d13508a2dcf078e1: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:05,338 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:05,371 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 06:08:05,392 - lightrag - ERROR - Failed to process document doc-e4a41fee7b5d2c1517671d35a91b4595: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 06:08:05,470 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 06:08:05,500 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 06:09:04,950 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:09:05,014 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:09:05,020 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:09:05,024 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:09:05,061 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:09:05,142 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:09:54,479 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:09:54,541 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:09:54,546 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:09:54,551 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:09:54,585 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:09:54,667 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:12:56,476 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:12:56,539 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:12:56,544 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:12:56,548 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:12:56,584 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:12:56,667 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:18:09,337 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:18:09,400 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:18:09,405 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:18:09,410 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:18:09,444 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:18:09,527 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:19:16,798 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:19:16,865 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:19:16,870 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:19:16,875 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:19:16,913 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:19:17,002 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:23:38,115 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:23:38,178 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:23:38,183 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:23:38,187 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:23:38,222 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:23:38,305 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:25:14,363 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:25:14,429 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:25:14,434 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:25:14,439 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:25:14,473 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:25:14,554 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:25:23,067 - lightrag - INFO - kw_prompt result:
2025-01-11 06:25:23,067 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 06:26:15,024 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:26:15,086 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:26:15,091 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:26:15,096 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:26:15,129 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:26:15,209 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:26:36,001 - lightrag - INFO - kw_prompt result:
2025-01-11 06:26:36,002 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 06:30:43,688 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:30:43,749 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:30:43,754 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:30:43,759 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:30:43,793 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:30:43,876 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:30:48,356 - lightrag - INFO - kw_prompt result:
2025-01-11 06:30:48,357 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 06:32:15,568 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:32:15,630 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:32:15,635 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:32:15,639 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:32:15,673 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:32:15,753 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:32:25,504 - lightrag - INFO - kw_prompt result:
2025-01-11 06:32:25,504 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 06:33:56,006 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:33:56,069 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:33:56,074 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:33:56,078 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:33:56,114 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:33:56,208 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:34:18,002 - lightrag - INFO - kw_prompt result:
2025-01-11 06:34:18,002 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 06:41:39,869 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:41:39,930 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:41:39,935 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:41:39,940 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:41:39,974 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:41:40,055 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:41:53,165 - lightrag - INFO - kw_prompt result:
2025-01-11 06:41:53,166 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 06:43:14,874 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:43:14,935 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:43:14,940 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:43:14,945 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:43:14,979 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:43:15,062 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:43:21,377 - lightrag - INFO - kw_prompt result:
2025-01-11 06:43:21,377 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 06:48:05,669 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:48:05,730 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:48:05,735 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:48:05,740 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:48:05,776 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:48:05,857 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:48:33,774 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:48:33,836 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:48:33,841 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:48:33,845 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:48:33,879 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:48:33,959 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:48:37,616 - lightrag - INFO - kw_prompt result:
2025-01-11 06:48:37,616 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 06:50:19,995 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:50:20,057 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:50:20,062 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:50:20,067 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:50:20,101 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:50:20,182 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:50:50,260 - lightrag - INFO - kw_prompt result:
2025-01-11 06:50:50,260 - lightrag - WARNING - low_level_keywords is empty, switching from hybrid mode to global mode
2025-01-11 06:50:50,260 - lightrag - INFO - Using global mode for query processing
2025-01-11 06:50:51,300 - lightrag - INFO - Global query uses 9 entites, 25 relations, 3 text units
2025-01-11 06:52:07,370 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:52:07,431 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:52:07,436 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:52:07,441 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:52:07,474 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:52:07,554 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:56:04,161 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:56:04,228 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:56:04,234 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:56:04,239 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:56:04,275 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:56:04,362 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:56:12,146 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 06:56:12,167 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-11 06:56:12,169 - lightrag - INFO - Load KV full_docs with 36 data
2025-01-11 06:56:12,170 - lightrag - INFO - Load KV text_chunks with 94 data
2025-01-11 06:56:12,195 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1089 nodes, 797 edges
2025-01-11 06:56:12,222 - lightrag - INFO - Loaded document status storage with 55 records
2025-01-11 06:56:12,224 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 06:56:12,224 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 06:56:12,225 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 06:56:12,225 - lightrag - INFO - Processing 4 new unique documents
2025-01-11 06:56:12,471 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 06:59:04,972 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 06:59:05,034 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 06:59:05,039 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 06:59:05,044 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 06:59:05,079 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 06:59:05,159 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 06:59:11,716 - lightrag - INFO - kw_prompt result:
2025-01-11 06:59:11,717 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 06:59:12,657 - lightrag - INFO - Local query uses 60 entites, 91 relations, 3 text units
2025-01-11 06:59:13,356 - lightrag - INFO - Global query uses 9 entites, 22 relations, 4 text units
2025-01-11 07:00:07,231 - lightrag - INFO - kw_prompt result:
2025-01-11 07:00:07,231 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:00:08,145 - lightrag - INFO - Local query uses 60 entites, 38 relations, 3 text units
2025-01-11 07:00:09,081 - lightrag - INFO - Global query uses 15 entites, 23 relations, 3 text units
2025-01-11 07:00:13,713 - lightrag - INFO - kw_prompt result:
2025-01-11 07:00:13,713 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:00:14,523 - lightrag - INFO - Local query uses 31 entites, 10 relations, 4 text units
2025-01-11 07:00:15,705 - lightrag - INFO - Global query uses 11 entites, 37 relations, 3 text units
2025-01-11 07:01:27,735 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:01:27,796 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:01:27,801 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:01:27,806 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:01:27,839 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:01:27,919 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:01:32,321 - lightrag - INFO - kw_prompt result:
2025-01-11 07:01:32,321 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:01:33,256 - lightrag - INFO - Local query uses 34 entites, 28 relations, 3 text units
2025-01-11 07:01:34,098 - lightrag - INFO - Global query uses 25 entites, 60 relations, 3 text units
2025-01-11 07:02:20,563 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:02:20,625 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:02:20,630 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:02:20,635 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:02:20,668 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:02:20,748 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:02:26,817 - lightrag - INFO - kw_prompt result:
2025-01-11 07:02:26,817 - lightrag - WARNING - high_level_keywords is empty, switching from hybrid mode to local mode
2025-01-11 07:02:26,817 - lightrag - INFO - Using local mode for query processing
2025-01-11 07:02:27,881 - lightrag - INFO - Local query uses 9 entites, 4 relations, 5 text units
2025-01-11 07:03:33,333 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:03:33,396 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:03:33,400 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:03:33,405 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:03:33,439 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:03:33,520 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:03:39,457 - lightrag - INFO - kw_prompt result:
2025-01-11 07:03:39,457 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:03:40,664 - lightrag - INFO - Local query uses 60 entites, 79 relations, 5 text units
2025-01-11 07:03:41,432 - lightrag - INFO - Global query uses 11 entites, 37 relations, 3 text units
2025-01-11 07:03:57,479 - lightrag - INFO - kw_prompt result:
2025-01-11 07:03:57,479 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:03:58,275 - lightrag - INFO - Local query uses 60 entites, 47 relations, 3 text units
2025-01-11 07:03:59,034 - lightrag - INFO - Global query uses 31 entites, 60 relations, 6 text units
2025-01-11 07:04:58,463 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:04:58,527 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:04:58,532 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:04:58,537 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:04:58,571 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:04:58,653 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:05:03,570 - lightrag - INFO - kw_prompt result:
2025-01-11 07:05:03,570 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:05:04,495 - lightrag - INFO - Local query uses 10 entites, 5 relations, 4 text units
2025-01-11 07:05:05,246 - lightrag - INFO - Global query uses 26 entites, 60 relations, 6 text units
2025-01-11 07:06:33,956 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:06:34,020 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:06:34,025 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:06:34,029 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:06:34,064 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:06:34,144 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:06:38,168 - lightrag - INFO - kw_prompt result:
2025-01-11 07:06:38,168 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:06:39,189 - lightrag - INFO - Local query uses 60 entites, 71 relations, 3 text units
2025-01-11 07:06:40,386 - lightrag - INFO - Global query uses 15 entites, 22 relations, 3 text units
2025-01-11 07:07:02,369 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:07:02,431 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:07:02,436 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:07:02,441 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:07:02,474 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:07:02,556 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:07:59,879 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:07:59,941 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:07:59,946 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:07:59,951 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:07:59,984 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:08:00,064 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:09:48,782 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:09:48,844 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:09:48,849 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:09:48,854 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:09:48,888 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:09:48,968 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:10:23,781 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:10:23,848 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:10:23,853 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:10:23,858 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:10:23,894 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:10:23,981 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:11:25,524 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:11:25,589 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:11:25,594 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:11:25,599 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:11:25,634 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:11:25,717 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:11:25,718 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,718 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,719 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,719 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,720 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,721 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,721 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,722 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,722 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,723 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,723 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,724 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:25,724 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,640 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:11:37,700 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:11:37,705 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:11:37,710 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:11:37,743 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:11:37,826 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:11:37,827 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,827 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,828 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,828 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,829 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,830 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,830 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,831 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,831 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,832 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,832 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,833 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:11:37,833 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:02,992 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:12:03,064 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:12:03,069 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:12:03,074 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:12:03,109 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:12:03,191 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:12:03,192 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,192 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,193 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,193 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,194 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,194 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,195 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,196 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,196 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,197 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,197 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,198 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:12:03,198 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:54,971 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:16:55,031 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:16:55,036 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:16:55,040 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:16:55,074 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:16:55,154 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:16:55,155 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,156 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,156 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,157 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,157 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,158 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,159 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,159 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,160 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,160 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,160 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,161 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:16:55,161 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,557 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:17:36,619 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:17:36,626 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:17:36,631 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:17:36,666 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:17:36,746 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:17:36,747 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,748 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,749 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,749 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,750 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,750 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,751 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,751 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,752 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,752 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,753 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,753 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:17:36,754 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,282 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:18:04,343 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:18:04,348 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:18:04,352 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:18:04,386 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:18:04,466 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:18:04,467 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,467 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,468 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,468 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,469 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,469 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,470 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,471 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,471 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,472 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,472 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,472 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:18:04,473 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 07:20:21,713 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:20:21,775 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:20:21,780 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:20:21,785 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:20:21,819 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:20:21,898 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:20:29,325 - lightrag - INFO - kw_prompt result:
2025-01-11 07:20:29,325 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:20:30,332 - lightrag - INFO - Local query uses 45 entites, 14 relations, 4 text units
2025-01-11 07:20:30,986 - lightrag - INFO - Global query uses 13 entites, 19 relations, 4 text units
2025-01-11 07:21:32,886 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:21:32,948 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:21:32,953 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:21:32,958 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:21:32,992 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:21:33,078 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:21:39,246 - lightrag - INFO - kw_prompt result:
2025-01-11 07:21:39,246 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:21:40,767 - lightrag - INFO - Local query uses 60 entites, 37 relations, 4 text units
2025-01-11 07:21:41,665 - lightrag - INFO - Global query uses 12 entites, 22 relations, 3 text units
2025-01-11 07:23:46,881 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:23:46,943 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:23:46,949 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:23:46,953 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:23:46,987 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:23:47,069 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:23:52,059 - lightrag - INFO - kw_prompt result:
2025-01-11 07:23:52,059 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:23:54,253 - lightrag - INFO - Local query uses 32 entites, 21 relations, 4 text units
2025-01-11 07:23:54,814 - lightrag - INFO - Global query uses 14 entites, 22 relations, 4 text units
2025-01-11 07:24:12,851 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:24:12,912 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:24:12,917 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:24:12,921 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:24:12,955 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:24:13,035 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:24:18,630 - lightrag - INFO - kw_prompt result:
2025-01-11 07:24:18,630 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:24:19,674 - lightrag - INFO - Local query uses 60 entites, 30 relations, 6 text units
2025-01-11 07:24:20,810 - lightrag - INFO - Global query uses 9 entites, 20 relations, 3 text units
2025-01-11 07:25:16,084 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:25:16,149 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:25:16,154 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:25:16,159 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:25:16,195 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:25:16,281 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:25:47,051 - lightrag - INFO - kw_prompt result:
2025-01-11 07:25:47,052 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:25:47,994 - lightrag - INFO - Local query uses 5 entites, 0 relations, 4 text units
2025-01-11 07:25:48,537 - lightrag - INFO - Global query uses 10 entites, 23 relations, 4 text units
2025-01-11 07:28:00,722 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:28:00,802 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:28:00,807 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:28:00,813 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:28:00,847 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:28:00,931 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:28:39,162 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:28:39,212 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:28:39,216 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:28:39,220 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:28:39,254 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:28:39,340 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:29:20,335 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:29:20,393 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:29:20,398 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:29:20,402 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:29:20,441 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:29:20,517 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:32:58,925 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:32:58,990 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:32:58,995 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:32:59,001 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:32:59,037 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:32:59,121 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:33:04,425 - lightrag - INFO - kw_prompt result:
2025-01-11 07:33:04,426 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:33:05,390 - lightrag - INFO - Local query uses 59 entites, 70 relations, 5 text units
2025-01-11 07:33:06,071 - lightrag - INFO - Global query uses 10 entites, 15 relations, 3 text units
2025-01-11 07:33:08,924 - lightrag - INFO - kw_prompt result:
2025-01-11 07:33:08,925 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:33:09,391 - lightrag - INFO - Local query uses 8 entites, 3 relations, 3 text units
2025-01-11 07:33:10,277 - lightrag - INFO - Global query uses 12 entites, 21 relations, 3 text units
2025-01-11 07:33:12,753 - lightrag - INFO - kw_prompt result:
2025-01-11 07:33:12,753 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:33:13,462 - lightrag - INFO - Local query uses 60 entites, 48 relations, 3 text units
2025-01-11 07:33:14,166 - lightrag - INFO - Global query uses 10 entites, 37 relations, 3 text units
2025-01-11 07:35:44,886 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:35:44,935 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:35:44,940 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:35:44,946 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:35:44,978 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:35:45,063 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:36:13,683 - lightrag - INFO - kw_prompt result:
2025-01-11 07:36:13,683 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:36:14,612 - lightrag - INFO - Local query uses 19 entites, 34 relations, 3 text units
2025-01-11 07:36:15,422 - lightrag - INFO - Global query uses 15 entites, 60 relations, 4 text units
2025-01-11 07:37:26,564 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:37:26,617 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:37:26,622 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:37:26,627 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:37:26,663 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:37:26,736 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:38:19,690 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:38:19,753 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:38:19,759 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:38:19,764 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:38:19,799 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:38:19,886 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:39:41,766 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:39:41,815 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:39:41,819 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:39:41,823 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:39:41,861 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:39:41,946 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:40:47,278 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:40:47,329 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:40:47,333 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:40:47,337 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:40:47,372 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:40:47,446 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:41:00,893 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:41:00,944 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:41:00,948 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:41:00,952 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:41:00,989 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:41:01,060 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:41:12,024 - lightrag - INFO - kw_prompt result:
2025-01-11 07:41:12,024 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 07:41:13,281 - lightrag - INFO - Local query uses 19 entites, 54 relations, 3 text units
2025-01-11 07:41:14,103 - lightrag - INFO - Global query uses 13 entites, 47 relations, 4 text units
2025-01-11 07:50:37,766 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:50:37,829 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:50:37,834 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:50:37,839 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:50:37,875 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:50:37,960 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:51:08,954 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:51:09,014 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:51:09,019 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:51:09,024 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:51:09,058 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:51:09,138 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:52:12,047 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:52:12,107 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:52:12,112 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:52:12,117 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:52:12,151 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:52:12,231 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:53:18,203 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:53:18,264 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:53:18,268 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:53:18,273 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:53:18,307 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:53:18,386 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:57:49,757 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:57:49,821 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:57:49,826 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:57:49,831 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:57:49,865 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:57:49,945 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 07:59:13,259 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 07:59:13,319 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 07:59:13,324 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 07:59:13,329 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 07:59:13,363 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 07:59:13,441 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:03:32,903 - lightrag - INFO - kw_prompt result:
2025-01-11 08:03:32,904 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 08:03:33,960 - lightrag - INFO - Local query uses 17 entites, 59 relations, 4 text units
2025-01-11 08:03:34,767 - lightrag - INFO - Global query uses 13 entites, 55 relations, 4 text units
2025-01-11 08:04:59,278 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:04:59,340 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:04:59,344 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:04:59,349 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:04:59,383 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:04:59,461 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:06:39,380 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:06:39,441 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:06:39,446 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:06:39,450 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:06:39,485 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:06:39,574 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:07:03,717 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:07:03,781 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:07:03,786 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:07:03,791 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:07:03,829 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:07:03,929 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:17:48,467 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:17:48,530 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:17:48,535 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:17:48,540 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:17:48,574 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:17:48,657 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:28:42,312 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:28:42,376 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:28:42,381 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:28:42,385 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:28:42,421 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:28:42,502 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:36:02,998 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:36:03,062 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:36:03,067 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:36:03,072 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:36:03,107 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:36:03,192 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:38:06,477 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:38:06,540 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:38:06,545 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:38:06,550 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:38:06,585 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:38:06,683 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:40:00,500 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:40:00,574 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:40:00,579 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:40:00,584 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:40:00,618 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:40:00,700 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:40:27,148 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:40:27,209 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:40:27,214 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:40:27,219 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:40:27,253 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:40:27,333 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:46:52,561 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:46:52,622 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:46:52,627 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:46:52,632 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:46:52,667 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:46:52,747 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:50:03,249 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:50:03,312 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:50:03,317 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:50:03,322 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:50:03,358 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:50:03,444 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:50:03,445 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,446 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,446 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,447 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,447 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,448 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,448 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,449 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,449 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,450 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,450 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,451 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:50:03,451 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:50,952 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:54:51,013 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:54:51,018 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:54:51,023 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:54:51,057 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:54:51,138 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:54:51,139 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,140 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,141 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,141 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,142 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,142 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,143 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,143 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,144 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,144 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,145 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,145 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:54:51,146 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,357 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:55:21,417 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:55:21,422 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:55:21,427 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:55:21,460 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:55:21,538 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:55:21,540 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,540 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,541 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,541 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,542 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,542 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,543 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,543 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,544 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,544 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,545 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,545 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:55:21,546 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 08:56:51,910 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:56:51,971 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:56:51,976 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:56:51,981 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:56:52,016 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:56:52,097 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:58:47,259 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 08:58:47,320 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 08:58:47,325 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 08:58:47,330 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 08:58:47,363 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 08:58:47,443 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 08:58:55,311 - lightrag - INFO - kw_prompt result:
2025-01-11 08:58:55,311 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 08:58:56,547 - lightrag - INFO - Local query uses 29 entites, 69 relations, 4 text units
2025-01-11 08:58:56,582 - lightrag - INFO - kw_prompt result:
2025-01-11 08:58:56,582 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 08:58:57,370 - lightrag - INFO - Local query uses 60 entites, 17 relations, 4 text units
2025-01-11 08:58:57,437 - lightrag - INFO - Global query uses 12 entites, 44 relations, 4 text units
2025-01-11 08:58:58,151 - lightrag - INFO - Global query uses 12 entites, 60 relations, 4 text units
2025-01-11 08:59:01,811 - lightrag - INFO - kw_prompt result:
2025-01-11 08:59:01,812 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 08:59:02,660 - lightrag - INFO - Local query uses 60 entites, 17 relations, 4 text units
2025-01-11 08:59:03,400 - lightrag - INFO - Global query uses 15 entites, 60 relations, 4 text units
2025-01-11 08:59:41,952 - lightrag - INFO - kw_prompt result:
2025-01-11 08:59:41,952 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 08:59:43,014 - lightrag - INFO - Local query uses 60 entites, 86 relations, 3 text units
2025-01-11 08:59:43,971 - lightrag - INFO - Global query uses 17 entites, 60 relations, 3 text units
2025-01-11 08:59:46,595 - lightrag - INFO - kw_prompt result:
2025-01-11 08:59:46,595 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 08:59:47,290 - lightrag - INFO - Local query uses 60 entites, 48 relations, 3 text units
2025-01-11 08:59:48,086 - lightrag - INFO - Global query uses 17 entites, 60 relations, 3 text units
2025-01-11 09:00:54,231 - lightrag - INFO - kw_prompt result:
2025-01-11 09:00:54,231 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:00:55,018 - lightrag - INFO - Local query uses 60 entites, 72 relations, 3 text units
2025-01-11 09:00:55,863 - lightrag - INFO - Global query uses 24 entites, 60 relations, 4 text units
2025-01-11 09:01:03,483 - lightrag - INFO - kw_prompt result:
2025-01-11 09:01:03,483 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:01:04,277 - lightrag - INFO - Local query uses 60 entites, 17 relations, 3 text units
2025-01-11 09:01:04,976 - lightrag - INFO - Global query uses 14 entites, 60 relations, 3 text units
2025-01-11 09:01:08,091 - lightrag - INFO - kw_prompt result:
2025-01-11 09:01:08,091 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:01:08,910 - lightrag - INFO - Local query uses 60 entites, 24 relations, 4 text units
2025-01-11 09:01:09,672 - lightrag - INFO - Global query uses 11 entites, 60 relations, 3 text units
2025-01-11 09:03:41,126 - lightrag - INFO - kw_prompt result:
2025-01-11 09:03:41,126 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:03:41,884 - lightrag - INFO - Local query uses 16 entites, 13 relations, 4 text units
2025-01-11 09:03:42,497 - lightrag - INFO - Global query uses 13 entites, 60 relations, 3 text units
2025-01-11 09:04:19,065 - lightrag - INFO - kw_prompt result:
2025-01-11 09:04:19,065 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:04:19,804 - lightrag - INFO - Local query uses 7 entites, 6 relations, 3 text units
2025-01-11 09:04:20,336 - lightrag - INFO - Global query uses 13 entites, 42 relations, 3 text units
2025-01-11 09:04:42,433 - lightrag - INFO - kw_prompt result:
2025-01-11 09:04:42,433 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:04:43,220 - lightrag - INFO - Local query uses 60 entites, 52 relations, 3 text units
2025-01-11 09:04:43,913 - lightrag - INFO - Global query uses 13 entites, 42 relations, 3 text units
2025-01-11 09:06:09,976 - lightrag - INFO - kw_prompt result:
2025-01-11 09:06:09,976 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:06:10,581 - lightrag - INFO - Local query uses 40 entites, 70 relations, 4 text units
2025-01-11 09:06:11,283 - lightrag - INFO - Global query uses 12 entites, 60 relations, 4 text units
2025-01-11 09:06:38,585 - lightrag - INFO - kw_prompt result:
2025-01-11 09:06:38,585 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:06:39,381 - lightrag - INFO - Local query uses 32 entites, 66 relations, 5 text units
2025-01-11 09:06:40,095 - lightrag - INFO - Global query uses 17 entites, 60 relations, 4 text units
2025-01-11 09:08:05,312 - lightrag - INFO - kw_prompt result:
2025-01-11 09:08:05,312 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:08:06,017 - lightrag - INFO - Local query uses 33 entites, 75 relations, 3 text units
2025-01-11 09:08:06,718 - lightrag - INFO - Global query uses 16 entites, 60 relations, 4 text units
2025-01-11 09:12:25,743 - lightrag - INFO - kw_prompt result:
2025-01-11 09:12:25,743 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:12:26,548 - lightrag - INFO - Local query uses 60 entites, 18 relations, 3 text units
2025-01-11 09:12:27,383 - lightrag - INFO - Global query uses 14 entites, 21 relations, 4 text units
2025-01-11 09:12:35,312 - lightrag - INFO - kw_prompt result:
2025-01-11 09:12:35,312 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:12:36,179 - lightrag - INFO - Local query uses 60 entites, 21 relations, 3 text units
2025-01-11 09:12:37,058 - lightrag - INFO - Global query uses 13 entites, 24 relations, 4 text units
2025-01-11 09:12:40,816 - lightrag - INFO - kw_prompt result:
2025-01-11 09:12:40,816 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:12:41,511 - lightrag - INFO - Local query uses 60 entites, 19 relations, 3 text units
2025-01-11 09:12:42,466 - lightrag - INFO - Global query uses 11 entites, 60 relations, 4 text units
2025-01-11 09:12:56,998 - lightrag - INFO - kw_prompt result:
2025-01-11 09:12:56,998 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:12:57,732 - lightrag - INFO - Local query uses 60 entites, 22 relations, 3 text units
2025-01-11 09:12:58,280 - lightrag - INFO - Global query uses 13 entites, 26 relations, 4 text units
2025-01-11 09:19:17,244 - lightrag - INFO - kw_prompt result:
2025-01-11 09:19:17,244 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:19:18,002 - lightrag - INFO - Local query uses 60 entites, 25 relations, 4 text units
2025-01-11 09:19:18,785 - lightrag - INFO - Global query uses 17 entites, 60 relations, 3 text units
2025-01-11 09:19:25,753 - lightrag - INFO - kw_prompt result:
2025-01-11 09:19:25,753 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:19:26,483 - lightrag - INFO - Local query uses 60 entites, 24 relations, 6 text units
2025-01-11 09:19:27,202 - lightrag - INFO - Global query uses 15 entites, 60 relations, 3 text units
2025-01-11 09:19:31,215 - lightrag - INFO - kw_prompt result:
2025-01-11 09:19:31,215 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:19:31,988 - lightrag - INFO - Local query uses 60 entites, 21 relations, 4 text units
2025-01-11 09:19:32,719 - lightrag - INFO - Global query uses 13 entites, 53 relations, 3 text units
2025-01-11 09:19:50,589 - lightrag - INFO - kw_prompt result:
2025-01-11 09:19:50,589 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:19:51,308 - lightrag - INFO - Local query uses 60 entites, 25 relations, 3 text units
2025-01-11 09:19:52,271 - lightrag - INFO - Global query uses 10 entites, 41 relations, 4 text units
2025-01-11 09:20:31,683 - lightrag - INFO - kw_prompt result:
2025-01-11 09:20:31,683 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:20:32,610 - lightrag - INFO - Local query uses 60 entites, 26 relations, 4 text units
2025-01-11 09:20:33,475 - lightrag - INFO - Global query uses 17 entites, 57 relations, 3 text units
2025-01-11 09:23:46,413 - lightrag - INFO - kw_prompt result:
2025-01-11 09:23:46,413 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 09:23:47,106 - lightrag - INFO - Local query uses 60 entites, 25 relations, 6 text units
2025-01-11 09:23:47,867 - lightrag - INFO - Global query uses 14 entites, 36 relations, 3 text units
2025-01-11 09:59:42,262 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 09:59:42,329 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 09:59:42,334 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 09:59:42,340 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 09:59:42,376 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 09:59:42,461 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 10:24:41,277 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 10:24:41,338 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 10:24:41,344 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 10:24:41,350 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 10:24:41,385 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 10:24:41,469 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 10:25:04,572 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 10:25:04,633 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 10:25:04,638 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 10:25:04,643 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 10:25:04,678 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 10:25:04,760 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 10:25:33,284 - lightrag - INFO - kw_prompt result:
2025-01-11 10:25:33,284 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 10:25:34,790 - lightrag - INFO - kw_prompt result:
2025-01-11 10:25:34,791 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:25:35,886 - lightrag - INFO - Local query uses 60 entites, 49 relations, 3 text units
2025-01-11 10:25:36,854 - lightrag - INFO - Global query uses 9 entites, 60 relations, 7 text units
2025-01-11 10:25:47,121 - lightrag - INFO - kw_prompt result:
2025-01-11 10:25:47,121 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:25:47,923 - lightrag - INFO - Local query uses 60 entites, 17 relations, 3 text units
2025-01-11 10:25:48,655 - lightrag - INFO - Global query uses 19 entites, 60 relations, 3 text units
2025-01-11 10:25:52,439 - lightrag - INFO - kw_prompt result:
2025-01-11 10:25:52,439 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 10:26:19,165 - lightrag - INFO - kw_prompt result:
2025-01-11 10:26:19,166 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:26:20,069 - lightrag - INFO - Local query uses 60 entites, 26 relations, 4 text units
2025-01-11 10:26:20,747 - lightrag - INFO - Global query uses 17 entites, 60 relations, 3 text units
2025-01-11 10:26:50,970 - lightrag - INFO - kw_prompt result:
2025-01-11 10:26:50,970 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 10:26:59,873 - lightrag - INFO - kw_prompt result:
2025-01-11 10:26:59,874 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:27:00,644 - lightrag - INFO - Local query uses 60 entites, 97 relations, 3 text units
2025-01-11 10:27:01,129 - lightrag - INFO - Global query uses 12 entites, 43 relations, 5 text units
2025-01-11 10:27:13,745 - lightrag - INFO - kw_prompt result:
2025-01-11 10:27:13,745 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:27:14,432 - lightrag - INFO - Local query uses 60 entites, 54 relations, 7 text units
2025-01-11 10:27:15,144 - lightrag - INFO - Global query uses 18 entites, 60 relations, 3 text units
2025-01-11 10:27:54,060 - lightrag - INFO - kw_prompt result:
2025-01-11 10:27:54,060 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 10:28:02,176 - lightrag - INFO - kw_prompt result:
2025-01-11 10:28:02,176 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:28:02,892 - lightrag - INFO - Local query uses 60 entites, 52 relations, 3 text units
2025-01-11 10:28:03,825 - lightrag - INFO - Global query uses 21 entites, 60 relations, 3 text units
2025-01-11 10:28:53,414 - lightrag - INFO - kw_prompt result:
2025-01-11 10:28:53,414 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:28:54,057 - lightrag - INFO - Local query uses 60 entites, 82 relations, 4 text units
2025-01-11 10:28:54,916 - lightrag - INFO - Global query uses 14 entites, 60 relations, 3 text units
2025-01-11 10:30:14,527 - lightrag - INFO - kw_prompt result:
2025-01-11 10:30:14,527 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-11 10:30:14,689 - lightrag - INFO - kw_prompt result:
2025-01-11 10:30:14,689 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:30:15,753 - lightrag - INFO - Local query uses 60 entites, 62 relations, 3 text units
2025-01-11 10:30:16,493 - lightrag - INFO - Global query uses 11 entites, 60 relations, 3 text units
2025-01-11 10:30:56,234 - lightrag - INFO - kw_prompt result:
2025-01-11 10:30:56,234 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:30:57,047 - lightrag - INFO - Local query uses 60 entites, 17 relations, 3 text units
2025-01-11 10:30:57,834 - lightrag - INFO - Global query uses 41 entites, 60 relations, 4 text units
2025-01-11 10:34:09,881 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-11 10:34:09,942 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-11 10:34:09,947 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-11 10:34:09,952 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-11 10:34:09,986 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-11 10:34:10,065 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-11 10:34:39,784 - lightrag - INFO - kw_prompt result:
2025-01-11 10:34:39,785 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:34:40,803 - lightrag - INFO - Local query uses 100 entites, 113 relations, 5 text units
2025-01-11 10:34:41,525 - lightrag - INFO - Global query uses 54 entites, 100 relations, 6 text units
2025-01-11 10:35:10,814 - lightrag - INFO - kw_prompt result:
2025-01-11 10:35:10,814 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:35:11,627 - lightrag - INFO - Local query uses 100 entites, 144 relations, 5 text units
2025-01-11 10:35:12,344 - lightrag - INFO - Global query uses 34 entites, 100 relations, 6 text units
2025-01-11 10:38:35,360 - lightrag - INFO - kw_prompt result:
2025-01-11 10:38:35,360 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:38:36,097 - lightrag - INFO - Local query uses 100 entites, 92 relations, 5 text units
2025-01-11 10:38:36,871 - lightrag - INFO - Global query uses 26 entites, 100 relations, 6 text units
2025-01-11 10:39:39,302 - lightrag - INFO - kw_prompt result:
2025-01-11 10:39:39,302 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:39:39,874 - lightrag - INFO - Local query uses 100 entites, 36 relations, 5 text units
2025-01-11 10:39:40,500 - lightrag - INFO - Global query uses 15 entites, 100 relations, 10 text units
2025-01-11 10:41:30,035 - lightrag - INFO - kw_prompt result:
2025-01-11 10:41:30,035 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:41:31,203 - lightrag - INFO - Local query uses 100 entites, 57 relations, 5 text units
2025-01-11 10:41:31,787 - lightrag - INFO - Global query uses 33 entites, 100 relations, 6 text units
2025-01-11 10:45:11,471 - lightrag - INFO - kw_prompt result:
2025-01-11 10:45:11,471 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:45:12,143 - lightrag - INFO - Local query uses 100 entites, 123 relations, 5 text units
2025-01-11 10:45:12,846 - lightrag - INFO - Global query uses 24 entites, 100 relations, 6 text units
2025-01-11 10:49:13,462 - lightrag - INFO - kw_prompt result:
2025-01-11 10:49:13,463 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:49:14,276 - lightrag - INFO - Local query uses 100 entites, 25 relations, 5 text units
2025-01-11 10:49:14,857 - lightrag - INFO - Global query uses 30 entites, 100 relations, 5 text units
2025-01-11 10:49:16,027 - lightrag - INFO - kw_prompt result:
2025-01-11 10:49:16,027 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:49:16,821 - lightrag - INFO - Local query uses 100 entites, 156 relations, 5 text units
2025-01-11 10:49:17,689 - lightrag - INFO - Global query uses 37 entites, 100 relations, 5 text units
2025-01-11 10:50:06,022 - lightrag - INFO - kw_prompt result:
2025-01-11 10:50:06,022 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:50:06,725 - lightrag - INFO - Local query uses 100 entites, 25 relations, 5 text units
2025-01-11 10:50:07,487 - lightrag - INFO - Global query uses 36 entites, 100 relations, 5 text units
2025-01-11 10:51:08,762 - lightrag - INFO - kw_prompt result:
2025-01-11 10:51:08,762 - lightrag - INFO - Using hybrid mode for query processing
2025-01-11 10:51:09,951 - lightrag - INFO - Local query uses 2 entites, 6 relations, 2 text units
2025-01-11 10:51:10,664 - lightrag - INFO - Global query uses 32 entites, 33 relations, 6 text units
2025-01-11 10:56:13,268 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 10:56:13,297 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-11 10:56:13,299 - lightrag - INFO - Load KV full_docs with 36 data
2025-01-11 10:56:13,301 - lightrag - INFO - Load KV text_chunks with 94 data
2025-01-11 10:56:13,327 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1089 nodes, 797 edges
2025-01-11 10:56:13,354 - lightrag - INFO - Loaded document status storage with 55 records
2025-01-11 10:56:13,355 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 10:56:13,356 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 10:56:13,356 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 10:56:13,357 - lightrag - INFO - Processing 4 new unique documents
2025-01-11 10:56:13,614 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 10:59:39,452 - lightrag - ERROR - Failed to process document doc-bd91c0dc5fcf2042b0220440a4a7def1: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 420, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 468, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 403, in _process_single_content
    glean_result = await _user_llm_func_with_cache(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 374, in _user_llm_func_with_cache
    res: str = await use_llm_func(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-11 10:59:39,539 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:39,575 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 10:59:39,596 - lightrag - ERROR - Failed to process document doc-0e905ef847809fb5b528423bf17638ac: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:39,675 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:39,704 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 10:59:39,725 - lightrag - ERROR - Failed to process document doc-3390abcaab347a4dd0b7cb472f33f76b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:39,803 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:39,833 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 10:59:39,854 - lightrag - ERROR - Failed to process document doc-b28697989f3a7833a344098c194f725a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:39,932 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:39,959 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 10:59:39,963 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 10:59:39,983 - lightrag - ERROR - Failed to process document doc-3f7e228aed24913e1af96e7e84388a27: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:40,059 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:40,089 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 10:59:40,110 - lightrag - ERROR - Failed to process document doc-5576bf4fbb2c96bf9e51bc0d936ccb7a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:40,187 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:40,217 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 10:59:40,238 - lightrag - ERROR - Failed to process document doc-35d53738f9b1688b8aa450fd32289bfc: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:40,315 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:40,346 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 10:59:40,368 - lightrag - ERROR - Failed to process document doc-ed9c26e91fe18f205148db036a271784: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:40,445 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:40,475 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 10:59:40,495 - lightrag - ERROR - Failed to process document doc-560032e91c0a85545e20af1d653e18aa: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:40,572 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:40,601 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 10:59:40,622 - lightrag - ERROR - Failed to process document doc-71a358cae0b97516f05dd813241769f0: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:40,706 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:40,745 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 10:59:40,766 - lightrag - ERROR - Failed to process document doc-620a337c6ee01c5cbdaf6b8fe0404281: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:40,855 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:40,885 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 10:59:40,912 - lightrag - ERROR - Failed to process document doc-429e2a324d28eeb96967210982181a2f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:40,991 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:41,020 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 10:59:41,041 - lightrag - ERROR - Failed to process document doc-5c0c296871b8ec5b9ced4b30b651ff1a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:41,119 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:41,149 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 10:59:41,170 - lightrag - ERROR - Failed to process document doc-cba2596113ddacaa49e5bb3de7e91c5f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:41,247 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:41,275 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 10:59:41,279 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 10:59:41,299 - lightrag - ERROR - Failed to process document doc-87127428145ace50328845dbdfd192da: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:41,377 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:41,406 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 10:59:41,426 - lightrag - ERROR - Failed to process document doc-bbe49c1a98b832f78423fdcc225d27df: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:41,505 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:41,536 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 10:59:41,556 - lightrag - ERROR - Failed to process document doc-cb0e7bf014e2f0e0d13508a2dcf078e1: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 10:59:41,634 - lightrag - INFO - Writing graph with 1089 nodes, 797 edges
2025-01-11 10:59:41,664 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,358 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 11:01:02,358 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 11:01:02,358 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 11:01:02,359 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 11:01:02,359 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 11:01:02,360 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 11:01:02,618 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,641 - lightrag - ERROR - Failed to process document doc-e3b24795f25f25b4620e5152c1b11a92: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,642 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,650 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,671 - lightrag - ERROR - Failed to process document doc-9b63951d2857bac5c941251c1ce82ac4: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,673 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,675 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,695 - lightrag - ERROR - Failed to process document doc-23faf40d619a65d83f06434f1020effb: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,696 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,698 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 11:01:02,718 - lightrag - ERROR - Failed to process document doc-5113f76f33578b6e887605819b6dbf3d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,720 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,722 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,742 - lightrag - ERROR - Failed to process document doc-8c6f392f2628afb84ebbc5012516b472: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,743 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,745 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,765 - lightrag - ERROR - Failed to process document doc-89ca1d0b48c4c733275e39f4856c8cd4: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,767 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,769 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,789 - lightrag - ERROR - Failed to process document doc-508e0902aba29322e30f3bc1f9d351a1: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,791 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,793 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,814 - lightrag - ERROR - Failed to process document doc-608b9f2cba02e1ad1b55e2c7fb897afb: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,815 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,818 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 11:01:02,838 - lightrag - ERROR - Failed to process document doc-b74307e8e8b40931509bd7b72e08662b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,840 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,843 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 11:01:02,864 - lightrag - ERROR - Failed to process document doc-042d43ec75838af6c5f8a83a81e2f75d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,866 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,867 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 11:01:02,869 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,890 - lightrag - ERROR - Failed to process document doc-3c8583eeade57f798ff223565c3957eb: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,891 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,893 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,914 - lightrag - ERROR - Failed to process document doc-05135db5bdf79f8e990c0d5cd95618cc: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,916 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,918 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,938 - lightrag - ERROR - Failed to process document doc-66c217b3de2c4fbe60d806a759552c27: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,939 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,941 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,962 - lightrag - ERROR - Failed to process document doc-92457b7c9a2d6366657189a813313ab8: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,963 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,965 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:02,986 - lightrag - ERROR - Failed to process document doc-58831d54567176531655d47bec85787e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:02,988 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:02,990 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:01:03,010 - lightrag - ERROR - Failed to process document doc-0983084c8f89517c55e17dc222e452a0: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 11:01:03,012 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 11:01:03,016 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 11:01:25,693 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 11:01:25,693 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 11:01:25,693 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 11:01:25,693 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 11:01:25,694 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 11:01:25,695 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 11:01:25,958 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:02:01,458 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:02:01,459 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:02:01,461 - lightrag - INFO - Inserting 17 vectors to entities
2025-01-11 11:02:01,615 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-11 11:02:01,817 - lightrag - INFO - Writing graph with 39 nodes, 25 edges
2025-01-11 11:02:01,826 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:02:35,018 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:02:35,023 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:02:35,024 - lightrag - INFO - Inserting 25 vectors to entities
2025-01-11 11:02:35,249 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-11 11:02:35,422 - lightrag - INFO - Writing graph with 65 nodes, 45 edges
2025-01-11 11:02:35,427 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 11:03:34,526 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:03:34,528 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:03:34,529 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-11 11:03:34,790 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-11 11:03:34,965 - lightrag - INFO - Writing graph with 109 nodes, 65 edges
2025-01-11 11:03:34,971 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:04:17,486 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:04:17,488 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:04:17,489 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-11 11:04:17,714 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-11 11:04:17,925 - lightrag - INFO - Writing graph with 130 nodes, 90 edges
2025-01-11 11:04:17,930 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:05:03,740 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:05:03,741 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:05:03,743 - lightrag - INFO - Inserting 15 vectors to entities
2025-01-11 11:05:03,882 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-11 11:05:04,075 - lightrag - INFO - Writing graph with 142 nodes, 110 edges
2025-01-11 11:05:04,082 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 11:05:44,622 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:05:44,624 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:05:44,626 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-11 11:05:44,890 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 11:05:45,016 - lightrag - INFO - Writing graph with 153 nodes, 121 edges
2025-01-11 11:05:45,022 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 11:06:27,064 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:06:27,068 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:06:27,070 - lightrag - INFO - Inserting 26 vectors to entities
2025-01-11 11:06:27,296 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 11:06:27,456 - lightrag - INFO - Writing graph with 169 nodes, 136 edges
2025-01-11 11:06:27,462 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:07:13,857 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:07:13,861 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:07:13,862 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-11 11:07:14,108 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 11:07:14,300 - lightrag - INFO - Writing graph with 182 nodes, 158 edges
2025-01-11 11:07:14,307 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:08:28,720 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:08:28,723 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:08:28,724 - lightrag - INFO - Inserting 20 vectors to entities
2025-01-11 11:08:29,065 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 11:08:29,371 - lightrag - INFO - Writing graph with 201 nodes, 177 edges
2025-01-11 11:08:29,379 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:09:29,205 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:09:29,208 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:09:29,209 - lightrag - INFO - Inserting 21 vectors to entities
2025-01-11 11:09:29,574 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-11 11:09:29,763 - lightrag - INFO - Writing graph with 224 nodes, 186 edges
2025-01-11 11:09:29,770 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 11:09:29,773 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:11:08,404 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:11:08,414 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:11:08,415 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-11 11:11:08,753 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 11:11:08,931 - lightrag - INFO - Writing graph with 252 nodes, 201 edges
2025-01-11 11:11:08,940 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:12:14,524 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:12:14,526 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:12:14,527 - lightrag - INFO - Inserting 13 vectors to entities
2025-01-11 11:12:14,652 - lightrag - INFO - Inserting 6 vectors to relationships
2025-01-11 11:12:14,744 - lightrag - INFO - Writing graph with 262 nodes, 207 edges
2025-01-11 11:12:14,753 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:13:14,295 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:13:14,304 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:13:14,305 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-11 11:13:14,634 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-11 11:13:14,872 - lightrag - INFO - Writing graph with 298 nodes, 230 edges
2025-01-11 11:13:14,882 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:14:15,099 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:14:15,102 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:14:15,103 - lightrag - INFO - Inserting 17 vectors to entities
2025-01-11 11:14:15,272 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-11 11:14:15,423 - lightrag - INFO - Writing graph with 311 nodes, 242 edges
2025-01-11 11:14:15,437 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 11:15:45,089 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:15:45,092 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:15:45,094 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 11:15:45,419 - lightrag - INFO - Inserting 35 vectors to relationships
2025-01-11 11:15:45,758 - lightrag - INFO - Writing graph with 361 nodes, 277 edges
2025-01-11 11:15:45,775 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 11:19:34,155 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:19:34,163 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:19:34,165 - lightrag - INFO - Inserting 96 vectors to entities
2025-01-11 11:19:35,009 - lightrag - INFO - Inserting 42 vectors to relationships
2025-01-11 11:19:35,384 - lightrag - INFO - Writing graph with 476 nodes, 319 edges
2025-01-11 11:19:35,398 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:20:52,275 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:20:52,280 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:20:52,281 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 11:20:52,619 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-11 11:20:52,828 - lightrag - INFO - Writing graph with 498 nodes, 335 edges
2025-01-11 11:20:52,842 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:21:59,611 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:21:59,615 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:21:59,616 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 11:21:59,968 - lightrag - INFO - Inserting 6 vectors to relationships
2025-01-11 11:22:00,072 - lightrag - INFO - Writing graph with 531 nodes, 341 edges
2025-01-11 11:22:00,087 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 11:24:28,482 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:24:28,488 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:24:28,489 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-11 11:24:28,887 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-11 11:24:29,094 - lightrag - INFO - Writing graph with 559 nodes, 359 edges
2025-01-11 11:24:29,110 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 11:25:32,069 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:25:32,072 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:25:32,080 - lightrag - INFO - Inserting 20 vectors to entities
2025-01-11 11:25:32,275 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-11 11:25:32,597 - lightrag - INFO - Writing graph with 594 nodes, 392 edges
2025-01-11 11:25:32,612 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 11:25:32,614 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 11:26:29,117 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:26:29,121 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:26:29,122 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-11 11:26:29,401 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-11 11:26:29,542 - lightrag - INFO - Writing graph with 619 nodes, 403 edges
2025-01-11 11:26:29,560 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 11:27:33,309 - lightrag - INFO - Inserting entities into storage...
2025-01-11 11:27:33,313 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 11:27:33,314 - lightrag - INFO - Inserting 24 vectors to entities
2025-01-11 11:27:33,563 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 14:08:27,500 - lightrag - INFO - Writing graph with 627 nodes, 416 edges
2025-01-11 14:08:27,520 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 14:09:46,695 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:09:48,328 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:09:48,331 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 14:09:48,702 - lightrag - INFO - Inserting 43 vectors to relationships
2025-01-11 14:09:49,103 - lightrag - INFO - Writing graph with 665 nodes, 446 edges
2025-01-11 14:09:49,123 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:10:44,919 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:10:44,924 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:10:44,925 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-11 14:10:45,254 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-11 14:10:45,529 - lightrag - INFO - Writing graph with 687 nodes, 474 edges
2025-01-11 14:10:45,549 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:11:56,485 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:11:56,498 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:11:56,499 - lightrag - INFO - Inserting 44 vectors to entities
2025-01-11 14:11:56,923 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-11 14:11:57,130 - lightrag - INFO - Writing graph with 716 nodes, 487 edges
2025-01-11 14:11:57,149 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:12:47,701 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:12:50,227 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:12:50,229 - lightrag - INFO - Inserting 50 vectors to entities
2025-01-11 14:12:50,681 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-11 14:12:50,928 - lightrag - INFO - Writing graph with 752 nodes, 508 edges
2025-01-11 14:12:50,949 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:13:59,736 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:13:59,749 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:13:59,750 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-11 14:14:00,206 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 14:14:00,424 - lightrag - INFO - Writing graph with 769 nodes, 527 edges
2025-01-11 14:14:00,446 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:14:38,923 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:14:41,579 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:14:41,581 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-11 14:14:41,873 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-11 14:14:42,136 - lightrag - INFO - Writing graph with 797 nodes, 550 edges
2025-01-11 14:14:42,157 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:15:22,831 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:15:28,950 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:15:28,951 - lightrag - INFO - Inserting 20 vectors to entities
2025-01-11 14:15:29,191 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-11 14:15:29,359 - lightrag - INFO - Writing graph with 809 nodes, 562 edges
2025-01-11 14:15:29,387 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:16:49,421 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:16:49,434 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:16:49,435 - lightrag - INFO - Inserting 56 vectors to entities
2025-01-11 14:16:49,916 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-11 14:16:50,135 - lightrag - INFO - Writing graph with 842 nodes, 581 edges
2025-01-11 14:16:50,155 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 14:16:50,158 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:17:35,999 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:17:38,135 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:17:38,137 - lightrag - INFO - Inserting 18 vectors to entities
2025-01-11 14:17:38,382 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-11 14:17:38,635 - lightrag - INFO - Writing graph with 861 nodes, 604 edges
2025-01-11 14:17:38,658 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:18:27,130 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:18:33,464 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:18:33,466 - lightrag - INFO - Inserting 18 vectors to entities
2025-01-11 14:18:33,703 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-11 14:18:34,045 - lightrag - INFO - Writing graph with 874 nodes, 626 edges
2025-01-11 14:18:34,071 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:19:35,227 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:19:35,230 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:19:35,231 - lightrag - INFO - Inserting 15 vectors to entities
2025-01-11 14:19:35,383 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-11 14:19:35,703 - lightrag - INFO - Writing graph with 894 nodes, 656 edges
2025-01-11 14:19:35,728 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:20:17,268 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:20:17,273 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:20:17,274 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-11 14:20:17,536 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 14:20:17,792 - lightrag - INFO - Writing graph with 909 nodes, 677 edges
2025-01-11 14:20:17,818 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:20:58,753 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:21:11,779 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:21:11,781 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-11 14:21:12,129 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-11 14:21:12,320 - lightrag - INFO - Writing graph with 925 nodes, 689 edges
2025-01-11 14:21:12,346 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:21:58,186 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:21:58,189 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:21:58,196 - lightrag - INFO - Inserting 20 vectors to entities
2025-01-11 14:21:58,379 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-11 14:21:58,632 - lightrag - INFO - Writing graph with 946 nodes, 714 edges
2025-01-11 14:21:58,657 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:22:43,390 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:22:43,392 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:22:43,393 - lightrag - INFO - Inserting 11 vectors to entities
2025-01-11 14:22:43,506 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 14:22:43,731 - lightrag - INFO - Writing graph with 959 nodes, 731 edges
2025-01-11 14:22:43,758 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:23:54,553 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:24:08,487 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:24:08,489 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-11 14:24:08,971 - lightrag - INFO - Inserting 37 vectors to relationships
2025-01-11 14:24:09,332 - lightrag - INFO - Writing graph with 986 nodes, 764 edges
2025-01-11 14:24:09,362 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 14:42:44,523 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:42:47,871 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:42:47,873 - lightrag - INFO - Inserting 50 vectors to entities
2025-01-11 14:42:49,574 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-11 14:42:49,813 - lightrag - INFO - Writing graph with 1043 nodes, 784 edges
2025-01-11 14:42:49,844 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 14:45:44,935 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:45:44,948 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:45:44,950 - lightrag - INFO - Inserting 89 vectors to entities
2025-01-11 14:45:45,651 - lightrag - INFO - Inserting 66 vectors to relationships
2025-01-11 14:45:46,255 - lightrag - INFO - Writing graph with 1126 nodes, 849 edges
2025-01-11 14:45:46,283 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 14:45:46,286 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:47:42,777 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:47:47,489 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:47:47,491 - lightrag - INFO - Inserting 24 vectors to entities
2025-01-11 14:47:47,727 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-11 14:47:47,972 - lightrag - INFO - Writing graph with 1150 nodes, 867 edges
2025-01-11 14:47:48,013 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:50:30,966 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:50:42,841 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:50:42,843 - lightrag - INFO - Inserting 61 vectors to entities
2025-01-11 14:50:43,389 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-11 14:50:43,718 - lightrag - INFO - Writing graph with 1223 nodes, 897 edges
2025-01-11 14:50:43,751 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:52:23,068 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:52:26,805 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:52:26,806 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-11 14:52:27,222 - lightrag - INFO - Inserting 37 vectors to relationships
2025-01-11 14:52:27,594 - lightrag - INFO - Writing graph with 1264 nodes, 934 edges
2025-01-11 14:52:27,628 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:54:08,071 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:54:08,074 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:54:08,076 - lightrag - INFO - Inserting 12 vectors to entities
2025-01-11 14:54:08,234 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-11 14:54:08,516 - lightrag - INFO - Writing graph with 1279 nodes, 946 edges
2025-01-11 14:54:08,550 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:54:53,694 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:55:03,627 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:55:03,628 - lightrag - INFO - Inserting 18 vectors to entities
2025-01-11 14:55:03,907 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-11 14:55:04,086 - lightrag - INFO - Writing graph with 1281 nodes, 949 edges
2025-01-11 14:55:04,122 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:56:27,786 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:56:30,586 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:56:30,588 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-11 14:56:30,847 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-11 14:56:31,171 - lightrag - INFO - Writing graph with 1297 nodes, 976 edges
2025-01-11 14:56:31,205 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 14:57:42,658 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:57:45,730 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:57:45,731 - lightrag - INFO - Inserting 10 vectors to entities
2025-01-11 14:57:45,846 - lightrag - INFO - Inserting 6 vectors to relationships
2025-01-11 14:57:46,027 - lightrag - INFO - Writing graph with 1302 nodes, 982 edges
2025-01-11 14:57:46,065 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 14:59:54,386 - lightrag - INFO - Inserting entities into storage...
2025-01-11 14:59:54,390 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 14:59:54,391 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-11 14:59:54,643 - lightrag - INFO - Inserting 3 vectors to relationships
2025-01-11 14:59:54,810 - lightrag - INFO - Writing graph with 1317 nodes, 983 edges
2025-01-11 14:59:54,845 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 15:01:07,155 - lightrag - INFO - Inserting entities into storage...
2025-01-11 15:01:12,505 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 15:01:12,506 - lightrag - INFO - Inserting 23 vectors to entities
2025-01-11 15:01:12,785 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-11 15:01:12,983 - lightrag - INFO - Writing graph with 1326 nodes, 994 edges
2025-01-11 15:01:13,019 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 15:18:18,322 - lightrag - INFO - Inserting entities into storage...
2025-01-11 15:18:18,325 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 15:18:18,326 - lightrag - INFO - Inserting 16 vectors to entities
2025-01-11 15:18:19,843 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-11 15:18:20,064 - lightrag - INFO - Writing graph with 1334 nodes, 1004 edges
2025-01-11 15:18:20,097 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 15:18:20,101 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 16:52:57,168 - lightrag - INFO - Inserting entities into storage...
2025-01-11 16:52:57,170 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 16:52:57,171 - lightrag - INFO - Inserting 8 vectors to entities
2025-01-11 16:52:58,576 - lightrag - INFO - Inserting 1 vectors to relationships
2025-01-11 16:52:58,725 - lightrag - INFO - Writing graph with 1339 nodes, 1005 edges
2025-01-11 16:52:58,764 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 17:18:15,260 - lightrag - INFO - Inserting entities into storage...
2025-01-11 17:18:15,260 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 17:18:15,260 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 17:18:15,261 - lightrag - ERROR - Failed to process document doc-e4a41fee7b5d2c1517671d35a91b4595: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 17:18:15,379 - lightrag - INFO - Writing graph with 1339 nodes, 1005 edges
2025-01-11 17:18:15,415 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 17:23:30,090 - lightrag - INFO - Inserting entities into storage...
2025-01-11 17:23:30,090 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 17:23:30,091 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 17:23:30,092 - lightrag - ERROR - Failed to process document doc-29e882970b77c2b5f3587d6a440e113a: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 17:23:30,210 - lightrag - INFO - Writing graph with 1339 nodes, 1005 edges
2025-01-11 17:23:30,246 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 17:31:16,553 - lightrag - INFO - Inserting entities into storage...
2025-01-11 17:31:16,553 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 17:31:16,553 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 17:31:16,554 - lightrag - ERROR - Failed to process document doc-bbe49c1a98b832f78423fdcc225d27df: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 17:31:16,674 - lightrag - INFO - Writing graph with 1339 nodes, 1005 edges
2025-01-11 17:31:16,711 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 17:42:42,544 - lightrag - INFO - Inserting entities into storage...
2025-01-11 17:42:42,544 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 17:42:42,544 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 17:42:42,545 - lightrag - ERROR - Failed to process document doc-f40612befb46f99c08d9dea3fdbe2f9d: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 17:42:42,667 - lightrag - INFO - Writing graph with 1339 nodes, 1005 edges
2025-01-11 17:42:42,703 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 17:54:02,379 - lightrag - INFO - Inserting entities into storage...
2025-01-11 17:54:02,380 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 17:54:02,380 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 17:54:02,381 - lightrag - ERROR - Failed to process document doc-922870cd62c3753b460c9c230971e02c: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 17:54:02,504 - lightrag - INFO - Writing graph with 1339 nodes, 1005 edges
2025-01-11 17:54:02,540 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 18:09:12,371 - lightrag - INFO - Inserting entities into storage...
2025-01-11 18:09:12,371 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 18:09:12,371 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 18:09:12,372 - lightrag - ERROR - Failed to process document doc-62099bb1d2b66eb60b9517839f1f433e: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 18:09:12,506 - lightrag - INFO - Writing graph with 1339 nodes, 1005 edges
2025-01-11 18:09:12,545 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 18:10:37,393 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 18:10:37,507 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-11 18:10:37,508 - lightrag - INFO - Load KV full_docs with 51 data
2025-01-11 18:10:37,510 - lightrag - INFO - Load KV text_chunks with 134 data
2025-01-11 18:10:37,540 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1339 nodes, 1005 edges
2025-01-11 18:10:37,565 - lightrag - INFO - Loaded document status storage with 58 records
2025-01-11 18:10:37,566 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 18:10:37,566 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 18:10:37,567 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 18:10:37,567 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 18:10:37,568 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-11 18:10:37,569 - lightrag - INFO - Processing 9 new unique documents
2025-01-11 18:10:37,803 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 18:13:34,628 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 18:13:34,628 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 18:13:34,629 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 18:13:34,629 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 18:13:34,629 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 18:13:34,630 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 18:13:34,894 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,229 - lightrag - ERROR - Failed to process document doc-608b9f2cba02e1ad1b55e2c7fb897afb: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 420, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 468, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 403, in _process_single_content
    glean_result = await _user_llm_func_with_cache(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 374, in _user_llm_func_with_cache
    res: str = await use_llm_func(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-11 18:14:48,230 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,239 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,260 - lightrag - ERROR - Failed to process document doc-e3b24795f25f25b4620e5152c1b11a92: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,263 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,265 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,285 - lightrag - ERROR - Failed to process document doc-23faf40d619a65d83f06434f1020effb: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,287 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,290 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 18:14:48,310 - lightrag - ERROR - Failed to process document doc-b74307e8e8b40931509bd7b72e08662b: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,312 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,314 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,334 - lightrag - ERROR - Failed to process document doc-9b63951d2857bac5c941251c1ce82ac4: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,336 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,338 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,358 - lightrag - ERROR - Failed to process document doc-8c6f392f2628afb84ebbc5012516b472: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,360 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,363 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,383 - lightrag - ERROR - Failed to process document doc-508e0902aba29322e30f3bc1f9d351a1: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,385 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,388 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 18:14:48,408 - lightrag - ERROR - Failed to process document doc-042d43ec75838af6c5f8a83a81e2f75d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,410 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,413 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 18:14:48,433 - lightrag - ERROR - Failed to process document doc-5113f76f33578b6e887605819b6dbf3d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,435 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,437 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,458 - lightrag - ERROR - Failed to process document doc-89ca1d0b48c4c733275e39f4856c8cd4: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,460 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,461 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 18:14:48,462 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,483 - lightrag - ERROR - Failed to process document doc-58831d54567176531655d47bec85787e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,485 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,489 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 18:14:48,509 - lightrag - ERROR - Failed to process document doc-d7ccad49e8b02ca09d44e7767258fe87: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,511 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,514 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,534 - lightrag - ERROR - Failed to process document doc-92457b7c9a2d6366657189a813313ab8: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,536 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,537 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,557 - lightrag - ERROR - Failed to process document doc-0983084c8f89517c55e17dc222e452a0: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,559 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,562 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:14:48,581 - lightrag - ERROR - Failed to process document doc-05135db5bdf79f8e990c0d5cd95618cc: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,584 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,586 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 18:14:48,607 - lightrag - ERROR - Failed to process document doc-924c92b5dcb353021671bdf1ab0d28ab: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,609 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,612 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 18:14:48,633 - lightrag - ERROR - Failed to process document doc-54cca7594a2d73f10be308fb8fad5966: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 18:14:48,635 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-11 18:14:48,640 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 18:16:34,140 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 18:16:34,140 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 18:16:34,140 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 18:16:34,140 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 18:16:34,141 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 18:16:34,142 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 18:16:34,396 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:17:13,947 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 18:17:13,947 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 18:17:13,947 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 18:17:13,947 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 18:17:13,948 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 18:17:13,949 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 18:17:14,199 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 18:23:54,860 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 18:23:54,860 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 18:23:54,860 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 18:23:54,860 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 18:23:54,861 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-11 18:23:54,862 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 18:23:55,122 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:24:26,176 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-11 18:24:26,176 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-11 18:24:26,177 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-11 18:24:26,177 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-11 18:24:26,177 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-11 18:24:26,178 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 18:24:26,427 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 18:26:17,666 - lightrag - INFO - Inserting entities into storage...
2025-01-11 18:26:17,674 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 18:26:17,676 - lightrag - INFO - Inserting 50 vectors to entities
2025-01-11 18:26:18,090 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-11 18:26:18,386 - lightrag - INFO - Writing graph with 71 nodes, 40 edges
2025-01-11 18:26:18,397 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:27:03,146 - lightrag - INFO - Inserting entities into storage...
2025-01-11 18:27:03,148 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 18:27:03,149 - lightrag - INFO - Inserting 23 vectors to entities
2025-01-11 18:27:03,335 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 18:27:03,473 - lightrag - INFO - Writing graph with 105 nodes, 57 edges
2025-01-11 18:27:03,478 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 18:32:08,239 - lightrag - INFO - Inserting entities into storage...
2025-01-11 18:32:08,241 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 18:32:08,242 - lightrag - INFO - Inserting 26 vectors to entities
2025-01-11 18:32:09,732 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 18:32:09,845 - lightrag - INFO - Writing graph with 134 nodes, 70 edges
2025-01-11 18:32:09,850 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 18:36:46,645 - lightrag - INFO - Inserting entities into storage...
2025-01-11 18:36:46,652 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 18:36:46,654 - lightrag - INFO - Inserting 29 vectors to entities
2025-01-11 18:36:46,882 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-11 18:36:47,092 - lightrag - INFO - Writing graph with 182 nodes, 96 edges
2025-01-11 18:36:47,099 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 18:59:18,570 - lightrag - INFO - Inserting entities into storage...
2025-01-11 18:59:18,572 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 18:59:18,572 - lightrag - INFO - Inserting 18 vectors to entities
2025-01-11 18:59:20,039 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-11 18:59:20,147 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 18:59:20,153 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:01:33,740 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:01:33,740 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:01:33,740 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:01:33,741 - lightrag - ERROR - Failed to process document doc-8c6f392f2628afb84ebbc5012516b472: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:01:33,757 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:01:33,765 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:02:19,505 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:02:19,506 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:02:19,506 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:02:19,507 - lightrag - ERROR - Failed to process document doc-89ca1d0b48c4c733275e39f4856c8cd4: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:02:19,534 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:02:19,545 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:03:08,957 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:03:08,957 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:03:08,958 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:03:08,958 - lightrag - ERROR - Failed to process document doc-608b9f2cba02e1ad1b55e2c7fb897afb: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:03:08,976 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:03:08,982 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:03:51,015 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:03:51,015 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:03:51,015 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:03:51,016 - lightrag - ERROR - Failed to process document doc-23faf40d619a65d83f06434f1020effb: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:03:51,034 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:03:51,041 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:06:07,726 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:06:07,726 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:06:07,726 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:06:07,727 - lightrag - ERROR - Failed to process document doc-508e0902aba29322e30f3bc1f9d351a1: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:06:07,757 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:06:07,766 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 19:06:07,771 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 19:08:50,815 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:08:50,816 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:08:50,816 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:08:50,816 - lightrag - ERROR - Failed to process document doc-54cca7594a2d73f10be308fb8fad5966: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:08:50,837 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:08:50,846 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 19:11:27,268 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:11:27,268 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:11:27,268 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:11:27,269 - lightrag - ERROR - Failed to process document doc-6dc55bac5ee0844efd7b5e1bcbb3810c: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:11:27,297 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:11:27,304 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:12:01,400 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:12:01,400 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:12:01,400 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:12:01,401 - lightrag - ERROR - Failed to process document doc-0983084c8f89517c55e17dc222e452a0: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:12:01,424 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:12:01,433 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 19:14:37,548 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:14:37,549 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:14:37,549 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:14:37,549 - lightrag - ERROR - Failed to process document doc-d7ccad49e8b02ca09d44e7767258fe87: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:14:37,573 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:14:37,580 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:16:11,377 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:16:11,377 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:16:11,377 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:16:11,378 - lightrag - ERROR - Failed to process document doc-58831d54567176531655d47bec85787e: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:16:11,404 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:16:11,412 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:17:20,607 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:17:20,608 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:17:20,608 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:17:20,609 - lightrag - ERROR - Failed to process document doc-3c8583eeade57f798ff223565c3957eb: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:17:20,634 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:17:20,641 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:18:18,437 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:18:18,437 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:18:18,438 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:18:18,438 - lightrag - ERROR - Failed to process document doc-66c217b3de2c4fbe60d806a759552c27: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:18:18,464 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:18:18,471 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:19:01,181 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:19:01,181 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:19:01,181 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:19:01,182 - lightrag - ERROR - Failed to process document doc-05135db5bdf79f8e990c0d5cd95618cc: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:19:01,210 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:19:01,218 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:20:05,012 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:20:05,013 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:20:05,013 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:20:05,014 - lightrag - ERROR - Failed to process document doc-92457b7c9a2d6366657189a813313ab8: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:20:05,041 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:20:05,048 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 19:21:10,807 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:21:10,807 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:21:10,807 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:21:10,808 - lightrag - ERROR - Failed to process document doc-924c92b5dcb353021671bdf1ab0d28ab: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:21:10,843 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:21:10,848 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 19:21:10,852 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 19:22:46,352 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:22:46,353 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:22:46,353 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:22:46,353 - lightrag - ERROR - Failed to process document doc-1220486513f4b4c1cdb02996fd7e9b83: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:22:46,383 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:22:46,391 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 19:25:55,656 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:25:55,656 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:25:55,656 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:25:55,657 - lightrag - ERROR - Failed to process document doc-cf232ad85094b654a1392e31897cb640: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:25:55,687 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:25:55,703 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:26:56,096 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:26:56,096 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:26:56,097 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:26:56,097 - lightrag - ERROR - Failed to process document doc-0465fea8173e1c60d402a28d480216c8: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:26:56,133 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:26:56,144 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:27:49,726 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:27:49,727 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:27:49,727 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:27:49,728 - lightrag - ERROR - Failed to process document doc-744a779e89fff6df607e57d1d1ad64f6: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:27:49,759 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:27:49,765 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:28:37,773 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:28:37,773 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:28:37,774 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:28:37,774 - lightrag - ERROR - Failed to process document doc-db61f9b985aff9038b9e2e4d139d883d: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:28:37,806 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:28:37,813 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 19:31:44,811 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:31:44,811 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:31:44,811 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:31:44,812 - lightrag - ERROR - Failed to process document doc-5f668d0e8882dfc33dfa6ae94ef81b73: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:31:44,845 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:31:44,853 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 19:32:26,637 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:32:26,638 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:32:26,638 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:32:26,639 - lightrag - ERROR - Failed to process document doc-f18b9597926261c74f20e01473bcbf86: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:32:26,673 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:32:26,681 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 19:34:18,366 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:34:18,366 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:34:18,366 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:34:18,367 - lightrag - ERROR - Failed to process document doc-cb5d460df418413cbb3399219c82dfe6: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:34:18,402 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:34:18,410 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 19:35:17,027 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:35:17,027 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:35:17,027 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:35:17,028 - lightrag - ERROR - Failed to process document doc-f18ba8979d52cc20dcc653f8e1e72b72: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:35:17,070 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:35:17,077 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:35:52,810 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:35:52,811 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:35:52,811 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:35:52,812 - lightrag - ERROR - Failed to process document doc-c324c21801b9e891ee9be986693f1504: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:35:52,853 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:35:52,858 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 19:35:52,861 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 19:36:42,174 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:36:42,174 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:36:42,174 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:36:42,175 - lightrag - ERROR - Failed to process document doc-48677cd9f2d8fa25acd62f3b86369b42: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:36:42,211 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:36:42,221 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-11 19:40:57,830 - lightrag - INFO - Inserting entities into storage...
2025-01-11 19:40:57,831 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 19:40:57,831 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-11 19:40:57,832 - lightrag - ERROR - Failed to process document doc-bd91c0dc5fcf2042b0220440a4a7def1: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 430, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-11 19:40:57,871 - lightrag - INFO - Writing graph with 192 nodes, 107 edges
2025-01-11 19:40:57,879 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:44:27,785 - lightrag - INFO - Inserting entities into storage...
2025-01-11 23:44:27,786 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 23:44:27,786 - lightrag - WARNING - Didn't extract any relationships
2025-01-11 23:44:27,786 - lightrag - INFO - Inserting 5 vectors to entities
2025-01-11 23:44:29,114 - lightrag - INFO - Inserting 0 vectors to relationships
2025-01-11 23:44:29,114 - lightrag - WARNING - You insert an empty data to vector DB
2025-01-11 23:44:29,155 - lightrag - INFO - Writing graph with 197 nodes, 107 edges
2025-01-11 23:44:29,165 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 23:45:46,079 - lightrag - INFO - Inserting entities into storage...
2025-01-11 23:45:46,081 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 23:45:46,089 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-11 23:45:46,380 - lightrag - INFO - Inserting 43 vectors to relationships
2025-01-11 23:45:46,746 - lightrag - INFO - Writing graph with 264 nodes, 150 edges
2025-01-11 23:45:46,756 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:46:23,528 - lightrag - INFO - Inserting entities into storage...
2025-01-11 23:46:23,530 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 23:46:23,531 - lightrag - INFO - Inserting 23 vectors to entities
2025-01-11 23:46:23,722 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-11 23:46:23,903 - lightrag - INFO - Writing graph with 288 nodes, 167 edges
2025-01-11 23:46:23,912 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:46:46,062 - lightrag - INFO - Inserting entities into storage...
2025-01-11 23:46:46,063 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 23:46:46,064 - lightrag - INFO - Inserting 16 vectors to entities
2025-01-11 23:46:46,202 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-11 23:46:46,339 - lightrag - INFO - Writing graph with 308 nodes, 178 edges
2025-01-11 23:46:46,349 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:47:12,396 - lightrag - INFO - Inserting entities into storage...
2025-01-11 23:47:12,397 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 23:47:12,399 - lightrag - INFO - Inserting 19 vectors to entities
2025-01-11 23:47:12,551 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-11 23:47:12,743 - lightrag - INFO - Writing graph with 321 nodes, 193 edges
2025-01-11 23:47:12,753 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:47:42,839 - lightrag - INFO - Inserting entities into storage...
2025-01-11 23:47:42,841 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 23:47:42,842 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 23:47:43,146 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-11 23:47:43,332 - lightrag - INFO - Writing graph with 352 nodes, 208 edges
2025-01-11 23:47:43,346 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:48:31,945 - lightrag - INFO - Inserting entities into storage...
2025-01-11 23:48:31,947 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 23:48:31,949 - lightrag - INFO - Inserting 18 vectors to entities
2025-01-11 23:48:32,108 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-11 23:48:32,346 - lightrag - INFO - Writing graph with 383 nodes, 231 edges
2025-01-11 23:48:32,359 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:49:07,386 - lightrag - INFO - Inserting entities into storage...
2025-01-11 23:49:07,389 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 23:49:07,390 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-11 23:49:07,683 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-11 23:49:07,845 - lightrag - INFO - Writing graph with 399 nodes, 244 edges
2025-01-11 23:49:07,855 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 23:49:07,859 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:50:07,081 - lightrag - INFO - Inserting entities into storage...
2025-01-11 23:50:07,084 - lightrag - INFO - Inserting relationships into storage...
2025-01-11 23:50:07,086 - lightrag - INFO - Inserting 26 vectors to entities
2025-01-11 23:50:07,304 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-11 23:50:07,548 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:50:07,562 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:51:17,445 - lightrag - ERROR - Failed to process document doc-ed9c26e91fe18f205148db036a271784: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 420, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 468, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 403, in _process_single_content
    glean_result = await _user_llm_func_with_cache(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/operate.py", line 374, in _user_llm_func_with_cache
    res: str = await use_llm_func(
               ^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-11 23:51:17,517 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:17,533 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:51:17,553 - lightrag - ERROR - Failed to process document doc-cba2596113ddacaa49e5bb3de7e91c5f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:17,609 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:17,622 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:51:17,643 - lightrag - ERROR - Failed to process document doc-3f7e228aed24913e1af96e7e84388a27: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:17,699 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:17,712 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:51:17,733 - lightrag - ERROR - Failed to process document doc-35d53738f9b1688b8aa450fd32289bfc: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:17,788 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:17,801 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:51:17,821 - lightrag - ERROR - Failed to process document doc-560032e91c0a85545e20af1d653e18aa: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:17,875 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:17,888 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:51:17,908 - lightrag - ERROR - Failed to process document doc-5c0c296871b8ec5b9ced4b30b651ff1a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:17,968 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:17,981 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:51:18,001 - lightrag - ERROR - Failed to process document doc-71a358cae0b97516f05dd813241769f0: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,062 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,077 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:51:18,098 - lightrag - ERROR - Failed to process document doc-5576bf4fbb2c96bf9e51bc0d936ccb7a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,154 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,167 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:51:18,187 - lightrag - ERROR - Failed to process document doc-429e2a324d28eeb96967210982181a2f: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,242 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,253 - lightrag - INFO - Processing 10 new unique documents
2025-01-11 23:51:18,256 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:51:18,289 - lightrag - ERROR - Failed to process document doc-62099bb1d2b66eb60b9517839f1f433e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,359 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,374 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 23:51:18,394 - lightrag - ERROR - Failed to process document doc-e4a41fee7b5d2c1517671d35a91b4595: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,450 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,463 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:51:18,484 - lightrag - ERROR - Failed to process document doc-bbe49c1a98b832f78423fdcc225d27df: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,540 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,555 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 23:51:18,576 - lightrag - ERROR - Failed to process document doc-cb0e7bf014e2f0e0d13508a2dcf078e1: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,631 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,645 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:51:18,665 - lightrag - ERROR - Failed to process document doc-87127428145ace50328845dbdfd192da: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,721 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,735 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-11 23:51:18,760 - lightrag - ERROR - Failed to process document doc-f40612befb46f99c08d9dea3fdbe2f9d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,816 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,831 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-11 23:51:18,852 - lightrag - ERROR - Failed to process document doc-0a28dbd7411796e485954621fef1de0c: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:18,909 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:18,922 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-11 23:51:18,943 - lightrag - ERROR - Failed to process document doc-29e882970b77c2b5f3587d6a440e113a: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-11 23:51:19,000 - lightrag - INFO - Writing graph with 433 nodes, 268 edges
2025-01-11 23:51:19,016 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 00:13:37,295 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 00:13:37,295 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 00:13:37,295 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 00:13:37,295 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 00:13:37,296 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 00:13:37,297 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 00:13:37,557 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:14:39,159 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:14:39,160 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:14:39,161 - lightrag - INFO - Inserting 15 vectors to entities
2025-01-12 00:14:39,296 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-12 00:14:39,350 - lightrag - INFO - Writing graph with 18 nodes, 5 edges
2025-01-12 00:14:39,359 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:15:38,482 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:15:38,483 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:15:38,484 - lightrag - INFO - Inserting 13 vectors to entities
2025-01-12 00:15:38,595 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 00:15:38,687 - lightrag - INFO - Writing graph with 34 nodes, 16 edges
2025-01-12 00:15:38,690 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:16:23,711 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:16:23,713 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:16:23,714 - lightrag - INFO - Inserting 23 vectors to entities
2025-01-12 00:16:23,905 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 00:16:24,023 - lightrag - INFO - Writing graph with 49 nodes, 30 edges
2025-01-12 00:16:24,026 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:17:03,730 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:17:03,732 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:17:03,733 - lightrag - INFO - Inserting 23 vectors to entities
2025-01-12 00:17:03,917 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 00:17:04,022 - lightrag - INFO - Writing graph with 60 nodes, 39 edges
2025-01-12 00:17:04,026 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:18:06,422 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:18:06,425 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:18:06,426 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 00:18:12,648 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 00:18:12,773 - lightrag - INFO - Writing graph with 84 nodes, 52 edges
2025-01-12 00:18:12,778 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 00:20:08,931 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:20:08,934 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:20:08,936 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-12 00:20:09,190 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-12 00:20:09,359 - lightrag - INFO - Writing graph with 101 nodes, 71 edges
2025-01-12 00:20:09,364 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 00:22:38,181 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:22:38,182 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:22:38,183 - lightrag - INFO - Inserting 18 vectors to entities
2025-01-12 00:22:38,336 - lightrag - INFO - Inserting 4 vectors to relationships
2025-01-12 00:22:38,397 - lightrag - INFO - Writing graph with 109 nodes, 74 edges
2025-01-12 00:22:38,404 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 00:25:26,476 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:25:26,480 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:25:26,481 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-12 00:25:26,771 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-12 00:25:27,002 - lightrag - INFO - Writing graph with 123 nodes, 101 edges
2025-01-12 00:25:27,007 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:26:37,899 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:26:37,902 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:26:37,902 - lightrag - INFO - Inserting 24 vectors to entities
2025-01-12 00:26:38,120 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 00:26:38,215 - lightrag - INFO - Writing graph with 134 nodes, 108 edges
2025-01-12 00:26:38,221 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:27:47,011 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:27:47,014 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:27:47,015 - lightrag - INFO - Inserting 26 vectors to entities
2025-01-12 00:27:47,236 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 00:27:47,358 - lightrag - INFO - Writing graph with 143 nodes, 119 edges
2025-01-12 00:27:47,363 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 00:27:47,366 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:29:02,174 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:29:02,178 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:29:02,179 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-12 00:29:02,415 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 00:29:02,549 - lightrag - INFO - Writing graph with 149 nodes, 127 edges
2025-01-12 00:29:02,558 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-12 00:33:37,366 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:33:37,376 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:33:37,377 - lightrag - INFO - Inserting 72 vectors to entities
2025-01-12 00:33:37,953 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 00:33:38,087 - lightrag - INFO - Writing graph with 196 nodes, 139 edges
2025-01-12 00:33:38,094 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:34:40,700 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:34:40,705 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:34:40,707 - lightrag - INFO - Inserting 22 vectors to entities
2025-01-12 00:34:40,948 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 00:34:41,084 - lightrag - INFO - Writing graph with 202 nodes, 148 edges
2025-01-12 00:34:41,092 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:35:56,610 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:35:56,615 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:35:56,616 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-12 00:35:56,907 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 00:35:57,056 - lightrag - INFO - Writing graph with 210 nodes, 157 edges
2025-01-12 00:35:57,064 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:37:10,593 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:37:10,594 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:37:10,595 - lightrag - INFO - Inserting 8 vectors to entities
2025-01-12 00:37:10,689 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-12 00:37:10,771 - lightrag - INFO - Writing graph with 214 nodes, 161 edges
2025-01-12 00:37:10,779 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:38:28,464 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:38:28,465 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:38:28,466 - lightrag - INFO - Inserting 9 vectors to entities
2025-01-12 00:38:28,558 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-12 00:38:28,661 - lightrag - INFO - Writing graph with 217 nodes, 168 edges
2025-01-12 00:38:28,669 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:39:55,128 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:39:55,135 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:39:55,136 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 00:39:55,506 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 00:39:55,656 - lightrag - INFO - Writing graph with 224 nodes, 178 edges
2025-01-12 00:39:55,666 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 00:42:47,645 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:42:47,656 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:42:47,658 - lightrag - INFO - Inserting 44 vectors to entities
2025-01-12 00:42:48,032 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-12 00:42:48,247 - lightrag - INFO - Writing graph with 244 nodes, 197 edges
2025-01-12 00:42:48,257 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 00:45:46,542 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:45:56,477 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:45:56,478 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-12 00:45:56,938 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-12 00:45:57,154 - lightrag - INFO - Writing graph with 279 nodes, 222 edges
2025-01-12 00:45:57,166 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 00:48:49,451 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:48:55,949 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:48:55,951 - lightrag - INFO - Inserting 43 vectors to entities
2025-01-12 00:48:56,338 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-12 00:48:56,520 - lightrag - INFO - Writing graph with 302 nodes, 237 edges
2025-01-12 00:48:56,530 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 00:48:56,533 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 00:51:13,071 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:51:13,074 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:51:13,075 - lightrag - INFO - Inserting 25 vectors to entities
2025-01-12 00:51:13,305 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 00:51:13,445 - lightrag - INFO - Writing graph with 319 nodes, 250 edges
2025-01-12 00:51:13,457 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 00:53:41,171 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:53:41,174 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:53:41,175 - lightrag - INFO - Inserting 29 vectors to entities
2025-01-12 00:53:41,408 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 00:53:41,549 - lightrag - INFO - Writing graph with 335 nodes, 260 edges
2025-01-12 00:53:41,560 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:55:32,716 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:55:32,718 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:55:32,719 - lightrag - INFO - Inserting 13 vectors to entities
2025-01-12 00:55:32,854 - lightrag - INFO - Inserting 6 vectors to relationships
2025-01-12 00:55:32,951 - lightrag - INFO - Writing graph with 339 nodes, 265 edges
2025-01-12 00:55:32,962 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 00:57:17,572 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:57:17,580 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:57:17,581 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-12 00:57:18,007 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 00:57:18,156 - lightrag - INFO - Writing graph with 356 nodes, 274 edges
2025-01-12 00:57:18,169 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 00:58:55,169 - lightrag - INFO - Inserting entities into storage...
2025-01-12 00:59:03,092 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 00:59:03,094 - lightrag - INFO - Inserting 29 vectors to entities
2025-01-12 00:59:03,397 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 00:59:03,536 - lightrag - INFO - Writing graph with 359 nodes, 278 edges
2025-01-12 00:59:03,549 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 01:02:59,122 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:03:03,440 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:03:03,442 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-12 01:03:03,890 - lightrag - INFO - Inserting 39 vectors to relationships
2025-01-12 01:03:04,265 - lightrag - INFO - Writing graph with 387 nodes, 311 edges
2025-01-12 01:03:04,279 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 01:06:11,516 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:06:11,518 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:06:11,519 - lightrag - INFO - Inserting 14 vectors to entities
2025-01-12 01:06:11,654 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 01:06:11,793 - lightrag - INFO - Writing graph with 391 nodes, 322 edges
2025-01-12 01:06:11,806 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:07:37,524 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:07:37,537 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:07:37,539 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-12 01:07:37,936 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-12 01:07:38,091 - lightrag - INFO - Writing graph with 395 nodes, 327 edges
2025-01-12 01:07:38,109 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 01:09:38,263 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:09:54,102 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:09:54,104 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-12 01:09:54,526 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-12 01:09:54,723 - lightrag - INFO - Writing graph with 401 nodes, 341 edges
2025-01-12 01:09:54,737 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:12:43,851 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:13:10,112 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:13:10,114 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 01:13:10,497 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-12 01:13:10,710 - lightrag - INFO - Writing graph with 407 nodes, 351 edges
2025-01-12 01:13:10,723 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 01:13:10,725 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:14:37,045 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:14:37,052 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:14:37,053 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-12 01:14:37,396 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 01:14:37,559 - lightrag - INFO - Writing graph with 410 nodes, 358 edges
2025-01-12 01:14:37,574 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 01:16:27,125 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:16:39,431 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:16:39,434 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 01:16:39,830 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 01:16:40,022 - lightrag - INFO - Writing graph with 423 nodes, 369 edges
2025-01-12 01:16:40,041 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-12 01:24:11,084 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:24:25,183 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:24:25,184 - lightrag - INFO - Inserting 279 vectors to entities
2025-01-12 01:24:28,579 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-12 01:24:28,783 - lightrag - INFO - Writing graph with 648 nodes, 387 edges
2025-01-12 01:24:28,801 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:25:47,096 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:26:21,751 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:26:21,753 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-12 01:26:22,024 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-12 01:26:22,180 - lightrag - INFO - Writing graph with 657 nodes, 391 edges
2025-01-12 01:26:22,198 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:29:09,445 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-12 01:29:09,506 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-12 01:29:09,512 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 01:29:09,517 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 01:29:09,552 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-12 01:29:09,632 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 01:29:22,429 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:29:22,434 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:29:22,435 - lightrag - INFO - Inserting 26 vectors to entities
2025-01-12 01:29:22,696 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 01:29:22,914 - lightrag - INFO - Writing graph with 670 nodes, 404 edges
2025-01-12 01:29:22,934 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 01:33:59,354 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:33:59,360 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:33:59,362 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-12 01:34:03,727 - lightrag - INFO - Inserting 36 vectors to relationships
2025-01-12 01:34:04,081 - lightrag - INFO - Writing graph with 701 nodes, 431 edges
2025-01-12 01:34:04,101 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:35:33,348 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:35:33,355 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:35:33,357 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 01:35:33,729 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-12 01:35:33,972 - lightrag - INFO - Writing graph with 709 nodes, 438 edges
2025-01-12 01:35:33,993 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 01:37:42,167 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:37:59,694 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:37:59,695 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-12 01:38:00,117 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 01:38:00,289 - lightrag - INFO - Writing graph with 736 nodes, 444 edges
2025-01-12 01:38:00,308 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:39:20,857 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:39:39,931 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:39:39,933 - lightrag - INFO - Inserting 29 vectors to entities
2025-01-12 01:39:40,233 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 01:39:40,440 - lightrag - INFO - Writing graph with 753 nodes, 454 edges
2025-01-12 01:39:40,460 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:40:57,497 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:41:10,266 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:41:10,268 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 01:41:10,685 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 01:41:10,910 - lightrag - INFO - Writing graph with 758 nodes, 460 edges
2025-01-12 01:41:10,929 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 01:41:10,932 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 01:43:06,738 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:43:06,745 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:43:06,746 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-12 01:43:07,091 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-12 01:43:07,334 - lightrag - INFO - Writing graph with 769 nodes, 477 edges
2025-01-12 01:43:07,355 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:44:35,758 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:44:35,760 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:44:35,761 - lightrag - INFO - Inserting 13 vectors to entities
2025-01-12 01:44:35,901 - lightrag - INFO - Inserting 4 vectors to relationships
2025-01-12 01:44:36,031 - lightrag - INFO - Writing graph with 770 nodes, 479 edges
2025-01-12 01:44:36,052 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:46:43,466 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:47:08,778 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:47:08,780 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-12 01:47:09,238 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 01:47:09,407 - lightrag - INFO - Writing graph with 776 nodes, 485 edges
2025-01-12 01:47:09,428 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 01:48:59,107 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:49:16,831 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:49:16,834 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-12 01:49:17,264 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-12 01:49:17,551 - lightrag - INFO - Writing graph with 782 nodes, 492 edges
2025-01-12 01:49:17,574 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 01:52:23,741 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:52:36,063 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:52:36,065 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-12 01:52:36,504 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-12 01:52:36,764 - lightrag - INFO - Writing graph with 789 nodes, 501 edges
2025-01-12 01:52:36,787 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 01:56:23,392 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:56:38,249 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:56:38,251 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 01:56:38,661 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-12 01:56:38,905 - lightrag - INFO - Writing graph with 793 nodes, 506 edges
2025-01-12 01:56:38,928 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 01:59:10,498 - lightrag - INFO - Inserting entities into storage...
2025-01-12 01:59:10,502 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 01:59:10,503 - lightrag - INFO - Inserting 25 vectors to entities
2025-01-12 01:59:10,731 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 01:59:10,919 - lightrag - INFO - Writing graph with 795 nodes, 512 edges
2025-01-12 01:59:10,941 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 02:01:28,481 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:01:38,103 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:01:38,105 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-12 02:01:38,571 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-12 02:01:38,858 - lightrag - INFO - Writing graph with 804 nodes, 526 edges
2025-01-12 02:01:38,880 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:03:03,748 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:03:03,750 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:03:03,751 - lightrag - INFO - Inserting 7 vectors to entities
2025-01-12 02:03:03,845 - lightrag - INFO - Inserting 7 vectors to relationships
2025-01-12 02:03:04,026 - lightrag - INFO - Writing graph with 805 nodes, 532 edges
2025-01-12 02:03:04,064 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:04:10,348 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:04:21,601 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:04:21,603 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-12 02:04:21,974 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 02:04:22,223 - lightrag - INFO - Writing graph with 806 nodes, 538 edges
2025-01-12 02:04:22,244 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 02:04:22,248 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 02:07:14,178 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:07:32,933 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:07:32,935 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-12 02:07:33,213 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-12 02:07:33,472 - lightrag - INFO - Writing graph with 816 nodes, 552 edges
2025-01-12 02:07:33,497 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 02:09:30,073 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:09:30,089 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:09:30,091 - lightrag - INFO - Inserting 43 vectors to entities
2025-01-12 02:09:30,558 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-12 02:09:30,858 - lightrag - INFO - Writing graph with 836 nodes, 570 edges
2025-01-12 02:09:30,882 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 02:11:01,869 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:11:18,096 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:11:18,097 - lightrag - INFO - Inserting 6 vectors to entities
2025-01-12 02:11:18,191 - lightrag - INFO - Inserting 3 vectors to relationships
2025-01-12 02:11:18,340 - lightrag - INFO - Writing graph with 836 nodes, 571 edges
2025-01-12 02:11:18,363 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:12:45,189 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:13:08,027 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:13:08,028 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 02:13:08,458 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 02:13:08,689 - lightrag - INFO - Writing graph with 841 nodes, 583 edges
2025-01-12 02:13:08,715 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 02:15:13,255 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:15:28,474 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:15:28,476 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-12 02:15:28,824 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 02:15:29,068 - lightrag - INFO - Writing graph with 847 nodes, 590 edges
2025-01-12 02:15:29,097 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 02:17:49,545 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:18:11,434 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:18:11,436 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 02:18:11,852 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-12 02:18:12,161 - lightrag - INFO - Writing graph with 859 nodes, 605 edges
2025-01-12 02:18:12,187 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 02:21:00,570 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:21:35,527 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:21:35,530 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-12 02:21:35,932 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 02:21:36,168 - lightrag - INFO - Writing graph with 877 nodes, 612 edges
2025-01-12 02:21:36,193 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:22:49,232 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:23:23,210 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:23:23,212 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 02:23:23,644 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 02:23:23,845 - lightrag - INFO - Writing graph with 878 nodes, 616 edges
2025-01-12 02:23:23,870 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:24:46,654 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:25:03,162 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:25:03,164 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-12 02:25:03,596 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 02:25:03,832 - lightrag - INFO - Writing graph with 881 nodes, 622 edges
2025-01-12 02:25:03,859 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 02:27:12,379 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:27:12,387 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:27:12,389 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 02:27:12,785 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 02:27:13,052 - lightrag - INFO - Writing graph with 892 nodes, 631 edges
2025-01-12 02:27:13,076 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 02:27:13,080 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 02:29:34,610 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:29:59,910 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:30:08,501 - lightrag - INFO - Inserting 58 vectors to entities
2025-01-12 02:30:09,106 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-12 02:30:09,435 - lightrag - INFO - Writing graph with 906 nodes, 639 edges
2025-01-12 02:30:09,464 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 02:34:02,644 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:34:21,271 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:34:21,274 - lightrag - INFO - Inserting 55 vectors to entities
2025-01-12 02:34:21,857 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-12 02:34:22,226 - lightrag - INFO - Writing graph with 926 nodes, 660 edges
2025-01-12 02:34:22,253 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:35:50,196 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:35:50,205 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:35:50,206 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-12 02:35:50,657 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 02:35:50,970 - lightrag - INFO - Writing graph with 937 nodes, 671 edges
2025-01-12 02:35:51,002 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 02:39:34,148 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:39:55,991 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:39:55,994 - lightrag - INFO - Inserting 47 vectors to entities
2025-01-12 02:39:56,498 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-12 02:39:56,839 - lightrag - INFO - Writing graph with 943 nodes, 684 edges
2025-01-12 02:39:56,867 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 02:42:35,290 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:42:52,099 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:42:52,101 - lightrag - INFO - Inserting 50 vectors to entities
2025-01-12 02:42:52,602 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-12 02:42:52,945 - lightrag - INFO - Writing graph with 952 nodes, 707 edges
2025-01-12 02:42:52,973 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 02:45:25,188 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:45:43,225 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:45:43,227 - lightrag - INFO - Inserting 25 vectors to entities
2025-01-12 02:45:43,467 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 02:45:43,713 - lightrag - INFO - Writing graph with 971 nodes, 719 edges
2025-01-12 02:45:43,741 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:47:04,598 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:47:16,939 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:47:23,913 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-12 02:47:24,372 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 02:47:24,681 - lightrag - INFO - Writing graph with 975 nodes, 721 edges
2025-01-12 02:47:24,710 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:48:52,863 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:49:05,330 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:49:05,331 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-12 02:49:05,790 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-12 02:49:06,011 - lightrag - INFO - Writing graph with 986 nodes, 725 edges
2025-01-12 02:49:06,039 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:50:15,400 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:50:47,031 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:50:54,623 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 02:50:55,179 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-12 02:50:55,503 - lightrag - INFO - Writing graph with 989 nodes, 729 edges
2025-01-12 02:50:55,531 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 02:52:49,071 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:52:59,903 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:52:59,904 - lightrag - INFO - Inserting 21 vectors to entities
2025-01-12 02:53:00,120 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 02:53:00,380 - lightrag - INFO - Writing graph with 996 nodes, 742 edges
2025-01-12 02:53:00,411 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 02:53:00,417 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 02:55:36,483 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:55:36,487 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:55:36,488 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-12 02:55:36,813 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-12 02:55:37,120 - lightrag - INFO - Writing graph with 1021 nodes, 762 edges
2025-01-12 02:55:37,154 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:57:06,967 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:57:33,070 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:57:33,073 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-12 02:57:33,495 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 02:57:33,787 - lightrag - INFO - Writing graph with 1022 nodes, 768 edges
2025-01-12 02:57:33,819 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 02:58:45,503 - lightrag - INFO - Inserting entities into storage...
2025-01-12 02:59:24,913 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 02:59:24,915 - lightrag - INFO - Inserting 25 vectors to entities
2025-01-12 02:59:25,202 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 02:59:25,459 - lightrag - INFO - Writing graph with 1026 nodes, 775 edges
2025-01-12 02:59:25,492 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:00:57,531 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:01:32,968 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:01:32,970 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 03:01:33,392 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 03:01:33,678 - lightrag - INFO - Writing graph with 1029 nodes, 780 edges
2025-01-12 03:01:33,708 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:04:31,789 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:04:54,306 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:04:54,308 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-12 03:04:54,632 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-12 03:04:54,944 - lightrag - INFO - Writing graph with 1033 nodes, 789 edges
2025-01-12 03:04:54,975 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:06:19,823 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:06:30,333 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:06:30,336 - lightrag - INFO - Inserting 26 vectors to entities
2025-01-12 03:06:30,663 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-12 03:06:30,989 - lightrag - INFO - Writing graph with 1036 nodes, 792 edges
2025-01-12 03:06:31,021 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:08:43,532 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:08:43,533 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:08:43,534 - lightrag - INFO - Inserting 1 vectors to entities
2025-01-12 03:08:43,572 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 03:08:43,778 - lightrag - INFO - Writing graph with 1038 nodes, 798 edges
2025-01-12 03:08:43,808 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 03:10:57,997 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:11:30,783 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:11:30,785 - lightrag - INFO - Inserting 44 vectors to entities
2025-01-12 03:11:31,363 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-12 03:11:31,706 - lightrag - INFO - Writing graph with 1046 nodes, 810 edges
2025-01-12 03:11:31,737 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:12:57,500 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:13:25,784 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:13:25,786 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-12 03:13:26,147 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 03:13:26,413 - lightrag - INFO - Writing graph with 1050 nodes, 814 edges
2025-01-12 03:13:26,444 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:14:46,722 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:14:46,730 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:14:46,731 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 03:14:47,151 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 03:14:47,365 - lightrag - INFO - Writing graph with 1056 nodes, 819 edges
2025-01-12 03:14:47,394 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 03:14:47,397 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:17:20,057 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:17:52,725 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:17:52,726 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 03:17:53,170 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-12 03:17:53,425 - lightrag - INFO - Writing graph with 1059 nodes, 824 edges
2025-01-12 03:17:53,459 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:19:35,203 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:19:35,208 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:19:35,209 - lightrag - INFO - Inserting 18 vectors to entities
2025-01-12 03:19:35,432 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-12 03:19:35,629 - lightrag - INFO - Writing graph with 1059 nodes, 824 edges
2025-01-12 03:19:35,660 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:20:58,410 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:20:58,418 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:20:58,420 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-12 03:20:58,829 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 03:20:59,088 - lightrag - INFO - Writing graph with 1067 nodes, 825 edges
2025-01-12 03:20:59,119 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:22:21,618 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:23:13,481 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:23:13,484 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-12 03:23:14,009 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 03:23:14,319 - lightrag - INFO - Writing graph with 1068 nodes, 826 edges
2025-01-12 03:23:14,351 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:24:57,462 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:25:37,588 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:25:37,590 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 03:25:37,994 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 03:25:38,279 - lightrag - INFO - Writing graph with 1079 nodes, 833 edges
2025-01-12 03:25:38,311 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:27:30,320 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:27:53,719 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:27:53,721 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 03:27:54,148 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 03:27:54,421 - lightrag - INFO - Writing graph with 1081 nodes, 841 edges
2025-01-12 03:27:54,453 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:29:30,142 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:29:47,665 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:29:47,667 - lightrag - INFO - Inserting 12 vectors to entities
2025-01-12 03:29:47,812 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 03:29:48,104 - lightrag - INFO - Writing graph with 1089 nodes, 845 edges
2025-01-12 03:29:48,137 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:32:46,242 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:33:07,437 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:33:07,440 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 03:33:07,869 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 03:33:08,157 - lightrag - INFO - Writing graph with 1089 nodes, 850 edges
2025-01-12 03:33:08,191 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:34:37,056 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:35:04,900 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:35:04,901 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-12 03:35:05,300 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 03:35:05,556 - lightrag - INFO - Writing graph with 1089 nodes, 853 edges
2025-01-12 03:35:05,589 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:36:32,720 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:36:54,303 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:36:54,306 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 03:36:54,755 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-12 03:36:55,117 - lightrag - INFO - Writing graph with 1098 nodes, 862 edges
2025-01-12 03:36:55,147 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 03:36:55,150 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:38:17,679 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:38:35,356 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:38:43,236 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 03:38:43,738 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-12 03:38:44,027 - lightrag - INFO - Writing graph with 1100 nodes, 864 edges
2025-01-12 03:38:44,061 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:40:26,826 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:40:42,087 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:40:42,089 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 03:40:42,529 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-12 03:40:42,835 - lightrag - INFO - Writing graph with 1110 nodes, 874 edges
2025-01-12 03:40:42,867 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:42:34,739 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:42:34,741 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:42:34,742 - lightrag - INFO - Inserting 6 vectors to entities
2025-01-12 03:42:34,836 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-12 03:42:35,076 - lightrag - INFO - Writing graph with 1110 nodes, 874 edges
2025-01-12 03:42:35,109 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:44:39,853 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:44:39,865 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:44:39,866 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-12 03:44:40,389 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-12 03:44:40,639 - lightrag - INFO - Writing graph with 1111 nodes, 877 edges
2025-01-12 03:44:40,671 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:47:17,391 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:47:45,232 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:47:45,234 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-12 03:47:45,630 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 03:47:45,945 - lightrag - INFO - Writing graph with 1118 nodes, 884 edges
2025-01-12 03:47:45,979 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:49:04,271 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:49:35,624 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:49:35,626 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-12 03:49:35,993 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 03:49:36,282 - lightrag - INFO - Writing graph with 1121 nodes, 885 edges
2025-01-12 03:49:36,316 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:51:19,111 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:51:57,081 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:51:57,082 - lightrag - INFO - Inserting 29 vectors to entities
2025-01-12 03:51:57,440 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 03:51:57,681 - lightrag - INFO - Writing graph with 1124 nodes, 888 edges
2025-01-12 03:51:57,714 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:53:37,534 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:53:57,211 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:53:57,213 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-12 03:53:57,615 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-12 03:53:57,935 - lightrag - INFO - Writing graph with 1137 nodes, 901 edges
2025-01-12 03:53:57,970 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:55:54,679 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:55:54,682 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:55:54,683 - lightrag - INFO - Inserting 11 vectors to entities
2025-01-12 03:55:54,820 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 03:55:55,081 - lightrag - INFO - Writing graph with 1139 nodes, 906 edges
2025-01-12 03:55:55,118 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:57:48,670 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:58:01,548 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:58:01,551 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-12 03:58:02,050 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-12 03:58:02,398 - lightrag - INFO - Writing graph with 1142 nodes, 909 edges
2025-01-12 03:58:02,430 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 03:58:02,434 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 03:59:11,658 - lightrag - INFO - Inserting entities into storage...
2025-01-12 03:59:32,561 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 03:59:32,563 - lightrag - INFO - Inserting 21 vectors to entities
2025-01-12 03:59:32,809 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 03:59:33,094 - lightrag - INFO - Writing graph with 1146 nodes, 916 edges
2025-01-12 03:59:33,131 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:02:24,952 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:02:39,796 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:02:39,799 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 04:02:40,254 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-12 04:02:40,583 - lightrag - INFO - Writing graph with 1151 nodes, 924 edges
2025-01-12 04:02:40,618 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:04:59,961 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:05:30,699 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:05:30,701 - lightrag - INFO - Inserting 13 vectors to entities
2025-01-12 04:05:30,897 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 04:05:31,154 - lightrag - INFO - Writing graph with 1151 nodes, 925 edges
2025-01-12 04:05:31,188 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:06:58,471 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:07:22,369 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:07:22,371 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 04:07:22,843 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 04:07:23,157 - lightrag - INFO - Writing graph with 1152 nodes, 927 edges
2025-01-12 04:07:23,191 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:09:22,575 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:09:38,412 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:09:38,414 - lightrag - INFO - Inserting 29 vectors to entities
2025-01-12 04:09:38,750 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 04:09:39,051 - lightrag - INFO - Writing graph with 1155 nodes, 934 edges
2025-01-12 04:09:39,087 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:11:37,058 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:12:05,768 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:12:14,863 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 04:12:15,335 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-12 04:12:15,702 - lightrag - INFO - Writing graph with 1158 nodes, 950 edges
2025-01-12 04:12:15,741 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:14:02,325 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:14:02,329 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:14:02,330 - lightrag - INFO - Inserting 13 vectors to entities
2025-01-12 04:14:02,530 - lightrag - INFO - Inserting 7 vectors to relationships
2025-01-12 04:14:02,803 - lightrag - INFO - Writing graph with 1159 nodes, 952 edges
2025-01-12 04:14:02,837 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:15:39,598 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:15:39,605 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:15:39,607 - lightrag - INFO - Inserting 43 vectors to entities
2025-01-12 04:15:40,049 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-12 04:15:40,332 - lightrag - INFO - Writing graph with 1173 nodes, 954 edges
2025-01-12 04:15:40,368 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:17:12,317 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:17:46,534 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:17:46,537 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 04:17:47,029 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 04:17:47,503 - lightrag - INFO - Writing graph with 1176 nodes, 960 edges
2025-01-12 04:17:47,610 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:19:28,435 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:20:05,452 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:20:05,454 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 04:20:05,949 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 04:20:06,272 - lightrag - INFO - Writing graph with 1178 nodes, 966 edges
2025-01-12 04:20:06,305 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 04:20:06,308 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:24:12,915 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:24:26,783 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:24:26,786 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 04:24:27,281 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-12 04:24:27,648 - lightrag - INFO - Writing graph with 1181 nodes, 975 edges
2025-01-12 04:24:27,683 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:26:05,363 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:26:21,280 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:26:21,282 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 04:26:21,716 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 04:26:22,037 - lightrag - INFO - Writing graph with 1187 nodes, 980 edges
2025-01-12 04:26:22,074 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:27:49,280 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:28:19,725 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:28:19,726 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 04:28:20,161 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-12 04:28:20,437 - lightrag - INFO - Writing graph with 1187 nodes, 986 edges
2025-01-12 04:28:20,473 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:30:02,860 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:30:18,203 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:30:18,205 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 04:30:18,618 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 04:30:18,940 - lightrag - INFO - Writing graph with 1194 nodes, 995 edges
2025-01-12 04:30:18,978 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:32:57,076 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:33:21,392 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:33:21,394 - lightrag - INFO - Inserting 24 vectors to entities
2025-01-12 04:33:21,743 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 04:33:22,097 - lightrag - INFO - Writing graph with 1197 nodes, 1000 edges
2025-01-12 04:33:22,137 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:34:55,809 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:35:27,033 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:35:27,035 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 04:35:27,475 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 04:35:27,773 - lightrag - INFO - Writing graph with 1205 nodes, 1008 edges
2025-01-12 04:35:27,811 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:37:16,394 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:37:50,724 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:37:50,727 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 04:37:51,216 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-12 04:37:51,590 - lightrag - INFO - Writing graph with 1207 nodes, 1012 edges
2025-01-12 04:37:51,629 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:39:34,543 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:39:34,549 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:39:34,551 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 04:39:34,915 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 04:39:35,250 - lightrag - INFO - Writing graph with 1221 nodes, 1020 edges
2025-01-12 04:39:35,288 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:41:00,166 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:41:28,072 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:41:28,075 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 04:41:28,560 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-12 04:41:28,897 - lightrag - INFO - Writing graph with 1225 nodes, 1025 edges
2025-01-12 04:41:28,934 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:43:16,414 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:43:46,390 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:43:46,393 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-12 04:43:46,922 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 04:43:47,267 - lightrag - INFO - Writing graph with 1228 nodes, 1030 edges
2025-01-12 04:43:47,301 - lightrag - INFO - Processing 5 new unique documents
2025-01-12 04:43:47,305 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:45:28,778 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:45:54,544 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:45:54,548 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-12 04:45:55,155 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 04:45:55,472 - lightrag - INFO - Writing graph with 1230 nodes, 1031 edges
2025-01-12 04:45:55,510 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:47:57,219 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:48:07,563 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:48:07,564 - lightrag - INFO - Inserting 16 vectors to entities
2025-01-12 04:48:07,763 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 04:48:08,066 - lightrag - INFO - Writing graph with 1233 nodes, 1039 edges
2025-01-12 04:48:08,104 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:49:49,161 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:50:03,732 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:50:03,734 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-12 04:50:04,134 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 04:50:04,466 - lightrag - INFO - Writing graph with 1238 nodes, 1046 edges
2025-01-12 04:50:04,504 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:51:42,744 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:52:12,320 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:52:12,323 - lightrag - INFO - Inserting 18 vectors to entities
2025-01-12 04:52:12,578 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 04:52:12,905 - lightrag - INFO - Writing graph with 1238 nodes, 1049 edges
2025-01-12 04:52:12,944 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 04:54:10,879 - lightrag - INFO - Inserting entities into storage...
2025-01-12 04:54:10,882 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 04:54:10,884 - lightrag - INFO - Inserting 12 vectors to entities
2025-01-12 04:54:11,054 - lightrag - INFO - Inserting 6 vectors to relationships
2025-01-12 04:54:11,365 - lightrag - INFO - Writing graph with 1240 nodes, 1051 edges
2025-01-12 04:54:28,538 - lightrag - INFO - Local query uses 60 entites, 33 relations, 4 text units
2025-01-12 04:54:28,610 - lightrag - INFO - Global query uses 14 entites, 60 relations, 4 text units
2025-01-12 05:04:52,155 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 05:04:52,217 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-12 05:04:52,222 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 05:04:52,227 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 05:04:52,259 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 05:04:52,299 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 05:04:52,300 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,300 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,301 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,301 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,302 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,302 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,303 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,304 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,304 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,304 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,305 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,305 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:04:52,306 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:00,477 - lightrag - INFO - Local query uses 60 entites, 112 relations, 3 text units
2025-01-12 05:05:00,574 - lightrag - INFO - Global query uses 14 entites, 60 relations, 4 text units
2025-01-12 05:05:31,197 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 05:05:31,257 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-12 05:05:31,263 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 05:05:31,267 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 05:05:31,300 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 05:05:31,339 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 05:05:31,340 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,341 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,341 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,342 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,342 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,343 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,343 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,344 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,344 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,345 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,345 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,346 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:31,346 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 05:05:35,973 - lightrag - INFO - kw_prompt result:
2025-01-12 05:05:35,973 - lightrag - INFO - Using hybrid mode for query processing
2025-01-12 05:05:36,322 - lightrag - INFO - Local query uses 60 entites, 33 relations, 4 text units
2025-01-12 05:05:36,373 - lightrag - INFO - Global query uses 15 entites, 60 relations, 4 text units
2025-01-12 07:10:02,135 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:10:02,197 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:10:02,202 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:10:02,207 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:10:02,239 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:10:02,280 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:10:02,281 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,282 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,282 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,283 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,283 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,284 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,284 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,285 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,285 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,286 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,286 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,287 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:10:02,287 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,230 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:11:13,292 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:11:13,298 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:11:13,302 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:11:13,336 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:11:13,375 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:11:13,376 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,377 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,377 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,378 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,378 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,379 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,380 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,380 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,381 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,381 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,382 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,382 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:13,382 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:11:20,621 - lightrag - INFO - kw_prompt result:
2025-01-12 07:11:20,621 - lightrag - INFO - Using hybrid mode for query processing
2025-01-12 07:11:22,013 - lightrag - INFO - Local query uses 60 entites, 27 relations, 4 text units
2025-01-12 07:11:22,060 - lightrag - INFO - Global query uses 16 entites, 60 relations, 3 text units
2025-01-12 07:12:24,362 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:12:24,433 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:12:24,438 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:12:24,443 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:12:24,479 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:12:24,525 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:12:24,526 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,527 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,527 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,528 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,529 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,529 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,530 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,530 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,531 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,532 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,532 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,533 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:24,533 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:27,315 - lightrag - INFO - kw_prompt result:
2025-01-12 07:12:27,315 - lightrag - INFO - Using hybrid mode for query processing
2025-01-12 07:12:27,674 - lightrag - INFO - Local query uses 60 entites, 65 relations, 3 text units
2025-01-12 07:12:27,720 - lightrag - INFO - Global query uses 11 entites, 60 relations, 4 text units
2025-01-12 07:12:48,215 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:12:48,276 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:12:48,281 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:12:48,286 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:12:48,318 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:12:48,359 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:12:48,360 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,360 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,361 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,361 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,362 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,363 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,363 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,364 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,364 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,365 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,365 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,366 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:48,366 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:12:53,990 - lightrag - INFO - Local query uses 60 entites, 33 relations, 4 text units
2025-01-12 07:12:54,076 - lightrag - INFO - Global query uses 13 entites, 60 relations, 3 text units
2025-01-12 07:14:21,442 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:14:21,503 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:14:21,509 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:14:21,514 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:14:21,546 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:14:21,594 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:14:21,595 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,596 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,596 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,597 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,597 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,598 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,599 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,599 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,600 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,600 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,601 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,601 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:21,601 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:26,414 - lightrag - INFO - Local query uses 60 entites, 82 relations, 3 text units
2025-01-12 07:14:26,501 - lightrag - INFO - Global query uses 16 entites, 60 relations, 4 text units
2025-01-12 07:14:49,524 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:14:49,585 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:14:49,590 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:14:49,595 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:14:49,629 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:14:49,669 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:14:49,671 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,671 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,672 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,672 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,673 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,674 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,674 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,675 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,675 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,676 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,676 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,677 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:49,677 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:14:54,942 - lightrag - INFO - kw_prompt result:
2025-01-12 07:14:54,942 - lightrag - INFO - Using hybrid mode for query processing
2025-01-12 07:14:55,299 - lightrag - INFO - Local query uses 60 entites, 115 relations, 3 text units
2025-01-12 07:14:55,348 - lightrag - INFO - Global query uses 16 entites, 60 relations, 4 text units
2025-01-12 07:16:06,058 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:16:06,129 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:16:06,135 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:16:06,141 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:16:06,178 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:16:06,224 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:16:06,225 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,226 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,226 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,227 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,227 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,228 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,229 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,229 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,230 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,230 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,231 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,231 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:06,232 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:10,597 - lightrag - INFO - kw_prompt result:
2025-01-12 07:16:10,598 - lightrag - INFO - Using hybrid mode for query processing
2025-01-12 07:16:10,950 - lightrag - INFO - Local query uses 60 entites, 27 relations, 3 text units
2025-01-12 07:16:10,997 - lightrag - INFO - Global query uses 11 entites, 60 relations, 4 text units
2025-01-12 07:16:41,502 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:16:41,564 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:16:41,568 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:16:41,573 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:16:41,605 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:16:41,645 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:16:41,646 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,647 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,648 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,648 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,649 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,649 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,650 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,650 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,651 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,651 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,652 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,652 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:41,653 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:16:45,879 - lightrag - INFO - kw_prompt result:
2025-01-12 07:16:45,880 - lightrag - INFO - Using hybrid mode for query processing
2025-01-12 07:16:46,213 - lightrag - INFO - Local query uses 60 entites, 27 relations, 4 text units
2025-01-12 07:16:46,259 - lightrag - INFO - Global query uses 11 entites, 60 relations, 4 text units
2025-01-12 07:17:31,281 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:17:31,343 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:17:31,348 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:17:31,353 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:17:31,385 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:17:31,429 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:17:31,430 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,431 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,431 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,432 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,433 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,433 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,434 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,434 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,435 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,436 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,436 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,437 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:31,437 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:17:36,194 - lightrag - INFO - kw_prompt result:
2025-01-12 07:17:36,194 - lightrag - INFO - Using hybrid mode for query processing
2025-01-12 07:17:36,499 - lightrag - INFO - Local query uses 60 entites, 57 relations, 3 text units
2025-01-12 07:17:36,544 - lightrag - INFO - Global query uses 23 entites, 60 relations, 4 text units
2025-01-12 07:18:22,586 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 07:18:22,648 - lightrag - INFO - Load KV llm_response_cache with 3 data
2025-01-12 07:18:22,652 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-12 07:18:22,657 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-12 07:18:22,689 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1240 nodes, 1051 edges
2025-01-12 07:18:22,729 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-12 07:18:22,730 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,730 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,731 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,731 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,732 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,732 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,733 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,734 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,734 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,734 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,735 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,735 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:22,736 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:18:31,979 - lightrag - INFO - Local query uses 60 entites, 33 relations, 3 text units
2025-01-12 07:18:32,076 - lightrag - INFO - Global query uses 21 entites, 60 relations, 6 text units
2025-01-12 07:19:25,492 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc_index
2025-01-12 07:19:25,492 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 07:19:25,492 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 07:19:25,492 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 07:19:25,493 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 07:19:25,494 - lightrag - INFO - Processing 142 new unique documents
2025-01-12 07:19:25,758 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,760 - lightrag - ERROR - Failed to process document doc-473cce81bdc86dc0702477cb11abbfc9: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,760 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,768 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,769 - lightrag - ERROR - Failed to process document doc-53f65a4eb2b48fda50f04e03e01bcd7e: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,770 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,771 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,772 - lightrag - ERROR - Failed to process document doc-33d854cc6978d1c04620e80f95cabec5: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,773 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,773 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,775 - lightrag - ERROR - Failed to process document doc-0fae3b921917aaabf2c7eb3dea24923e: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,775 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,776 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,777 - lightrag - ERROR - Failed to process document doc-c98f78ca8258c6d78c8a606d7221ad26: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,778 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,779 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,780 - lightrag - ERROR - Failed to process document doc-c606c247a0db12abec967f13f611b945: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,781 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,781 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,782 - lightrag - ERROR - Failed to process document doc-f87d4a41188302e6293c17b4a22d706e: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,783 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,784 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,785 - lightrag - ERROR - Failed to process document doc-746ff56babc194b91764bd00ac4abde4: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,786 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,787 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,788 - lightrag - ERROR - Failed to process document doc-9e08b7cca8f8557eca6b536042f31205: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,788 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,789 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,790 - lightrag - ERROR - Failed to process document doc-8b74bb6cdf748d398a76aeee0f9d8f23: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,791 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,792 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,793 - lightrag - ERROR - Failed to process document doc-d27d561468442851af42cb0149608314: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,794 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,795 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,796 - lightrag - ERROR - Failed to process document doc-ed54f713ffd820fa8f370f171659e9a8: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,797 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,797 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,798 - lightrag - ERROR - Failed to process document doc-79b2d9dbf580a1ced698808bf21bcf7b: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,800 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,800 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,801 - lightrag - ERROR - Failed to process document doc-2a6d8e63605d5cb29e8db637041b0256: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,802 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,803 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,804 - lightrag - ERROR - Failed to process document doc-be2b2cc8c3ceedd208c6f4d802ce5bc2: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,806 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,807 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:19:25,808 - lightrag - ERROR - Failed to process document doc-73756d2acc5b51230a292bb17c5c9457: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable
Traceback (most recent call last):
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 461, in ainsert
    raise e
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/lightrag.py", line 417, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/coder/llm-demo/graph-rag/lightrag/lightrag/llm.py", line 901, in openai_embedding
    AsyncOpenAI() if base_url is None else AsyncOpenAI(base_url=base_url)
    ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/openai/_client.py", line 337, in __init__
    raise OpenAIError(
openai.OpenAIError: The api_key client option must be set either by passing api_key to the client or by setting the OPENAI_API_KEY environment variable

2025-01-12 07:19:25,809 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 07:19:25,810 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:21:50,614 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc_index
2025-01-12 07:21:50,614 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 07:21:50,614 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 07:21:50,614 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 07:21:50,615 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 07:21:50,616 - lightrag - INFO - Processing 142 new unique documents
2025-01-12 07:21:50,867 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:21:58,475 - lightrag - INFO - Inserting entities into storage...
2025-01-12 07:21:58,476 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 07:21:58,476 - lightrag - WARNING - Didn't extract any relationships
2025-01-12 07:21:58,476 - lightrag - INFO - Inserting 3 vectors to entities
2025-01-12 07:21:59,312 - lightrag - INFO - Inserting 0 vectors to relationships
2025-01-12 07:21:59,313 - lightrag - WARNING - You insert an empty data to vector DB
2025-01-12 07:21:59,314 - lightrag - INFO - Writing graph with 3 nodes, 0 edges
2025-01-12 07:21:59,320 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:22:10,484 - lightrag - INFO - Inserting entities into storage...
2025-01-12 07:22:10,484 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 07:22:10,485 - lightrag - INFO - Inserting 1 vectors to entities
2025-01-12 07:22:11,186 - lightrag - INFO - Inserting 1 vectors to relationships
2025-01-12 07:22:11,918 - lightrag - INFO - Writing graph with 5 nodes, 1 edges
2025-01-12 07:22:11,919 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:22:23,953 - lightrag - INFO - Inserting entities into storage...
2025-01-12 07:22:23,954 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 07:22:23,955 - lightrag - INFO - Inserting 6 vectors to entities
2025-01-12 07:22:25,236 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-12 07:22:26,616 - lightrag - INFO - Writing graph with 11 nodes, 6 edges
2025-01-12 07:22:26,617 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:24:03,247 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc_index
2025-01-12 07:24:03,247 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 07:24:03,247 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 07:24:03,248 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 07:24:03,248 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 07:24:03,249 - lightrag - INFO - Processing 142 new unique documents
2025-01-12 07:24:03,497 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:24:16,215 - lightrag - INFO - Inserting entities into storage...
2025-01-12 07:24:16,216 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 07:24:16,216 - lightrag - WARNING - Didn't extract any relationships
2025-01-12 07:24:16,216 - lightrag - INFO - Inserting 3 vectors to entities
2025-01-12 07:24:17,110 - lightrag - INFO - Inserting 0 vectors to relationships
2025-01-12 07:24:17,110 - lightrag - WARNING - You insert an empty data to vector DB
2025-01-12 07:24:17,112 - lightrag - INFO - Writing graph with 3 nodes, 0 edges
2025-01-12 07:24:17,117 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:24:30,097 - lightrag - INFO - Inserting entities into storage...
2025-01-12 07:24:30,098 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 07:24:30,099 - lightrag - INFO - Inserting 5 vectors to entities
2025-01-12 07:24:31,262 - lightrag - INFO - Inserting 3 vectors to relationships
2025-01-12 07:24:32,329 - lightrag - INFO - Writing graph with 6 nodes, 3 edges
2025-01-12 07:24:32,330 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:25:24,139 - lightrag - INFO - Inserting entities into storage...
2025-01-12 07:25:24,140 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 07:25:24,140 - lightrag - INFO - Inserting 4 vectors to entities
2025-01-12 07:25:25,408 - lightrag - INFO - Inserting 4 vectors to relationships
2025-01-12 07:25:26,478 - lightrag - INFO - Writing graph with 10 nodes, 7 edges
2025-01-12 07:25:26,479 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:26:02,062 - lightrag - INFO - Inserting entities into storage...
2025-01-12 07:26:02,063 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 07:26:02,063 - lightrag - INFO - Inserting 5 vectors to entities
2025-01-12 07:26:04,668 - lightrag - INFO - Inserting 4 vectors to relationships
2025-01-12 07:26:05,796 - lightrag - INFO - Writing graph with 13 nodes, 11 edges
2025-01-12 07:26:05,798 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:26:32,941 - lightrag - INFO - Inserting entities into storage...
2025-01-12 07:26:32,941 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 07:26:32,942 - lightrag - INFO - Inserting 2 vectors to entities
2025-01-12 07:26:33,719 - lightrag - INFO - Inserting 2 vectors to relationships
2025-01-12 07:26:34,991 - lightrag - INFO - Writing graph with 16 nodes, 13 edges
2025-01-12 07:26:34,992 - lightrag - INFO - Inserting 1 vectors to chunks
2025-01-12 07:27:03,266 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc_index
2025-01-12 07:27:03,266 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 07:27:03,266 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 07:27:03,266 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 07:27:03,267 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 07:27:03,267 - lightrag - INFO - Processing 1 new unique documents
2025-01-12 07:27:03,515 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 07:29:20,429 - lightrag - INFO - Inserting entities into storage...
2025-01-12 07:29:20,431 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 07:29:20,432 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-12 07:29:23,269 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-12 07:29:25,251 - lightrag - INFO - Writing graph with 50 nodes, 21 edges
2025-01-12 07:29:34,870 - lightrag - INFO - Local query uses 35 entites, 20 relations, 4 text units
2025-01-12 07:29:35,562 - lightrag - INFO - Global query uses 21 entites, 19 relations, 4 text units
2025-01-12 07:31:14,279 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc_index
2025-01-12 07:31:14,280 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-12 07:31:14,280 - lightrag - INFO - Load KV full_docs with 1 data
2025-01-12 07:31:14,280 - lightrag - INFO - Load KV text_chunks with 4 data
2025-01-12 07:31:14,282 - lightrag - INFO - Loaded graph from ./contemi_opensrc_index/graph_chunk_entity_relation.graphml with 50 nodes, 21 edges
2025-01-12 07:31:14,284 - lightrag - INFO - Loaded document status storage with 1 records
2025-01-12 07:31:14,285 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 07:31:24,876 - lightrag - INFO - kw_prompt result:
2025-01-12 07:31:24,876 - lightrag - INFO - Using hybrid mode for query processing
2025-01-12 07:31:26,777 - lightrag - INFO - Global query uses 20 entites, 18 relations, 4 text units
2025-01-12 13:09:23,658 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 13:09:23,658 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 13:09:23,658 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 13:09:23,658 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 13:09:23,659 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 13:09:23,661 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 13:14:23,320 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 13:14:33,658 - lightrag - ERROR - Failed to process document doc-23faf40d619a65d83f06434f1020effb: llama runner process has terminated: error loading model: unable to allocate CUDA0 buffer
llama_load_model_from_file: failed to load model
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 402, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 431, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 363, in _process_single_content
    final_result = await _user_llm_func_with_cache(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 341, in _user_llm_func_with_cache
    res: str = await use_llm_func(input_text)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: llama runner process has terminated: error loading model: unable to allocate CUDA0 buffer
llama_load_model_from_file: failed to load model

2025-01-12 13:14:33,659 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 13:14:33,662 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 15:01:22,552 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 15:01:22,552 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 15:01:22,553 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 15:01:22,553 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 15:01:22,553 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 15:01:22,555 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 15:01:22,795 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 15:02:47,221 - lightrag - ERROR - Failed to process document doc-89ca1d0b48c4c733275e39f4856c8cd4: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 377, in handle_async_request
    resp = await self._pool.handle_async_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 216, in handle_async_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection_pool.py", line 196, in handle_async_request
    response = await connection.handle_async_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/connection.py", line 101, in handle_async_request
    return await self._connection.handle_async_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 143, in handle_async_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 113, in handle_async_request
    ) = await self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 186, in _receive_response_headers
    event = await self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_async/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 402, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 431, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 363, in _process_single_content
    final_result = await _user_llm_func_with_cache(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 341, in _user_llm_func_with_cache
    res: str = await use_llm_func(input_text)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 620, in _request_raw
    r = await self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1585, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1674, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1702, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1739, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1776, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 376, in handle_async_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-12 15:02:47,222 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 15:02:47,225 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 15:03:38,249 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 15:03:38,249 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 15:03:38,249 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 15:03:38,249 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 15:03:38,250 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 15:03:38,252 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 15:03:38,520 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 15:04:57,820 - lightrag - INFO - Inserting entities into storage...
2025-01-12 15:04:57,826 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 15:04:57,827 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 15:05:00,015 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 15:05:01,446 - lightrag - INFO - Writing graph with 39 nodes, 13 edges
2025-01-12 15:05:01,451 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 15:06:23,755 - lightrag - INFO - Inserting entities into storage...
2025-01-12 15:06:23,757 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 15:06:23,759 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 15:06:25,603 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-12 15:06:27,585 - lightrag - INFO - Writing graph with 52 nodes, 34 edges
2025-01-12 15:06:27,589 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 15:07:54,505 - lightrag - INFO - Inserting entities into storage...
2025-01-12 15:07:54,508 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 15:07:54,509 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 15:07:56,564 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 15:07:58,591 - lightrag - INFO - Writing graph with 61 nodes, 48 edges
2025-01-12 15:07:58,596 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 15:09:32,933 - lightrag - INFO - Inserting entities into storage...
2025-01-12 15:09:32,933 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 15:09:32,934 - lightrag - WARNING - Didn't extract any entities
2025-01-12 15:09:32,934 - lightrag - INFO - Inserting 0 vectors to entities
2025-01-12 15:09:32,934 - lightrag - WARNING - You insert an empty data to vector DB
2025-01-12 15:09:32,934 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 15:09:34,248 - lightrag - INFO - Writing graph with 65 nodes, 54 edges
2025-01-12 15:09:34,252 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 15:11:40,979 - lightrag - INFO - Inserting entities into storage...
2025-01-12 15:11:40,980 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 15:11:40,980 - lightrag - INFO - Inserting 9 vectors to entities
2025-01-12 15:11:42,554 - lightrag - INFO - Inserting 7 vectors to relationships
2025-01-12 15:11:43,811 - lightrag - INFO - Writing graph with 72 nodes, 60 edges
2025-01-12 15:11:43,817 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 18:17:53,863 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 18:17:53,863 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 18:17:53,863 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 18:17:53,863 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 18:17:53,864 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 18:17:53,867 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 18:17:54,147 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:17:55,823 - lightrag - ERROR - Failed to process document doc-508e0902aba29322e30f3bc1f9d351a1: model is required
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 402, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 431, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 363, in _process_single_content
    final_result = await _user_llm_func_with_cache(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 341, in _user_llm_func_with_cache
    res: str = await use_llm_func(input_text)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: model is required

2025-01-12 18:17:55,824 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:17:55,829 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 18:21:13,232 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 18:21:13,232 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 18:21:13,233 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 18:21:13,233 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 18:21:13,234 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-12 18:21:13,234 - lightrag - INFO - Loaded document status storage with 2 records
2025-01-12 18:21:13,235 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 18:21:13,491 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:21:14,912 - lightrag - ERROR - Failed to process document doc-508e0902aba29322e30f3bc1f9d351a1: model is required
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 402, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 431, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 363, in _process_single_content
    final_result = await _user_llm_func_with_cache(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 341, in _user_llm_func_with_cache
    res: str = await use_llm_func(input_text)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: model is required

2025-01-12 18:21:14,913 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:21:14,916 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:22:03,327 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 18:22:03,327 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 18:22:03,327 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 18:22:03,327 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 18:22:03,328 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 18:22:03,329 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 18:22:03,597 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 18:22:05,055 - lightrag - ERROR - Failed to process document doc-042d43ec75838af6c5f8a83a81e2f75d: model is required
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 402, in ainsert
    maybe_new_kg = await extract_entities(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 431, in extract_entities
    results.append(await result)
                   ^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/asyncio/tasks.py", line 615, in _wait_for_one
    return f.result()  # May raise f.exception().
           ^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 363, in _process_single_content
    final_result = await _user_llm_func_with_cache(hint_prompt)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/operate.py", line 341, in _user_llm_func_with_cache
    res: str = await use_llm_func(input_text)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 679, in ollama_model_complete
    return await ollama_model_if_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 189, in async_wrapped
    return await copy(fn, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 111, in __call__
    do = await self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/lib/python3.11/site-packages/tenacity/asyncio/__init__.py", line 114, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 359, in ollama_model_if_cache
    response = await ollama_client.chat(model=model, messages=messages, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 834, in chat
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 679, in _request
    return cls(**(await self._request_raw(*args, **kwargs)).json())
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 624, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: model is required

2025-01-12 18:22:05,056 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:22:05,059 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:22:41,212 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 18:22:41,213 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 18:22:41,213 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 18:22:41,213 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 18:22:41,213 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 18:22:41,214 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 18:22:41,486 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 18:24:34,350 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 18:24:34,355 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 18:24:34,355 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 18:24:34,355 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 18:24:34,356 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 18:24:34,357 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 18:24:34,616 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 18:26:31,567 - lightrag - INFO - Inserting entities into storage...
2025-01-12 18:26:31,567 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 18:26:31,568 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-12 18:26:31,568 - lightrag - ERROR - Failed to process document doc-b74307e8e8b40931509bd7b72e08662b: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 412, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-12 18:26:31,570 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:31,574 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:32,760 - lightrag - ERROR - Failed to process document doc-89ca1d0b48c4c733275e39f4856c8cd4: llama runner process has terminated: cudaMalloc failed: out of memory
llama_kv_cache_init: failed to allocate buffer for kv cache
llama_new_context_with_model: llama_kv_cache_init() failed for self-attention cache
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 122, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: llama runner process has terminated: cudaMalloc failed: out of memory
llama_kv_cache_init: failed to allocate buffer for kv cache
llama_new_context_with_model: llama_kv_cache_init() failed for self-attention cache

2025-01-12 18:26:32,762 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:32,767 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:34,317 - lightrag - ERROR - Failed to process document doc-608b9f2cba02e1ad1b55e2c7fb897afb: llama runner process has terminated: cudaMalloc failed: out of memory
llama_kv_cache_init: failed to allocate buffer for kv cache
llama_new_context_with_model: llama_kv_cache_init() failed for self-attention cache
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 122, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: llama runner process has terminated: cudaMalloc failed: out of memory
llama_kv_cache_init: failed to allocate buffer for kv cache
llama_new_context_with_model: llama_kv_cache_init() failed for self-attention cache

2025-01-12 18:26:34,319 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:34,322 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:39,868 - lightrag - ERROR - Failed to process document doc-8c6f392f2628afb84ebbc5012516b472: llama runner process has terminated: cudaMalloc failed: out of memory
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 122, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: llama runner process has terminated: cudaMalloc failed: out of memory

2025-01-12 18:26:39,870 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:39,874 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:45,359 - lightrag - ERROR - Failed to process document doc-508e0902aba29322e30f3bc1f9d351a1: llama runner process has terminated: cudaMalloc failed: out of memory
llama_kv_cache_init: failed to allocate buffer for kv cache
llama_new_context_with_model: llama_kv_cache_init() failed for self-attention cache
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 122, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: llama runner process has terminated: cudaMalloc failed: out of memory
llama_kv_cache_init: failed to allocate buffer for kv cache
llama_new_context_with_model: llama_kv_cache_init() failed for self-attention cache

2025-01-12 18:26:45,361 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:45,365 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:46,923 - lightrag - ERROR - Failed to process document doc-23faf40d619a65d83f06434f1020effb: llama runner process has terminated: cudaMalloc failed: out of memory
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 122, in _request_raw
    raise ResponseError(e.response.text, e.response.status_code) from None
ollama._types.ResponseError: llama runner process has terminated: cudaMalloc failed: out of memory

2025-01-12 18:26:46,924 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:46,927 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:48,709 - lightrag - ERROR - Failed to process document doc-9b63951d2857bac5c941251c1ce82ac4: Server disconnected without sending a response.
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 101, in handle_request
    return self._connection.handle_request(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/http11.py", line 143, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/http11.py", line 113, in handle_request
    ) = self._receive_response_headers(**kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/http11.py", line 186, in _receive_response_headers
    event = self._receive_event(timeout=timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/http11.py", line 238, in _receive_event
    raise RemoteProtocolError(msg)
httpcore.RemoteProtocolError: Server disconnected without sending a response.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.RemoteProtocolError: Server disconnected without sending a response.

2025-01-12 18:26:48,712 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,715 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:48,736 - lightrag - ERROR - Failed to process document doc-e3b24795f25f25b4620e5152c1b11a92: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,738 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,741 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 18:26:48,762 - lightrag - ERROR - Failed to process document doc-5113f76f33578b6e887605819b6dbf3d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,764 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,768 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 18:26:48,795 - lightrag - ERROR - Failed to process document doc-042d43ec75838af6c5f8a83a81e2f75d: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,798 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,800 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 18:26:48,803 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:48,831 - lightrag - ERROR - Failed to process document doc-58831d54567176531655d47bec85787e: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,833 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,835 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:48,855 - lightrag - ERROR - Failed to process document doc-0983084c8f89517c55e17dc222e452a0: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,857 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,859 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:48,880 - lightrag - ERROR - Failed to process document doc-66c217b3de2c4fbe60d806a759552c27: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,882 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,885 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:48,905 - lightrag - ERROR - Failed to process document doc-05135db5bdf79f8e990c0d5cd95618cc: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,907 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,912 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 18:26:48,932 - lightrag - ERROR - Failed to process document doc-d7ccad49e8b02ca09d44e7767258fe87: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,934 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,937 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 18:26:48,957 - lightrag - ERROR - Failed to process document doc-924c92b5dcb353021671bdf1ab0d28ab: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,959 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,961 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:26:48,982 - lightrag - ERROR - Failed to process document doc-3c8583eeade57f798ff223565c3957eb: [Errno 111] Connection refused
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 72, in map_httpcore_exceptions
    yield
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 236, in handle_request
    resp = self._pool.handle_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 216, in handle_request
    raise exc from None
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection_pool.py", line 196, in handle_request
    response = connection.handle_request(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 99, in handle_request
    raise exc
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 76, in handle_request
    stream = self._connect(request)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_sync/connection.py", line 122, in _connect
    stream = self._network_backend.connect_tcp(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_backends/sync.py", line 205, in connect_tcp
    with map_exceptions(exc_map):
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpcore/_exceptions.py", line 14, in map_exceptions
    raise to_exc(exc) from exc
httpcore.ConnectError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 399, in ainsert
    await self.chunks_vdb.upsert(chunks)
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 146, in upsert
    embeddings_list = await asyncio.gather(*embedding_tasks)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/storage.py", line 138, in wrapped_task
    result = await self.embedding_func(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 127, in wait_func
    result = await func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/utils.py", line 66, in __call__
    return await self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/lightrag/llm.py", line 1143, in ollama_embedding
    data = ollama_client.embeddings(model=embed_model, prompt=text)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 379, in embeddings
    return self._request(
           ^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 177, in _request
    return cls(**self._request_raw(*args, **kwargs).json())
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/ollama/_client.py", line 118, in _request_raw
    r = self._client.request(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 837, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 926, in send
    response = self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 954, in _send_handling_auth
    response = self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 991, in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_client.py", line 1027, in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 235, in handle_request
    with map_httpcore_exceptions():
  File "/opt/conda/lib/python3.11/contextlib.py", line 158, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/conda/lib/python3.11/site-packages/httpx/_transports/default.py", line 89, in map_httpcore_exceptions
    raise mapped_exc(message) from exc
httpx.ConnectError: [Errno 111] Connection refused

2025-01-12 18:26:48,984 - lightrag - INFO - Writing graph with 0 nodes, 0 edges
2025-01-12 18:26:48,989 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-12 18:28:13,135 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 18:28:13,136 - lightrag - INFO - Load KV llm_response_cache with 1 data
2025-01-12 18:28:13,136 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 18:28:13,136 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 18:28:13,137 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 0 nodes, 0 edges
2025-01-12 18:28:13,138 - lightrag - INFO - Loaded document status storage with 18 records
2025-01-12 18:28:13,139 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 18:28:13,400 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 18:30:16,214 - lightrag - INFO - Inserting entities into storage...
2025-01-12 18:30:16,222 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 18:30:16,224 - lightrag - INFO - Inserting 43 vectors to entities
2025-01-12 18:30:16,551 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-12 18:30:16,713 - lightrag - INFO - Writing graph with 45 nodes, 20 edges
2025-01-12 18:30:16,718 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:31:31,094 - lightrag - INFO - Inserting entities into storage...
2025-01-12 18:31:31,096 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 18:31:31,097 - lightrag - INFO - Inserting 23 vectors to entities
2025-01-12 18:31:31,296 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 18:31:31,405 - lightrag - INFO - Writing graph with 57 nodes, 33 edges
2025-01-12 18:31:31,409 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 18:31:31,494 - lightrag - INFO - Inserting entities into storage...
2025-01-12 18:31:31,494 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 18:31:31,494 - lightrag - WARNING - Didn't extract any entities and relationships, maybe your LLM is not working
2025-01-12 18:31:31,495 - lightrag - ERROR - Failed to process document doc-b74307e8e8b40931509bd7b72e08662b: Failed to extract entities and relationships
Traceback (most recent call last):
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 443, in ainsert
    raise e
  File "/opt/conda/lib/python3.11/site-packages/lightrag/lightrag.py", line 412, in ainsert
    raise Exception(
Exception: Failed to extract entities and relationships

2025-01-12 18:31:31,502 - lightrag - INFO - Writing graph with 57 nodes, 33 edges
2025-01-12 18:31:31,506 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:34:48,444 - lightrag - INFO - Inserting entities into storage...
2025-01-12 18:34:48,447 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 18:34:48,448 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 18:34:48,729 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-12 18:34:48,961 - lightrag - INFO - Writing graph with 76 nodes, 62 edges
2025-01-12 18:34:48,966 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:38:06,608 - lightrag - INFO - Inserting entities into storage...
2025-01-12 18:38:06,611 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 18:38:06,613 - lightrag - INFO - Inserting 52 vectors to entities
2025-01-12 18:38:07,057 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-12 18:38:07,340 - lightrag - INFO - Writing graph with 108 nodes, 92 edges
2025-01-12 18:38:07,347 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 18:39:09,525 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 18:39:09,525 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 18:39:09,525 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 18:39:09,525 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 18:39:09,526 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 18:39:09,527 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 18:39:09,786 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 18:41:29,177 - lightrag - INFO - Inserting entities into storage...
2025-01-12 18:41:29,184 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 18:41:29,186 - lightrag - INFO - Inserting 50 vectors to entities
2025-01-12 18:41:29,600 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-12 18:41:29,786 - lightrag - INFO - Writing graph with 58 nodes, 25 edges
2025-01-12 18:41:29,791 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 18:45:30,404 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc_index
2025-01-12 18:45:30,404 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 18:45:30,404 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 18:45:30,404 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 18:45:30,405 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 18:45:30,405 - lightrag - INFO - Processing 1 new unique documents
2025-01-12 18:45:30,659 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 18:47:27,621 - lightrag - INFO - Inserting entities into storage...
2025-01-12 18:47:27,628 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 18:47:27,629 - lightrag - INFO - Inserting 53 vectors to entities
2025-01-12 18:47:28,061 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-12 18:47:28,232 - lightrag - INFO - Writing graph with 58 nodes, 22 edges
2025-01-12 18:47:28,236 - lightrag - INFO - Processing 1 new unique documents
2025-01-12 18:47:28,239 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 18:50:14,639 - lightrag - INFO - Inserting entities into storage...
2025-01-12 18:50:14,642 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 18:50:14,643 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 18:50:14,924 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-12 18:50:15,119 - lightrag - INFO - Writing graph with 77 nodes, 49 edges
2025-01-12 18:50:22,612 - lightrag - INFO - kw_prompt result:
2025-01-12 18:50:22,660 - lightrag - INFO - Local query uses 60 entites, 47 relations, 4 text units
2025-01-12 18:50:22,733 - lightrag - INFO - Global query uses 57 entites, 49 relations, 3 text units
2025-01-12 19:14:27,345 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc_index
2025-01-12 19:14:27,347 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-12 19:14:27,347 - lightrag - INFO - Load KV full_docs with 2 data
2025-01-12 19:14:27,347 - lightrag - INFO - Load KV text_chunks with 8 data
2025-01-12 19:14:27,350 - lightrag - INFO - Loaded graph from ./contemi_opensrc_index/graph_chunk_entity_relation.graphml with 77 nodes, 49 edges
2025-01-12 19:14:27,352 - lightrag - INFO - Loaded document status storage with 2 records
2025-01-12 19:14:27,353 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 19:14:27,353 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-12 19:14:35,165 - lightrag - INFO - kw_prompt result:
2025-01-12 19:14:36,772 - lightrag - INFO - Local query uses 60 entites, 46 relations, 4 text units
2025-01-12 19:14:36,814 - lightrag - INFO - Global query uses 57 entites, 49 relations, 3 text units
2025-01-12 19:21:13,016 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-12 19:21:13,017 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-12 19:21:13,017 - lightrag - INFO - Load KV full_docs with 0 data
2025-01-12 19:21:13,017 - lightrag - INFO - Load KV text_chunks with 0 data
2025-01-12 19:21:13,017 - lightrag - INFO - Loaded document status storage with 0 records
2025-01-12 19:21:13,018 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 19:21:13,301 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:22:05,296 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:22:05,297 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:22:05,298 - lightrag - INFO - Inserting 13 vectors to entities
2025-01-12 19:22:05,431 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-12 19:22:05,509 - lightrag - INFO - Writing graph with 13 nodes, 8 edges
2025-01-12 19:22:05,512 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:23:01,639 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:23:01,641 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:23:01,642 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-12 19:23:01,951 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 19:23:02,074 - lightrag - INFO - Writing graph with 45 nodes, 23 edges
2025-01-12 19:23:02,078 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:24:00,241 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:24:00,243 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:24:00,244 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-12 19:24:00,570 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-12 19:24:00,665 - lightrag - INFO - Writing graph with 64 nodes, 33 edges
2025-01-12 19:24:00,671 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:26:46,903 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:26:46,906 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:26:46,907 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-12 19:26:47,251 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-12 19:26:47,426 - lightrag - INFO - Writing graph with 86 nodes, 51 edges
2025-01-12 19:26:47,432 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 19:29:45,361 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:29:45,372 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:29:45,374 - lightrag - INFO - Inserting 66 vectors to entities
2025-01-12 19:29:45,885 - lightrag - INFO - Inserting 33 vectors to relationships
2025-01-12 19:29:46,143 - lightrag - INFO - Writing graph with 148 nodes, 84 edges
2025-01-12 19:29:46,149 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:31:04,064 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:31:04,067 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:31:04,068 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 19:31:04,364 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 19:31:04,486 - lightrag - INFO - Writing graph with 154 nodes, 93 edges
2025-01-12 19:31:04,499 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 19:32:34,389 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:32:34,391 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:32:34,392 - lightrag - INFO - Inserting 25 vectors to entities
2025-01-12 19:32:34,603 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 19:32:34,736 - lightrag - INFO - Writing graph with 167 nodes, 104 edges
2025-01-12 19:32:34,745 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:33:56,744 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:33:56,745 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:33:56,746 - lightrag - INFO - Inserting 8 vectors to entities
2025-01-12 19:33:56,832 - lightrag - INFO - Inserting 4 vectors to relationships
2025-01-12 19:33:56,898 - lightrag - INFO - Writing graph with 169 nodes, 107 edges
2025-01-12 19:33:56,909 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 19:37:38,079 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:37:38,080 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:37:38,081 - lightrag - INFO - Inserting 17 vectors to entities
2025-01-12 19:37:38,244 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 19:37:38,386 - lightrag - INFO - Writing graph with 180 nodes, 120 edges
2025-01-12 19:37:38,395 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:39:25,727 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:39:25,731 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:39:25,733 - lightrag - INFO - Inserting 43 vectors to entities
2025-01-12 19:39:26,102 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-12 19:39:26,270 - lightrag - INFO - Writing graph with 189 nodes, 132 edges
2025-01-12 19:39:26,278 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 19:39:26,281 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 19:41:27,426 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:41:27,432 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:41:27,433 - lightrag - INFO - Inserting 49 vectors to entities
2025-01-12 19:41:27,824 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-12 19:41:28,006 - lightrag - INFO - Writing graph with 216 nodes, 150 edges
2025-01-12 19:41:28,017 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:42:39,929 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:42:39,933 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:42:39,934 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-12 19:42:40,173 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-12 19:42:40,275 - lightrag - INFO - Writing graph with 223 nodes, 154 edges
2025-01-12 19:42:40,286 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 19:45:58,625 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:45:58,640 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:45:58,642 - lightrag - INFO - Inserting 65 vectors to entities
2025-01-12 19:45:59,184 - lightrag - INFO - Inserting 30 vectors to relationships
2025-01-12 19:45:59,421 - lightrag - INFO - Writing graph with 273 nodes, 183 edges
2025-01-12 19:45:59,433 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:47:23,057 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:47:23,063 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:47:23,064 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 19:47:23,390 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 19:47:23,516 - lightrag - INFO - Writing graph with 283 nodes, 191 edges
2025-01-12 19:47:23,528 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:49:12,816 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:49:12,822 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:49:12,823 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-12 19:49:13,196 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-12 19:49:13,366 - lightrag - INFO - Writing graph with 296 nodes, 203 edges
2025-01-12 19:49:13,382 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 19:52:22,726 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:52:22,737 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:52:22,739 - lightrag - INFO - Inserting 59 vectors to entities
2025-01-12 19:52:23,231 - lightrag - INFO - Inserting 40 vectors to relationships
2025-01-12 19:52:23,579 - lightrag - INFO - Writing graph with 346 nodes, 242 edges
2025-01-12 19:52:23,595 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 19:54:58,931 - lightrag - INFO - Inserting entities into storage...
2025-01-12 19:54:58,938 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 19:54:58,939 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 19:54:59,279 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 19:54:59,425 - lightrag - INFO - Writing graph with 350 nodes, 251 edges
2025-01-12 19:54:59,442 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-12 20:00:30,544 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:00:30,559 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:00:30,560 - lightrag - INFO - Inserting 139 vectors to entities
2025-01-12 20:00:33,009 - lightrag - INFO - Inserting 26 vectors to relationships
2025-01-12 20:00:33,257 - lightrag - INFO - Writing graph with 463 nodes, 274 edges
2025-01-12 20:00:33,277 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:02:06,700 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:02:06,705 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:02:06,707 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-12 20:02:07,021 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 20:02:07,192 - lightrag - INFO - Writing graph with 469 nodes, 282 edges
2025-01-12 20:02:07,207 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:03:47,232 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:03:55,413 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:03:55,415 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-12 20:03:55,870 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 20:03:56,043 - lightrag - INFO - Writing graph with 482 nodes, 294 edges
2025-01-12 20:03:56,059 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 20:03:56,062 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 20:06:07,237 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:06:07,246 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:06:07,248 - lightrag - INFO - Inserting 54 vectors to entities
2025-01-12 20:06:07,757 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-12 20:06:07,967 - lightrag - INFO - Writing graph with 496 nodes, 312 edges
2025-01-12 20:06:07,986 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 20:09:05,630 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:09:16,548 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:09:16,550 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 20:09:16,883 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-12 20:09:17,119 - lightrag - INFO - Writing graph with 513 nodes, 332 edges
2025-01-12 20:09:17,138 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:10:45,598 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:10:45,603 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:10:45,603 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-12 20:10:45,882 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-12 20:10:46,019 - lightrag - INFO - Writing graph with 523 nodes, 340 edges
2025-01-12 20:10:46,037 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 20:13:10,058 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:13:10,067 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:13:10,069 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-12 20:13:10,443 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 20:13:10,596 - lightrag - INFO - Writing graph with 532 nodes, 343 edges
2025-01-12 20:13:10,614 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:15:56,274 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:16:02,550 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:16:02,552 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-12 20:16:02,977 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 20:16:03,178 - lightrag - INFO - Writing graph with 537 nodes, 353 edges
2025-01-12 20:16:03,197 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 20:18:52,026 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:19:09,714 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:19:09,716 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-12 20:19:10,011 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 20:19:10,182 - lightrag - INFO - Writing graph with 542 nodes, 362 edges
2025-01-12 20:19:10,201 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 20:21:11,383 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:21:19,210 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:21:19,211 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-12 20:21:19,656 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 20:21:19,825 - lightrag - INFO - Writing graph with 562 nodes, 367 edges
2025-01-12 20:21:19,844 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 20:24:05,620 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:24:05,628 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:24:05,630 - lightrag - INFO - Inserting 58 vectors to entities
2025-01-12 20:24:06,199 - lightrag - INFO - Inserting 24 vectors to relationships
2025-01-12 20:24:06,435 - lightrag - INFO - Writing graph with 582 nodes, 383 edges
2025-01-12 20:24:06,461 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:25:54,878 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:25:54,882 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:25:54,882 - lightrag - INFO - Inserting 24 vectors to entities
2025-01-12 20:25:55,111 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-12 20:25:55,223 - lightrag - INFO - Writing graph with 585 nodes, 385 edges
2025-01-12 20:25:55,241 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:28:36,861 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:28:36,871 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:28:36,873 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-12 20:28:37,325 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-12 20:28:37,541 - lightrag - INFO - Writing graph with 601 nodes, 400 edges
2025-01-12 20:28:37,558 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 20:28:37,561 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 20:31:38,566 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:31:38,574 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:31:38,575 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-12 20:31:39,013 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-12 20:31:39,231 - lightrag - INFO - Writing graph with 614 nodes, 411 edges
2025-01-12 20:31:39,249 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:33:01,694 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:33:15,560 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:33:15,561 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-12 20:33:15,993 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 20:33:16,190 - lightrag - INFO - Writing graph with 620 nodes, 421 edges
2025-01-12 20:33:16,211 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-12 20:36:34,017 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:36:43,783 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:36:43,785 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-12 20:36:44,139 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-12 20:36:44,408 - lightrag - INFO - Writing graph with 648 nodes, 446 edges
2025-01-12 20:36:44,426 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:38:30,756 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:38:39,339 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:38:39,341 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-12 20:38:39,715 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 20:38:39,927 - lightrag - INFO - Writing graph with 660 nodes, 456 edges
2025-01-12 20:38:39,946 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:40:05,615 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:40:31,081 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:40:31,082 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-12 20:40:31,428 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-12 20:40:31,628 - lightrag - INFO - Writing graph with 667 nodes, 469 edges
2025-01-12 20:40:31,649 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:41:48,547 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:42:03,553 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:42:03,554 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-12 20:42:03,875 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-12 20:42:04,045 - lightrag - INFO - Writing graph with 671 nodes, 478 edges
2025-01-12 20:42:04,065 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:45:00,824 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:45:00,830 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:45:00,832 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-12 20:45:01,252 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-12 20:45:01,440 - lightrag - INFO - Writing graph with 688 nodes, 488 edges
2025-01-12 20:45:01,461 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 20:48:02,939 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:48:02,942 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:48:02,943 - lightrag - INFO - Inserting 22 vectors to entities
2025-01-12 20:48:03,162 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-12 20:48:03,338 - lightrag - INFO - Writing graph with 701 nodes, 497 edges
2025-01-12 20:48:03,358 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 20:49:39,160 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:49:57,211 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:49:57,211 - lightrag - INFO - Inserting 27 vectors to entities
2025-01-12 20:49:57,535 - lightrag - INFO - Inserting 4 vectors to relationships
2025-01-12 20:49:57,671 - lightrag - INFO - Writing graph with 703 nodes, 501 edges
2025-01-12 20:49:57,697 - lightrag - INFO - Inserting 5 vectors to chunks
2025-01-12 20:58:49,267 - lightrag - INFO - Inserting entities into storage...
2025-01-12 20:58:49,291 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 20:58:49,293 - lightrag - INFO - Inserting 299 vectors to entities
2025-01-12 20:58:53,052 - lightrag - INFO - Inserting 35 vectors to relationships
2025-01-12 20:58:53,410 - lightrag - INFO - Writing graph with 868 nodes, 529 edges
2025-01-12 20:58:53,432 - lightrag - INFO - Processing 10 new unique documents
2025-01-12 20:58:53,435 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 21:00:26,403 - lightrag - INFO - Inserting entities into storage...
2025-01-12 21:00:42,667 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 21:00:42,670 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-12 21:00:43,110 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 21:00:43,329 - lightrag - INFO - Writing graph with 875 nodes, 532 edges
2025-01-12 21:00:43,352 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 21:03:08,811 - lightrag - INFO - Inserting entities into storage...
2025-01-12 21:03:31,724 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 21:03:31,725 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-12 21:03:32,157 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-12 21:03:32,348 - lightrag - INFO - Writing graph with 899 nodes, 545 edges
2025-01-12 21:03:32,372 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 21:05:42,952 - lightrag - INFO - Inserting entities into storage...
2025-01-12 21:05:42,967 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 21:05:42,969 - lightrag - INFO - Inserting 47 vectors to entities
2025-01-12 21:05:43,444 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-12 21:05:43,718 - lightrag - INFO - Writing graph with 911 nodes, 561 edges
2025-01-12 21:05:43,742 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 21:07:29,734 - lightrag - INFO - Inserting entities into storage...
2025-01-12 21:07:41,289 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 21:07:41,291 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-12 21:07:41,790 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-12 21:07:42,021 - lightrag - INFO - Writing graph with 913 nodes, 568 edges
2025-01-12 21:07:42,046 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 21:10:43,379 - lightrag - INFO - Inserting entities into storage...
2025-01-12 21:10:43,385 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 21:10:43,386 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-12 21:10:43,757 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-12 21:10:43,931 - lightrag - INFO - Writing graph with 922 nodes, 571 edges
2025-01-12 21:10:43,956 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 21:13:57,928 - lightrag - INFO - Inserting entities into storage...
2025-01-12 21:13:57,947 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 21:13:57,949 - lightrag - INFO - Inserting 79 vectors to entities
2025-01-12 21:13:58,703 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-12 21:13:58,978 - lightrag - INFO - Writing graph with 952 nodes, 577 edges
2025-01-12 21:13:59,003 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-12 21:15:55,734 - lightrag - INFO - Inserting entities into storage...
2025-01-12 21:15:55,737 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 21:15:55,738 - lightrag - INFO - Inserting 17 vectors to entities
2025-01-12 21:15:55,939 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-12 21:15:56,099 - lightrag - INFO - Writing graph with 953 nodes, 579 edges
2025-01-12 21:15:56,125 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-12 21:18:19,006 - lightrag - INFO - Inserting entities into storage...
2025-01-12 21:18:29,891 - lightrag - INFO - Inserting relationships into storage...
2025-01-12 21:18:29,894 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-13 05:14:31,047 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-13 05:14:31,364 - lightrag - INFO - Writing graph with 963 nodes, 593 edges
2025-01-13 05:14:31,392 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 05:15:41,573 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:15:46,327 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:15:46,328 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-13 05:15:46,840 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-13 05:15:47,010 - lightrag - INFO - Writing graph with 976 nodes, 594 edges
2025-01-13 05:15:47,037 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-13 05:18:32,226 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:18:32,230 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:18:32,231 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-13 05:18:32,489 - lightrag - INFO - Inserting 3 vectors to relationships
2025-01-13 05:18:32,640 - lightrag - INFO - Writing graph with 980 nodes, 595 edges
2025-01-13 05:18:32,666 - lightrag - INFO - Processing 10 new unique documents
2025-01-13 05:18:32,669 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 05:19:47,753 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:19:52,294 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:19:52,296 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-13 05:19:52,773 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-13 05:19:52,994 - lightrag - INFO - Writing graph with 983 nodes, 600 edges
2025-01-13 05:19:53,021 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-13 05:21:38,829 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:22:10,922 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:22:10,924 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-13 05:22:11,409 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-13 05:22:11,648 - lightrag - INFO - Writing graph with 994 nodes, 611 edges
2025-01-13 05:22:11,676 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-13 05:24:34,509 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:24:50,175 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:24:50,177 - lightrag - INFO - Inserting 44 vectors to entities
2025-01-13 05:24:50,669 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-13 05:24:51,000 - lightrag - INFO - Writing graph with 1012 nodes, 631 edges
2025-01-13 05:24:51,028 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-13 05:26:33,359 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:26:52,614 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:26:52,616 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-13 05:26:53,000 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-13 05:26:53,193 - lightrag - INFO - Writing graph with 1022 nodes, 635 edges
2025-01-13 05:26:53,220 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 05:28:39,662 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:28:46,312 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:28:46,314 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-13 05:28:46,774 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 05:28:47,027 - lightrag - INFO - Writing graph with 1025 nodes, 639 edges
2025-01-13 05:28:47,063 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-13 05:31:55,027 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:32:31,672 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:32:31,675 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-13 05:32:32,242 - lightrag - INFO - Inserting 27 vectors to relationships
2025-01-13 05:32:32,595 - lightrag - INFO - Writing graph with 1037 nodes, 652 edges
2025-01-13 05:32:32,624 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-13 05:35:07,454 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:35:55,334 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:35:55,337 - lightrag - INFO - Inserting 55 vectors to entities
2025-01-13 05:35:55,926 - lightrag - INFO - Inserting 25 vectors to relationships
2025-01-13 05:35:56,243 - lightrag - INFO - Writing graph with 1049 nodes, 667 edges
2025-01-13 05:35:56,272 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 05:37:34,132 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:37:52,972 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:37:52,974 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-13 05:37:53,333 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 05:37:53,566 - lightrag - INFO - Writing graph with 1049 nodes, 678 edges
2025-01-13 05:37:53,596 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-13 05:40:56,239 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:41:39,512 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:41:39,514 - lightrag - INFO - Inserting 44 vectors to entities
2025-01-13 05:41:40,070 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-13 05:41:40,378 - lightrag - INFO - Writing graph with 1054 nodes, 684 edges
2025-01-13 05:41:40,408 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-13 05:44:35,903 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:44:49,662 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:44:49,666 - lightrag - INFO - Inserting 51 vectors to entities
2025-01-13 05:44:50,253 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-13 05:44:50,596 - lightrag - INFO - Writing graph with 1066 nodes, 692 edges
2025-01-13 05:44:50,624 - lightrag - INFO - Processing 10 new unique documents
2025-01-13 05:44:50,628 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-13 05:47:49,413 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:48:27,294 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:48:27,296 - lightrag - INFO - Inserting 21 vectors to entities
2025-01-13 05:48:27,484 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-13 05:48:27,698 - lightrag - INFO - Writing graph with 1075 nodes, 698 edges
2025-01-13 05:48:27,727 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-13 05:51:05,356 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:51:31,044 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:51:31,047 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-13 05:51:31,585 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-13 05:51:31,933 - lightrag - INFO - Writing graph with 1088 nodes, 712 edges
2025-01-13 05:51:31,963 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-13 05:55:26,108 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:56:10,899 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:56:10,902 - lightrag - INFO - Inserting 57 vectors to entities
2025-01-13 05:56:11,509 - lightrag - INFO - Inserting 31 vectors to relationships
2025-01-13 05:56:11,892 - lightrag - INFO - Writing graph with 1106 nodes, 735 edges
2025-01-13 05:56:11,924 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 05:57:58,604 - lightrag - INFO - Inserting entities into storage...
2025-01-13 05:58:12,856 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 05:58:12,858 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-13 05:58:13,416 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-13 05:58:13,704 - lightrag - INFO - Writing graph with 1113 nodes, 744 edges
2025-01-13 05:58:13,735 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-13 06:01:09,046 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:01:09,052 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:01:09,053 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-13 06:01:09,354 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-13 06:01:09,580 - lightrag - INFO - Writing graph with 1120 nodes, 754 edges
2025-01-13 06:01:09,611 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-13 06:03:34,919 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:03:54,994 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:03:54,996 - lightrag - INFO - Inserting 51 vectors to entities
2025-01-13 06:03:55,561 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-13 06:03:55,865 - lightrag - INFO - Writing graph with 1130 nodes, 766 edges
2025-01-13 06:03:55,898 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-13 06:08:08,658 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:08:34,274 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:08:34,277 - lightrag - INFO - Inserting 54 vectors to entities
2025-01-13 06:08:34,844 - lightrag - INFO - Inserting 28 vectors to relationships
2025-01-13 06:08:35,206 - lightrag - INFO - Writing graph with 1159 nodes, 786 edges
2025-01-13 06:08:35,237 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:10:22,770 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:10:46,228 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:10:54,087 - lightrag - INFO - Inserting 41 vectors to entities
2025-01-13 06:10:54,630 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-13 06:10:54,896 - lightrag - INFO - Writing graph with 1161 nodes, 792 edges
2025-01-13 06:10:54,929 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:12:38,845 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:13:22,046 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:13:22,047 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-13 06:13:22,508 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-13 06:13:22,768 - lightrag - INFO - Writing graph with 1167 nodes, 797 edges
2025-01-13 06:13:22,800 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:15:17,744 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:15:46,237 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:15:46,239 - lightrag - INFO - Inserting 43 vectors to entities
2025-01-13 06:15:46,705 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-13 06:15:46,970 - lightrag - INFO - Writing graph with 1186 nodes, 804 edges
2025-01-13 06:15:47,000 - lightrag - INFO - Processing 10 new unique documents
2025-01-13 06:15:47,003 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:17:37,147 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:18:07,402 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:18:07,403 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-13 06:18:07,837 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 06:18:08,086 - lightrag - INFO - Writing graph with 1196 nodes, 814 edges
2025-01-13 06:18:08,120 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:20:40,024 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:21:06,900 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:21:06,902 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-13 06:21:07,408 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-13 06:21:07,691 - lightrag - INFO - Writing graph with 1197 nodes, 817 edges
2025-01-13 06:21:07,725 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:22:54,090 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:23:05,691 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:23:05,692 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-13 06:23:06,152 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-13 06:23:06,383 - lightrag - INFO - Writing graph with 1206 nodes, 823 edges
2025-01-13 06:23:06,415 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:25:13,089 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:25:24,894 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:25:24,896 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-13 06:25:25,305 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-13 06:25:25,619 - lightrag - INFO - Writing graph with 1211 nodes, 831 edges
2025-01-13 06:25:25,653 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:27:05,455 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:27:18,200 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:27:18,202 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-13 06:27:18,604 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-13 06:27:18,867 - lightrag - INFO - Writing graph with 1217 nodes, 839 edges
2025-01-13 06:27:18,902 - lightrag - INFO - Inserting 3 vectors to chunks
2025-01-13 06:30:09,222 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:30:30,752 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:30:30,755 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-13 06:30:31,312 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-13 06:30:31,664 - lightrag - INFO - Writing graph with 1222 nodes, 848 edges
2025-01-13 06:30:31,698 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:32:24,065 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:33:04,805 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:33:04,807 - lightrag - INFO - Inserting 47 vectors to entities
2025-01-13 06:33:05,351 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-13 06:33:05,615 - lightrag - INFO - Writing graph with 1227 nodes, 854 edges
2025-01-13 06:33:05,649 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:35:00,523 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:35:11,169 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:35:11,171 - lightrag - INFO - Inserting 33 vectors to entities
2025-01-13 06:35:11,542 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-13 06:35:11,823 - lightrag - INFO - Writing graph with 1232 nodes, 860 edges
2025-01-13 06:35:11,860 - lightrag - INFO - Inserting 4 vectors to chunks
2025-01-13 06:38:32,967 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:38:46,544 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:38:46,546 - lightrag - INFO - Inserting 57 vectors to entities
2025-01-13 06:38:47,089 - lightrag - INFO - Inserting 32 vectors to relationships
2025-01-13 06:38:47,500 - lightrag - INFO - Writing graph with 1252 nodes, 886 edges
2025-01-13 06:38:47,535 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:40:39,607 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:41:27,121 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:41:34,452 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-13 06:41:34,838 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 06:41:35,147 - lightrag - INFO - Writing graph with 1255 nodes, 891 edges
2025-01-13 06:41:35,183 - lightrag - INFO - Processing 10 new unique documents
2025-01-13 06:41:35,186 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:43:17,843 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:43:30,147 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:43:30,148 - lightrag - INFO - Inserting 35 vectors to entities
2025-01-13 06:43:30,503 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-13 06:43:30,763 - lightrag - INFO - Writing graph with 1268 nodes, 900 edges
2025-01-13 06:43:30,797 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:45:17,118 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:45:25,614 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:45:25,616 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-13 06:45:26,090 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-13 06:45:26,419 - lightrag - INFO - Writing graph with 1276 nodes, 908 edges
2025-01-13 06:45:26,454 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:47:10,567 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:47:10,572 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:47:10,574 - lightrag - INFO - Inserting 20 vectors to entities
2025-01-13 06:47:10,823 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-13 06:47:11,070 - lightrag - INFO - Writing graph with 1278 nodes, 911 edges
2025-01-13 06:47:11,106 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:49:32,173 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:49:44,934 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:49:44,937 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-13 06:49:45,397 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-13 06:49:45,737 - lightrag - INFO - Writing graph with 1279 nodes, 912 edges
2025-01-13 06:49:45,775 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:53:13,717 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:53:40,194 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:53:40,196 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-13 06:53:40,819 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-13 06:53:41,116 - lightrag - INFO - Writing graph with 1281 nodes, 916 edges
2025-01-13 06:53:41,153 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:55:28,852 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:55:28,858 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:55:28,859 - lightrag - INFO - Inserting 23 vectors to entities
2025-01-13 06:55:29,135 - lightrag - INFO - Inserting 7 vectors to relationships
2025-01-13 06:55:29,360 - lightrag - INFO - Writing graph with 1283 nodes, 919 edges
2025-01-13 06:55:29,398 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 06:57:27,749 - lightrag - INFO - Inserting entities into storage...
2025-01-13 06:58:20,771 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 06:58:20,773 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-13 06:58:21,104 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 06:58:21,414 - lightrag - INFO - Writing graph with 1290 nodes, 928 edges
2025-01-13 06:58:21,450 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:00:05,499 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:00:36,910 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:00:36,912 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-13 07:00:37,348 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-13 07:00:37,653 - lightrag - INFO - Writing graph with 1295 nodes, 935 edges
2025-01-13 07:00:37,689 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:02:00,543 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:02:17,997 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:02:18,000 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-13 07:02:18,411 - lightrag - INFO - Inserting 5 vectors to relationships
2025-01-13 07:02:18,671 - lightrag - INFO - Writing graph with 1297 nodes, 936 edges
2025-01-13 07:02:18,707 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:04:14,486 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:04:37,354 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:04:37,356 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-13 07:04:37,728 - lightrag - INFO - Inserting 10 vectors to relationships
2025-01-13 07:04:38,010 - lightrag - INFO - Writing graph with 1300 nodes, 938 edges
2025-01-13 07:04:38,048 - lightrag - INFO - Processing 10 new unique documents
2025-01-13 07:04:38,051 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:06:22,023 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:06:43,011 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:06:43,013 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-13 07:06:43,443 - lightrag - INFO - Inserting 15 vectors to relationships
2025-01-13 07:06:43,748 - lightrag - INFO - Writing graph with 1304 nodes, 941 edges
2025-01-13 07:06:43,785 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:09:13,201 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:09:21,251 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:09:21,253 - lightrag - INFO - Inserting 16 vectors to entities
2025-01-13 07:09:21,475 - lightrag - INFO - Inserting 7 vectors to relationships
2025-01-13 07:09:21,729 - lightrag - INFO - Writing graph with 1305 nodes, 943 edges
2025-01-13 07:09:21,766 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:11:09,170 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:11:09,173 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:11:09,174 - lightrag - INFO - Inserting 12 vectors to entities
2025-01-13 07:11:09,333 - lightrag - INFO - Inserting 7 vectors to relationships
2025-01-13 07:11:09,577 - lightrag - INFO - Writing graph with 1307 nodes, 947 edges
2025-01-13 07:11:09,614 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:13:16,567 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:13:57,769 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:13:57,772 - lightrag - INFO - Inserting 46 vectors to entities
2025-01-13 07:13:58,343 - lightrag - INFO - Inserting 22 vectors to relationships
2025-01-13 07:13:58,714 - lightrag - INFO - Writing graph with 1312 nodes, 956 edges
2025-01-13 07:13:58,752 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:16:30,677 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:16:30,682 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:16:30,682 - lightrag - INFO - Inserting 15 vectors to entities
2025-01-13 07:16:30,893 - lightrag - INFO - Inserting 3 vectors to relationships
2025-01-13 07:16:31,110 - lightrag - INFO - Writing graph with 1312 nodes, 957 edges
2025-01-13 07:16:31,149 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:18:13,770 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:18:47,826 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:18:47,829 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-13 07:18:48,294 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-13 07:18:48,612 - lightrag - INFO - Writing graph with 1314 nodes, 964 edges
2025-01-13 07:18:48,649 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:20:31,698 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:21:28,959 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:21:28,960 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-13 07:21:29,465 - lightrag - INFO - Inserting 6 vectors to relationships
2025-01-13 07:21:29,730 - lightrag - INFO - Writing graph with 1317 nodes, 966 edges
2025-01-13 07:21:29,768 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:23:29,269 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:23:39,454 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:23:39,456 - lightrag - INFO - Inserting 39 vectors to entities
2025-01-13 07:23:39,988 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-13 07:23:40,290 - lightrag - INFO - Writing graph with 1320 nodes, 972 edges
2025-01-13 07:23:40,329 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:26:17,863 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:26:17,864 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:26:17,865 - lightrag - INFO - Inserting 4 vectors to entities
2025-01-13 07:26:17,935 - lightrag - INFO - Inserting 3 vectors to relationships
2025-01-13 07:26:18,172 - lightrag - INFO - Writing graph with 1321 nodes, 973 edges
2025-01-13 07:26:18,211 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:28:38,675 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:28:38,689 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:28:38,691 - lightrag - INFO - Inserting 42 vectors to entities
2025-01-13 07:28:39,171 - lightrag - INFO - Inserting 18 vectors to relationships
2025-01-13 07:28:39,483 - lightrag - INFO - Writing graph with 1332 nodes, 985 edges
2025-01-13 07:28:39,519 - lightrag - INFO - Processing 10 new unique documents
2025-01-13 07:28:39,523 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:30:35,384 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:31:18,059 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:31:18,062 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-13 07:31:18,473 - lightrag - INFO - Inserting 20 vectors to relationships
2025-01-13 07:31:18,836 - lightrag - INFO - Writing graph with 1332 nodes, 992 edges
2025-01-13 07:31:18,875 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:33:22,411 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:34:21,889 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:34:21,891 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-13 07:34:22,463 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 07:34:22,775 - lightrag - INFO - Writing graph with 1340 nodes, 999 edges
2025-01-13 07:34:22,813 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:37:42,703 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:37:42,714 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:37:42,718 - lightrag - INFO - Inserting 34 vectors to entities
2025-01-13 07:37:43,201 - lightrag - INFO - Inserting 23 vectors to relationships
2025-01-13 07:37:43,638 - lightrag - INFO - Writing graph with 1342 nodes, 1008 edges
2025-01-13 07:37:43,679 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:39:42,757 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:40:01,164 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:40:01,168 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-13 07:40:01,721 - lightrag - INFO - Inserting 19 vectors to relationships
2025-01-13 07:40:02,119 - lightrag - INFO - Writing graph with 1348 nodes, 1010 edges
2025-01-13 07:40:02,157 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:43:43,147 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:44:13,649 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:44:13,652 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-13 07:44:14,169 - lightrag - INFO - Inserting 21 vectors to relationships
2025-01-13 07:44:14,551 - lightrag - INFO - Writing graph with 1353 nodes, 1018 edges
2025-01-13 07:44:14,590 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:46:48,622 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:47:54,116 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:48:01,920 - lightrag - INFO - Inserting 49 vectors to entities
2025-01-13 07:48:02,533 - lightrag - INFO - Inserting 17 vectors to relationships
2025-01-13 07:48:02,932 - lightrag - INFO - Writing graph with 1353 nodes, 1025 edges
2025-01-13 07:48:02,974 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:50:26,620 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:50:51,157 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:50:51,159 - lightrag - INFO - Inserting 45 vectors to entities
2025-01-13 07:50:51,661 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-13 07:50:51,974 - lightrag - INFO - Writing graph with 1362 nodes, 1033 edges
2025-01-13 07:50:52,013 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:53:39,412 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:54:41,998 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:54:41,999 - lightrag - INFO - Inserting 28 vectors to entities
2025-01-13 07:54:42,284 - lightrag - INFO - Inserting 7 vectors to relationships
2025-01-13 07:54:42,570 - lightrag - INFO - Writing graph with 1365 nodes, 1038 edges
2025-01-13 07:54:42,609 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:56:26,818 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:56:37,940 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:56:37,942 - lightrag - INFO - Inserting 40 vectors to entities
2025-01-13 07:56:38,398 - lightrag - INFO - Inserting 7 vectors to relationships
2025-01-13 07:56:38,693 - lightrag - INFO - Writing graph with 1368 nodes, 1039 edges
2025-01-13 07:56:38,732 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 07:59:10,623 - lightrag - INFO - Inserting entities into storage...
2025-01-13 07:59:28,063 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 07:59:35,379 - lightrag - INFO - Inserting 51 vectors to entities
2025-01-13 07:59:35,967 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-13 07:59:36,314 - lightrag - INFO - Writing graph with 1375 nodes, 1044 edges
2025-01-13 07:59:36,352 - lightrag - INFO - Processing 10 new unique documents
2025-01-13 07:59:36,356 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:02:07,468 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:02:21,871 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:02:21,873 - lightrag - INFO - Inserting 5 vectors to entities
2025-01-13 08:02:21,957 - lightrag - INFO - Inserting 4 vectors to relationships
2025-01-13 08:02:22,208 - lightrag - INFO - Writing graph with 1375 nodes, 1044 edges
2025-01-13 08:02:22,247 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:04:41,013 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:04:46,798 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:04:46,800 - lightrag - INFO - Inserting 12 vectors to entities
2025-01-13 08:04:46,997 - lightrag - INFO - Inserting 7 vectors to relationships
2025-01-13 08:04:47,279 - lightrag - INFO - Writing graph with 1375 nodes, 1044 edges
2025-01-13 08:04:47,318 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:06:34,208 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:06:55,015 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:06:55,018 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-13 08:06:55,467 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 08:06:55,856 - lightrag - INFO - Writing graph with 1377 nodes, 1052 edges
2025-01-13 08:06:55,910 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:08:48,380 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:09:41,770 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:09:47,317 - lightrag - INFO - Inserting 32 vectors to entities
2025-01-13 08:09:47,683 - lightrag - INFO - Inserting 12 vectors to relationships
2025-01-13 08:09:47,980 - lightrag - INFO - Writing graph with 1382 nodes, 1057 edges
2025-01-13 08:09:48,022 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:12:27,655 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:13:05,422 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:13:05,425 - lightrag - INFO - Inserting 59 vectors to entities
2025-01-13 08:13:06,058 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 08:13:06,405 - lightrag - INFO - Writing graph with 1384 nodes, 1064 edges
2025-01-13 08:13:06,446 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:14:48,634 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:15:20,895 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:15:20,897 - lightrag - INFO - Inserting 30 vectors to entities
2025-01-13 08:15:21,225 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 08:15:21,537 - lightrag - INFO - Writing graph with 1388 nodes, 1068 edges
2025-01-13 08:15:21,578 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:17:27,726 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:17:39,038 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:17:39,040 - lightrag - INFO - Inserting 48 vectors to entities
2025-01-13 08:17:39,594 - lightrag - INFO - Inserting 14 vectors to relationships
2025-01-13 08:17:39,918 - lightrag - INFO - Writing graph with 1401 nodes, 1077 edges
2025-01-13 08:17:39,959 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:19:41,993 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:20:48,307 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:20:48,310 - lightrag - INFO - Inserting 38 vectors to entities
2025-01-13 08:20:48,823 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-13 08:20:49,249 - lightrag - INFO - Writing graph with 1402 nodes, 1079 edges
2025-01-13 08:20:49,292 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:23:15,288 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:23:24,795 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:23:24,797 - lightrag - INFO - Inserting 15 vectors to entities
2025-01-13 08:23:25,011 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-13 08:23:25,300 - lightrag - INFO - Writing graph with 1404 nodes, 1081 edges
2025-01-13 08:23:25,342 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:25:39,062 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:25:39,065 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:25:48,366 - lightrag - INFO - Inserting 12 vectors to entities
2025-01-13 08:25:48,539 - lightrag - INFO - Inserting 8 vectors to relationships
2025-01-13 08:25:48,820 - lightrag - INFO - Writing graph with 1405 nodes, 1088 edges
2025-01-13 08:25:48,860 - lightrag - INFO - Processing 5 new unique documents
2025-01-13 08:25:48,863 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:28:10,404 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:28:26,296 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:28:35,248 - lightrag - INFO - Inserting 29 vectors to entities
2025-01-13 08:28:35,650 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-13 08:28:35,980 - lightrag - INFO - Writing graph with 1405 nodes, 1088 edges
2025-01-13 08:28:36,022 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:30:23,378 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:30:23,387 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:30:23,389 - lightrag - INFO - Inserting 31 vectors to entities
2025-01-13 08:30:23,808 - lightrag - INFO - Inserting 16 vectors to relationships
2025-01-13 08:30:24,186 - lightrag - INFO - Writing graph with 1409 nodes, 1095 edges
2025-01-13 08:30:24,228 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:32:27,816 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:32:39,099 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:32:39,101 - lightrag - INFO - Inserting 36 vectors to entities
2025-01-13 08:32:39,500 - lightrag - INFO - Inserting 11 vectors to relationships
2025-01-13 08:32:39,831 - lightrag - INFO - Writing graph with 1409 nodes, 1096 edges
2025-01-13 08:32:39,872 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:34:43,556 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:34:43,558 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:34:43,560 - lightrag - INFO - Inserting 12 vectors to entities
2025-01-13 08:34:43,702 - lightrag - INFO - Inserting 9 vectors to relationships
2025-01-13 08:34:44,009 - lightrag - INFO - Writing graph with 1412 nodes, 1101 edges
2025-01-13 08:34:44,053 - lightrag - INFO - Inserting 2 vectors to chunks
2025-01-13 08:36:31,759 - lightrag - INFO - Inserting entities into storage...
2025-01-13 08:37:25,314 - lightrag - INFO - Inserting relationships into storage...
2025-01-13 08:37:25,317 - lightrag - INFO - Inserting 37 vectors to entities
2025-01-13 08:37:25,842 - lightrag - INFO - Inserting 13 vectors to relationships
2025-01-13 08:37:26,209 - lightrag - INFO - Writing graph with 1413 nodes, 1105 edges
2025-01-13 08:37:41,627 - lightrag - INFO - kw_prompt result:
2025-01-13 08:37:41,628 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:37:41,697 - lightrag - INFO - Local query uses 60 entites, 40 relations, 3 text units
2025-01-13 08:37:41,759 - lightrag - INFO - Global query uses 16 entites, 60 relations, 4 text units
2025-01-13 08:41:16,229 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-13 08:41:16,292 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 08:41:16,297 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 08:41:16,301 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 08:41:16,336 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-13 08:41:16,379 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 08:41:16,380 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,382 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,382 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,383 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,383 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,384 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,384 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,385 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,385 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,386 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,386 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,387 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:16,387 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:41:18,784 - lightrag - INFO - kw_prompt result:
2025-01-13 08:41:18,784 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:41:19,134 - lightrag - INFO - Local query uses 60 entites, 40 relations, 3 text units
2025-01-13 08:41:19,182 - lightrag - INFO - Global query uses 17 entites, 60 relations, 4 text units
2025-01-13 08:51:26,519 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-13 08:51:26,583 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 08:51:26,589 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 08:51:26,595 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 08:51:26,636 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-13 08:51:26,727 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 08:51:43,309 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-13 08:51:43,372 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 08:51:43,377 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 08:51:43,382 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 08:51:43,417 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-13 08:51:43,500 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 08:51:43,500 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-13 08:51:43,547 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 08:51:43,550 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 08:51:43,553 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 08:51:43,587 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-13 08:51:43,621 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 08:55:10,219 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-13 08:55:10,281 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 08:55:10,286 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 08:55:10,291 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 08:55:10,325 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-13 08:55:10,407 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 08:55:10,408 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-13 08:55:10,455 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 08:55:10,458 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 08:55:10,461 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 08:55:10,494 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-13 08:55:10,529 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 08:55:14,149 - lightrag - INFO - kw_prompt result:
2025-01-13 08:55:14,150 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:55:15,147 - lightrag - INFO - Local query uses 100 entites, 108 relations, 5 text units
2025-01-13 08:55:15,946 - lightrag - INFO - Global query uses 17 entites, 45 relations, 6 text units
2025-01-13 08:55:29,340 - lightrag - INFO - kw_prompt result:
2025-01-13 08:55:29,340 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:55:30,289 - lightrag - INFO - Local query uses 100 entites, 25 relations, 6 text units
2025-01-13 08:55:31,149 - lightrag - INFO - Global query uses 17 entites, 55 relations, 6 text units
2025-01-13 08:55:36,033 - lightrag - INFO - kw_prompt result:
2025-01-13 08:55:36,033 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 08:56:10,421 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-13 08:56:10,485 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 08:56:10,490 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 08:56:10,494 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 08:56:10,528 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-13 08:56:10,610 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 08:56:10,610 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-13 08:56:10,658 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 08:56:10,661 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 08:56:10,664 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 08:56:10,698 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-13 08:56:10,731 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 08:56:22,440 - lightrag - INFO - kw_prompt result:
2025-01-13 08:56:22,440 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:56:23,920 - lightrag - INFO - Local query uses 100 entites, 35 relations, 5 text units
2025-01-13 08:56:24,658 - lightrag - INFO - Global query uses 18 entites, 30 relations, 6 text units
2025-01-13 08:56:28,448 - lightrag - INFO - kw_prompt result:
2025-01-13 08:56:28,448 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:56:29,832 - lightrag - INFO - Local query uses 100 entites, 170 relations, 5 text units
2025-01-13 08:56:29,916 - lightrag - INFO - Global query uses 20 entites, 100 relations, 6 text units
2025-01-13 08:56:39,079 - lightrag - INFO - kw_prompt result:
2025-01-13 08:56:39,080 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:56:39,811 - lightrag - INFO - Local query uses 100 entites, 25 relations, 6 text units
2025-01-13 08:56:40,373 - lightrag - INFO - Global query uses 18 entites, 58 relations, 6 text units
2025-01-13 08:56:45,373 - lightrag - INFO - kw_prompt result:
2025-01-13 08:56:45,373 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 08:57:53,221 - lightrag - INFO - kw_prompt result:
2025-01-13 08:57:53,221 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:57:53,288 - lightrag - INFO - Local query uses 100 entites, 102 relations, 6 text units
2025-01-13 08:57:53,355 - lightrag - INFO - Global query uses 28 entites, 100 relations, 7 text units
2025-01-13 08:58:01,810 - lightrag - INFO - kw_prompt result:
2025-01-13 08:58:01,810 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:58:01,885 - lightrag - INFO - Local query uses 100 entites, 124 relations, 7 text units
2025-01-13 08:58:01,967 - lightrag - INFO - Global query uses 29 entites, 100 relations, 6 text units
2025-01-13 08:58:04,147 - lightrag - INFO - kw_prompt result:
2025-01-13 08:58:04,147 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:58:04,272 - lightrag - INFO - Local query uses 100 entites, 124 relations, 6 text units
2025-01-13 08:58:04,364 - lightrag - INFO - Global query uses 25 entites, 100 relations, 7 text units
2025-01-13 08:58:07,075 - lightrag - INFO - kw_prompt result:
2025-01-13 08:58:07,075 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:58:07,139 - lightrag - INFO - Local query uses 100 entites, 70 relations, 6 text units
2025-01-13 08:58:07,242 - lightrag - INFO - Global query uses 27 entites, 100 relations, 6 text units
2025-01-13 08:58:11,636 - lightrag - INFO - kw_prompt result:
2025-01-13 08:58:11,636 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:58:11,699 - lightrag - INFO - Local query uses 100 entites, 124 relations, 6 text units
2025-01-13 08:58:11,774 - lightrag - INFO - Global query uses 31 entites, 100 relations, 6 text units
2025-01-13 08:58:22,310 - lightrag - INFO - kw_prompt result:
2025-01-13 08:58:22,311 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:58:22,386 - lightrag - INFO - Local query uses 100 entites, 124 relations, 6 text units
2025-01-13 08:58:22,456 - lightrag - INFO - Global query uses 29 entites, 100 relations, 6 text units
2025-01-13 08:58:29,681 - lightrag - INFO - kw_prompt result:
2025-01-13 08:58:29,681 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:58:29,747 - lightrag - INFO - Local query uses 100 entites, 95 relations, 5 text units
2025-01-13 08:58:29,867 - lightrag - INFO - Global query uses 25 entites, 100 relations, 7 text units
2025-01-13 08:58:35,837 - lightrag - INFO - kw_prompt result:
2025-01-13 08:58:35,837 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 08:59:28,002 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-13 08:59:28,068 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 08:59:28,074 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 08:59:28,079 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 08:59:28,116 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-13 08:59:28,162 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 08:59:28,163 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,164 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,165 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,165 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,166 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,166 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,167 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,167 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,168 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,168 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,169 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,169 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:28,170 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 08:59:30,449 - lightrag - INFO - kw_prompt result:
2025-01-13 08:59:30,450 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 08:59:30,782 - lightrag - INFO - Local query uses 60 entites, 40 relations, 5 text units
2025-01-13 08:59:30,828 - lightrag - INFO - Global query uses 15 entites, 60 relations, 4 text units
2025-01-13 09:00:58,976 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-13 09:00:59,039 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 09:00:59,044 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 09:00:59,049 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 09:00:59,084 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-13 09:00:59,128 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 09:00:59,129 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,130 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,130 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,131 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,131 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,132 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,132 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,133 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,133 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,134 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,134 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,135 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:00:59,135 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:52,986 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-13 09:02:53,058 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 09:02:53,063 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 09:02:53,068 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 09:02:53,104 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-13 09:02:53,149 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 09:02:53,150 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,150 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,151 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,152 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,152 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,153 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,153 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,154 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,154 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,155 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,155 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,156 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:53,156 - lightrag - INFO - All documents have been processed or are duplicates
2025-01-13 09:02:58,574 - lightrag - INFO - kw_prompt result:
2025-01-13 09:02:58,574 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:02:58,944 - lightrag - INFO - Local query uses 100 entites, 124 relations, 7 text units
2025-01-13 09:02:59,002 - lightrag - INFO - Global query uses 29 entites, 100 relations, 6 text units
2025-01-13 09:03:32,312 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-13 09:03:32,374 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 09:03:32,379 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 09:03:32,383 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 09:03:32,417 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-13 09:03:32,498 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 09:03:32,499 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-13 09:03:32,544 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 09:03:32,547 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 09:03:32,552 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 09:03:32,585 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-13 09:03:32,618 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 09:03:39,245 - lightrag - INFO - kw_prompt result:
2025-01-13 09:03:39,246 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:03:39,629 - lightrag - INFO - Local query uses 80 entites, 37 relations, 4 text units
2025-01-13 09:03:39,680 - lightrag - INFO - Global query uses 9 entites, 80 relations, 4 text units
2025-01-13 09:05:04,353 - lightrag - INFO - kw_prompt result:
2025-01-13 09:05:04,353 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:05:04,615 - lightrag - INFO - Local query uses 80 entites, 41 relations, 3 text units
2025-01-13 09:05:04,661 - lightrag - INFO - Global query uses 26 entites, 80 relations, 3 text units
2025-01-13 09:05:17,003 - lightrag - INFO - kw_prompt result:
2025-01-13 09:05:17,003 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:05:17,078 - lightrag - INFO - Local query uses 80 entites, 41 relations, 3 text units
2025-01-13 09:05:17,144 - lightrag - INFO - Global query uses 33 entites, 80 relations, 5 text units
2025-01-13 09:07:13,519 - lightrag - INFO - kw_prompt result:
2025-01-13 09:07:13,519 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:07:14,225 - lightrag - INFO - Local query uses 80 entites, 47 relations, 3 text units
2025-01-13 09:07:15,047 - lightrag - INFO - Global query uses 10 entites, 80 relations, 4 text units
2025-01-13 09:07:34,698 - lightrag - INFO - kw_prompt result:
2025-01-13 09:07:34,699 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:07:35,435 - lightrag - INFO - Local query uses 80 entites, 18 relations, 3 text units
2025-01-13 09:07:36,351 - lightrag - INFO - Global query uses 10 entites, 33 relations, 3 text units
2025-01-13 09:07:43,215 - lightrag - INFO - kw_prompt result:
2025-01-13 09:07:43,215 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:07:43,282 - lightrag - INFO - Local query uses 80 entites, 41 relations, 3 text units
2025-01-13 09:07:43,347 - lightrag - INFO - Global query uses 18 entites, 57 relations, 3 text units
2025-01-13 09:07:56,466 - lightrag - INFO - kw_prompt result:
2025-01-13 09:07:56,466 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:07:56,529 - lightrag - INFO - Local query uses 80 entites, 41 relations, 3 text units
2025-01-13 09:07:56,640 - lightrag - INFO - Global query uses 10 entites, 80 relations, 3 text units
2025-01-13 09:07:59,620 - lightrag - INFO - kw_prompt result:
2025-01-13 09:07:59,620 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:08:14,665 - lightrag - INFO - kw_prompt result:
2025-01-13 09:08:14,665 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:08:14,791 - lightrag - INFO - Local query uses 80 entites, 43 relations, 3 text units
2025-01-13 09:08:14,873 - lightrag - INFO - Global query uses 10 entites, 80 relations, 3 text units
2025-01-13 09:08:19,966 - lightrag - INFO - kw_prompt result:
2025-01-13 09:08:19,966 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:08:20,036 - lightrag - INFO - Local query uses 80 entites, 41 relations, 4 text units
2025-01-13 09:08:20,140 - lightrag - INFO - Global query uses 20 entites, 80 relations, 4 text units
2025-01-13 09:09:51,972 - lightrag - INFO - kw_prompt result:
2025-01-13 09:09:51,972 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:10:00,073 - lightrag - INFO - kw_prompt result:
2025-01-13 09:10:00,073 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:10:03,517 - lightrag - INFO - kw_prompt result:
2025-01-13 09:10:03,517 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:10:04,714 - lightrag - INFO - kw_prompt result:
2025-01-13 09:10:04,715 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:10:06,396 - lightrag - INFO - kw_prompt result:
2025-01-13 09:10:06,396 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:10:14,688 - lightrag - INFO - kw_prompt result:
2025-01-13 09:10:14,689 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:10:14,752 - lightrag - INFO - Local query uses 80 entites, 140 relations, 3 text units
2025-01-13 09:10:14,847 - lightrag - INFO - Global query uses 10 entites, 80 relations, 4 text units
2025-01-13 09:10:22,078 - lightrag - INFO - kw_prompt result:
2025-01-13 09:10:22,078 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:10:22,206 - lightrag - INFO - Local query uses 80 entites, 40 relations, 4 text units
2025-01-13 09:10:22,262 - lightrag - INFO - Global query uses 16 entites, 80 relations, 4 text units
2025-01-13 09:10:37,346 - lightrag - INFO - kw_prompt result:
2025-01-13 09:10:37,346 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:10:38,132 - lightrag - INFO - Local query uses 80 entites, 43 relations, 3 text units
2025-01-13 09:10:39,123 - lightrag - INFO - Global query uses 11 entites, 20 relations, 4 text units
2025-01-13 09:11:14,859 - lightrag - INFO - kw_prompt result:
2025-01-13 09:11:14,860 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:11:14,949 - lightrag - INFO - Local query uses 80 entites, 40 relations, 3 text units
2025-01-13 09:11:15,053 - lightrag - INFO - Global query uses 15 entites, 80 relations, 4 text units
2025-01-13 09:11:27,592 - lightrag - INFO - kw_prompt result:
2025-01-13 09:11:27,592 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:11:27,655 - lightrag - INFO - Local query uses 80 entites, 40 relations, 3 text units
2025-01-13 09:11:27,732 - lightrag - INFO - Global query uses 14 entites, 80 relations, 4 text units
2025-01-13 09:13:08,334 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-13 09:13:08,398 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 09:13:08,402 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 09:13:08,407 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 09:13:08,442 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-13 09:13:08,524 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 09:13:08,524 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-13 09:13:08,571 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-13 09:13:08,574 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-13 09:13:08,578 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-13 09:13:08,611 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-13 09:13:08,646 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-13 09:15:50,670 - lightrag - INFO - kw_prompt result:
2025-01-13 09:15:50,670 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:15:51,707 - lightrag - INFO - Local query uses 60 entites, 16 relations, 3 text units
2025-01-13 09:15:52,443 - lightrag - INFO - Global query uses 10 entites, 60 relations, 4 text units
2025-01-13 09:16:04,031 - lightrag - INFO - kw_prompt result:
2025-01-13 09:16:04,031 - lightrag - ERROR - No JSON-like structure found in the result.
2025-01-13 09:16:09,020 - lightrag - INFO - kw_prompt result:
2025-01-13 09:16:09,021 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:16:09,099 - lightrag - INFO - Local query uses 60 entites, 41 relations, 5 text units
2025-01-13 09:16:09,154 - lightrag - INFO - Global query uses 22 entites, 60 relations, 3 text units
2025-01-13 09:16:15,279 - lightrag - INFO - kw_prompt result:
2025-01-13 09:16:15,280 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:16:16,376 - lightrag - INFO - Local query uses 60 entites, 25 relations, 3 text units
2025-01-13 09:16:17,171 - lightrag - INFO - Global query uses 19 entites, 60 relations, 4 text units
2025-01-13 09:17:06,268 - lightrag - INFO - kw_prompt result:
2025-01-13 09:17:06,268 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:17:06,336 - lightrag - INFO - Local query uses 60 entites, 52 relations, 5 text units
2025-01-13 09:17:06,441 - lightrag - INFO - Global query uses 19 entites, 60 relations, 4 text units
2025-01-13 09:17:14,978 - lightrag - INFO - kw_prompt result:
2025-01-13 09:17:14,979 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:17:15,045 - lightrag - INFO - Local query uses 60 entites, 83 relations, 6 text units
2025-01-13 09:17:15,158 - lightrag - INFO - Global query uses 20 entites, 60 relations, 3 text units
2025-01-13 09:19:36,537 - lightrag - INFO - kw_prompt result:
2025-01-13 09:19:36,537 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:19:36,606 - lightrag - INFO - Local query uses 60 entites, 66 relations, 4 text units
2025-01-13 09:19:36,710 - lightrag - INFO - Global query uses 19 entites, 60 relations, 3 text units
2025-01-13 09:23:05,567 - lightrag - INFO - kw_prompt result:
2025-01-13 09:23:05,567 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:23:05,619 - lightrag - INFO - Local query uses 60 entites, 57 relations, 6 text units
2025-01-13 09:23:05,726 - lightrag - INFO - Global query uses 21 entites, 60 relations, 3 text units
2025-01-13 09:24:28,268 - lightrag - INFO - kw_prompt result:
2025-01-13 09:24:28,268 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:24:31,188 - lightrag - INFO - kw_prompt result:
2025-01-13 09:24:31,188 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:24:34,453 - lightrag - INFO - kw_prompt result:
2025-01-13 09:24:34,453 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:24:41,911 - lightrag - INFO - kw_prompt result:
2025-01-13 09:24:41,911 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:24:41,971 - lightrag - INFO - Local query uses 60 entites, 48 relations, 3 text units
2025-01-13 09:24:42,038 - lightrag - INFO - Global query uses 10 entites, 60 relations, 4 text units
2025-01-13 09:24:46,685 - lightrag - INFO - kw_prompt result:
2025-01-13 09:24:46,685 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:24:47,464 - lightrag - INFO - Local query uses 60 entites, 57 relations, 3 text units
2025-01-13 09:24:48,574 - lightrag - INFO - Global query uses 12 entites, 21 relations, 4 text units
2025-01-13 09:28:11,299 - lightrag - INFO - kw_prompt result:
2025-01-13 09:28:11,300 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:28:41,517 - lightrag - INFO - kw_prompt result:
2025-01-13 09:28:41,517 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:28:42,195 - lightrag - INFO - Local query uses 36 entites, 30 relations, 3 text units
2025-01-13 09:28:42,440 - lightrag - INFO - kw_prompt result:
2025-01-13 09:28:42,440 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:28:42,765 - lightrag - INFO - Global query uses 21 entites, 60 relations, 4 text units
2025-01-13 09:29:11,181 - lightrag - INFO - kw_prompt result:
2025-01-13 09:29:11,182 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:29:19,661 - lightrag - INFO - kw_prompt result:
2025-01-13 09:29:19,661 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:29:19,934 - lightrag - INFO - kw_prompt result:
2025-01-13 09:29:19,934 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-13 09:29:20,649 - lightrag - INFO - Local query uses 60 entites, 22 relations, 5 text units
2025-01-13 09:29:21,235 - lightrag - INFO - Global query uses 15 entites, 25 relations, 3 text units
2025-01-13 09:30:19,839 - lightrag - INFO - kw_prompt result:
2025-01-13 09:30:19,839 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:30:20,577 - lightrag - INFO - Local query uses 60 entites, 18 relations, 5 text units
2025-01-13 09:30:21,413 - lightrag - INFO - Global query uses 15 entites, 23 relations, 3 text units
2025-01-13 09:32:40,125 - lightrag - INFO - kw_prompt result:
2025-01-13 09:32:40,125 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 09:32:41,212 - lightrag - INFO - Local query uses 60 entites, 40 relations, 3 text units
2025-01-13 09:32:41,313 - lightrag - INFO - Global query uses 10 entites, 60 relations, 4 text units
2025-01-13 14:24:00,697 - lightrag - INFO - kw_prompt result:
2025-01-13 14:24:00,697 - lightrag - INFO - Using hybrid mode for query processing
2025-01-13 14:24:02,042 - lightrag - INFO - Local query uses 60 entites, 123 relations, 3 text units
2025-01-13 14:24:02,133 - lightrag - INFO - Global query uses 20 entites, 60 relations, 4 text units
2025-01-14 04:50:04,620 - lightrag - INFO - kw_prompt result:
2025-01-14 04:50:04,621 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 04:50:05,994 - lightrag - INFO - Local query uses 60 entites, 132 relations, 3 text units
2025-01-14 04:50:06,074 - lightrag - INFO - Global query uses 21 entites, 60 relations, 4 text units
2025-01-14 04:51:18,023 - lightrag - INFO - kw_prompt result:
2025-01-14 04:51:18,023 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 04:51:18,085 - lightrag - INFO - Local query uses 60 entites, 60 relations, 3 text units
2025-01-14 04:51:18,168 - lightrag - INFO - Global query uses 31 entites, 60 relations, 3 text units
2025-01-14 04:52:22,730 - lightrag - INFO - kw_prompt result:
2025-01-14 04:52:22,731 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 04:52:22,797 - lightrag - INFO - Local query uses 60 entites, 41 relations, 3 text units
2025-01-14 04:52:22,860 - lightrag - INFO - Global query uses 30 entites, 60 relations, 5 text units
2025-01-14 05:12:29,842 - lightrag - INFO - kw_prompt result:
2025-01-14 05:12:29,842 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 05:12:30,917 - lightrag - INFO - Local query uses 60 entites, 38 relations, 4 text units
2025-01-14 05:12:31,029 - lightrag - INFO - Global query uses 22 entites, 60 relations, 4 text units
2025-01-14 05:13:37,258 - lightrag - INFO - kw_prompt result:
2025-01-14 05:13:37,258 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 05:13:37,348 - lightrag - INFO - Local query uses 60 entites, 60 relations, 3 text units
2025-01-14 05:13:37,442 - lightrag - INFO - Global query uses 21 entites, 60 relations, 3 text units
2025-01-14 05:14:48,874 - lightrag - INFO - kw_prompt result:
2025-01-14 05:14:48,874 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 05:14:48,936 - lightrag - INFO - Local query uses 60 entites, 41 relations, 3 text units
2025-01-14 05:14:49,048 - lightrag - INFO - Global query uses 29 entites, 60 relations, 3 text units
2025-01-14 05:27:27,085 - lightrag - INFO - kw_prompt result:
2025-01-14 05:27:27,085 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 05:27:28,118 - lightrag - INFO - Local query uses 60 entites, 17 relations, 4 text units
2025-01-14 05:27:29,150 - lightrag - INFO - Global query uses 11 entites, 36 relations, 3 text units
2025-01-14 05:27:39,221 - lightrag - INFO - kw_prompt result:
2025-01-14 05:27:39,221 - lightrag - ERROR - No JSON-like structure found in the result.
2025-01-14 05:27:40,815 - lightrag - INFO - kw_prompt result:
2025-01-14 05:27:40,815 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 05:27:41,738 - lightrag - INFO - Local query uses 60 entites, 17 relations, 3 text units
2025-01-14 05:27:42,754 - lightrag - INFO - Global query uses 11 entites, 26 relations, 3 text units
2025-01-14 05:30:23,991 - lightrag - INFO - kw_prompt result:
2025-01-14 05:30:23,991 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 05:59:32,364 - lightrag - INFO - kw_prompt result:
2025-01-14 05:59:32,364 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 05:59:33,733 - lightrag - INFO - Local query uses 60 entites, 40 relations, 4 text units
2025-01-14 05:59:33,839 - lightrag - INFO - Global query uses 19 entites, 60 relations, 4 text units
2025-01-14 06:31:15,159 - lightrag - INFO - kw_prompt result:
2025-01-14 06:31:15,159 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 06:31:16,081 - lightrag - INFO - Local query uses 60 entites, 22 relations, 3 text units
2025-01-14 06:31:16,987 - lightrag - INFO - Global query uses 12 entites, 21 relations, 3 text units
2025-01-14 06:32:01,204 - lightrag - INFO - kw_prompt result:
2025-01-14 06:32:01,204 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 06:32:01,916 - lightrag - INFO - Local query uses 60 entites, 28 relations, 4 text units
2025-01-14 06:32:02,826 - lightrag - INFO - Global query uses 22 entites, 60 relations, 3 text units
2025-01-14 06:32:28,003 - lightrag - INFO - kw_prompt result:
2025-01-14 06:32:28,003 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 06:32:29,455 - lightrag - INFO - Local query uses 60 entites, 52 relations, 3 text units
2025-01-14 06:32:30,196 - lightrag - INFO - Global query uses 15 entites, 60 relations, 3 text units
2025-01-14 06:33:04,068 - lightrag - INFO - kw_prompt result:
2025-01-14 06:33:04,068 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 06:33:05,043 - lightrag - INFO - Local query uses 60 entites, 34 relations, 5 text units
2025-01-14 06:33:06,056 - lightrag - INFO - Global query uses 21 entites, 60 relations, 3 text units
2025-01-14 06:34:02,511 - lightrag - INFO - kw_prompt result:
2025-01-14 06:34:02,511 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 06:34:03,848 - lightrag - INFO - Local query uses 60 entites, 98 relations, 3 text units
2025-01-14 06:34:03,949 - lightrag - INFO - Global query uses 15 entites, 60 relations, 4 text units
2025-01-14 06:35:38,127 - lightrag - INFO - kw_prompt result:
2025-01-14 06:35:38,127 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 06:35:38,180 - lightrag - INFO - Local query uses 60 entites, 80 relations, 4 text units
2025-01-14 06:35:38,259 - lightrag - INFO - Global query uses 16 entites, 60 relations, 4 text units
2025-01-14 06:45:14,857 - lightrag - INFO - kw_prompt result:
2025-01-14 06:45:14,857 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 06:45:16,201 - lightrag - INFO - Local query uses 60 entites, 40 relations, 5 text units
2025-01-14 06:45:16,267 - lightrag - INFO - Global query uses 15 entites, 60 relations, 4 text units
2025-01-14 07:45:40,818 - lightrag - INFO - kw_prompt result:
2025-01-14 07:45:40,819 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 07:45:42,174 - lightrag - INFO - Local query uses 60 entites, 40 relations, 4 text units
2025-01-14 07:45:42,243 - lightrag - INFO - Global query uses 28 entites, 60 relations, 5 text units
2025-01-14 10:38:32,030 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-14 10:38:32,098 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 10:38:32,103 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 10:38:32,107 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 10:38:32,142 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-14 10:38:32,227 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 10:38:32,227 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-14 10:38:32,276 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 10:38:32,279 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 10:38:32,283 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 10:38:32,319 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-14 10:38:32,351 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 10:39:39,317 - lightrag - INFO - kw_prompt result:
2025-01-14 10:39:39,317 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:39:40,977 - lightrag - INFO - Local query uses 60 entites, 59 relations, 3 text units
2025-01-14 10:39:41,030 - lightrag - INFO - Global query uses 12 entites, 60 relations, 4 text units
2025-01-14 10:40:44,023 - lightrag - INFO - kw_prompt result:
2025-01-14 10:40:44,023 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:40:44,091 - lightrag - INFO - Local query uses 60 entites, 41 relations, 3 text units
2025-01-14 10:40:44,209 - lightrag - INFO - Global query uses 19 entites, 60 relations, 3 text units
2025-01-14 10:41:48,222 - lightrag - INFO - kw_prompt result:
2025-01-14 10:41:48,222 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:41:48,285 - lightrag - INFO - Local query uses 60 entites, 41 relations, 3 text units
2025-01-14 10:41:48,352 - lightrag - INFO - Global query uses 16 entites, 60 relations, 3 text units
2025-01-14 10:44:10,837 - lightrag - INFO - kw_prompt result:
2025-01-14 10:44:10,838 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:44:11,046 - lightrag - INFO - Local query uses 60 entites, 41 relations, 3 text units
2025-01-14 10:44:11,091 - lightrag - INFO - Global query uses 22 entites, 60 relations, 3 text units
2025-01-14 10:45:16,688 - lightrag - INFO - kw_prompt result:
2025-01-14 10:45:16,688 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:45:16,751 - lightrag - INFO - Local query uses 60 entites, 125 relations, 3 text units
2025-01-14 10:45:16,830 - lightrag - INFO - Global query uses 18 entites, 60 relations, 4 text units
2025-01-14 10:47:27,737 - lightrag - INFO - kw_prompt result:
2025-01-14 10:47:27,737 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:47:27,806 - lightrag - INFO - Local query uses 60 entites, 120 relations, 3 text units
2025-01-14 10:47:27,876 - lightrag - INFO - Global query uses 16 entites, 60 relations, 4 text units
2025-01-14 10:51:05,984 - lightrag - INFO - kw_prompt result:
2025-01-14 10:51:05,984 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:51:06,073 - lightrag - INFO - Local query uses 60 entites, 41 relations, 3 text units
2025-01-14 10:51:06,153 - lightrag - INFO - Global query uses 17 entites, 60 relations, 4 text units
2025-01-14 10:52:50,696 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-14 10:52:50,759 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 10:52:50,764 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 10:52:50,769 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 10:52:50,803 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-14 10:52:50,884 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 10:52:50,885 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-14 10:52:50,931 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 10:52:50,934 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 10:52:50,938 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 10:52:50,970 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-14 10:52:51,003 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 10:53:48,850 - lightrag - INFO - kw_prompt result:
2025-01-14 10:53:48,850 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:53:49,205 - lightrag - INFO - Local query uses 100 entites, 54 relations, 3 text units
2025-01-14 10:53:49,254 - lightrag - INFO - Global query uses 10 entites, 96 relations, 4 text units
2025-01-14 10:54:55,235 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-14 10:54:55,302 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 10:54:55,307 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 10:54:55,312 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 10:54:55,348 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-14 10:54:55,435 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 10:54:55,435 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-14 10:54:55,485 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 10:54:55,488 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 10:54:55,492 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 10:54:55,527 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-14 10:54:55,562 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 10:55:07,956 - lightrag - INFO - kw_prompt result:
2025-01-14 10:55:07,956 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:55:08,314 - lightrag - INFO - Local query uses 100 entites, 130 relations, 3 text units
2025-01-14 10:55:08,359 - lightrag - INFO - Global query uses 15 entites, 100 relations, 4 text units
2025-01-14 10:57:05,803 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-14 10:57:05,866 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 10:57:05,872 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 10:57:05,878 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 10:57:05,912 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-14 10:57:05,994 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 10:57:05,994 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-14 10:57:06,041 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 10:57:06,044 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 10:57:06,048 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 10:57:06,080 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-14 10:57:06,112 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 10:57:19,216 - lightrag - INFO - kw_prompt result:
2025-01-14 10:57:19,216 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:57:20,832 - lightrag - INFO - Local query uses 70 entites, 56 relations, 3 text units
2025-01-14 10:57:20,882 - lightrag - INFO - Global query uses 14 entites, 70 relations, 4 text units
2025-01-14 10:59:10,019 - lightrag - INFO - kw_prompt result:
2025-01-14 10:59:10,019 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 10:59:10,084 - lightrag - INFO - Local query uses 70 entites, 41 relations, 4 text units
2025-01-14 10:59:10,151 - lightrag - INFO - Global query uses 15 entites, 70 relations, 4 text units
2025-01-14 11:01:12,362 - lightrag - INFO - kw_prompt result:
2025-01-14 11:01:12,362 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:01:12,628 - lightrag - INFO - Local query uses 70 entites, 41 relations, 3 text units
2025-01-14 11:01:12,677 - lightrag - INFO - Global query uses 17 entites, 70 relations, 5 text units
2025-01-14 11:05:25,120 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-14 11:05:25,185 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 11:05:25,190 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 11:05:25,195 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 11:05:25,229 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-14 11:05:25,311 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 11:05:25,312 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-14 11:05:25,312 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-14 11:05:25,315 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 11:05:25,318 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 11:05:25,353 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-14 11:05:25,388 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 11:06:25,524 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-14 11:06:25,592 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 11:06:25,597 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 11:06:25,602 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 11:06:25,638 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-14 11:06:25,723 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 11:06:25,724 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-14 11:06:25,724 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-14 11:06:25,727 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 11:06:25,731 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 11:06:25,766 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-14 11:06:25,800 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 11:08:22,213 - lightrag - INFO - kw_prompt result:
2025-01-14 11:08:36,951 - lightrag - INFO - kw_prompt result:
2025-01-14 11:08:36,951 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:08:38,660 - lightrag - INFO - kw_prompt result:
2025-01-14 11:08:38,660 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:08:40,599 - lightrag - INFO - Local query uses 60 entites, 17 relations, 3 text units
2025-01-14 11:08:41,557 - lightrag - INFO - Global query uses 10 entites, 55 relations, 4 text units
2025-01-14 11:09:14,781 - lightrag - INFO - kw_prompt result:
2025-01-14 11:09:14,781 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:09:24,446 - lightrag - INFO - kw_prompt result:
2025-01-14 11:09:24,446 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:09:30,471 - lightrag - INFO - kw_prompt result:
2025-01-14 11:09:30,471 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:09:31,916 - lightrag - INFO - Local query uses 60 entites, 49 relations, 4 text units
2025-01-14 11:09:31,972 - lightrag - INFO - Global query uses 13 entites, 60 relations, 4 text units
2025-01-14 11:10:20,504 - lightrag - INFO - kw_prompt result:
2025-01-14 11:10:20,504 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:10:20,560 - lightrag - INFO - Local query uses 60 entites, 117 relations, 3 text units
2025-01-14 11:10:20,636 - lightrag - INFO - Global query uses 10 entites, 60 relations, 6 text units
2025-01-14 11:11:27,903 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-14 11:11:27,967 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 11:11:27,972 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 11:11:27,977 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 11:11:28,015 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-14 11:11:28,099 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 11:11:28,099 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-14 11:11:28,100 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-14 11:11:28,103 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 11:11:28,106 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 11:11:28,140 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-14 11:11:28,173 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 11:11:39,705 - lightrag - INFO - kw_prompt result:
2025-01-14 11:11:39,705 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:11:40,056 - lightrag - INFO - Local query uses 60 entites, 89 relations, 3 text units
2025-01-14 11:11:40,103 - lightrag - INFO - Global query uses 16 entites, 60 relations, 6 text units
2025-01-14 11:12:27,403 - lightrag - INFO - kw_prompt result:
2025-01-14 11:12:27,403 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:12:27,462 - lightrag - INFO - Local query uses 60 entites, 60 relations, 3 text units
2025-01-14 11:12:27,534 - lightrag - INFO - Global query uses 10 entites, 60 relations, 3 text units
2025-01-14 11:13:25,810 - lightrag - INFO - kw_prompt result:
2025-01-14 11:13:25,810 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:13:26,721 - lightrag - INFO - Local query uses 60 entites, 56 relations, 3 text units
2025-01-14 11:13:28,054 - lightrag - INFO - Global query uses 10 entites, 34 relations, 3 text units
2025-01-14 11:15:22,454 - lightrag - INFO - kw_prompt result:
2025-01-14 11:15:22,454 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:15:24,288 - lightrag - INFO - kw_prompt result:
2025-01-14 11:15:24,288 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:15:25,202 - lightrag - INFO - Local query uses 60 entites, 71 relations, 3 text units
2025-01-14 11:15:26,675 - lightrag - INFO - Global query uses 12 entites, 38 relations, 4 text units
2025-01-14 11:16:16,509 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-14 11:16:16,572 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 11:16:16,577 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 11:16:16,582 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 11:16:16,616 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-14 11:16:16,699 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 11:16:16,699 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-14 11:16:16,700 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-14 11:16:16,703 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 11:16:16,706 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 11:16:16,741 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-14 11:16:16,774 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 11:16:22,854 - lightrag - INFO - kw_prompt result:
2025-01-14 11:16:22,854 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:16:24,137 - lightrag - INFO - Local query uses 100 entites, 53 relations, 3 text units
2025-01-14 11:16:25,279 - lightrag - INFO - Global query uses 12 entites, 22 relations, 3 text units
2025-01-14 11:17:22,126 - lightrag - INFO - kw_prompt result:
2025-01-14 11:17:22,126 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:17:25,777 - lightrag - INFO - kw_prompt result:
2025-01-14 11:17:25,777 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:17:29,892 - lightrag - INFO - kw_prompt result:
2025-01-14 11:17:29,892 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:17:31,215 - lightrag - INFO - kw_prompt result:
2025-01-14 11:17:31,215 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:17:32,146 - lightrag - INFO - Local query uses 100 entites, 17 relations, 3 text units
2025-01-14 11:17:33,139 - lightrag - INFO - Global query uses 11 entites, 30 relations, 3 text units
2025-01-14 11:18:21,565 - lightrag - INFO - kw_prompt result:
2025-01-14 11:18:21,565 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:18:36,005 - lightrag - INFO - kw_prompt result:
2025-01-14 11:18:36,006 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:18:38,054 - lightrag - INFO - kw_prompt result:
2025-01-14 11:18:38,054 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-14 11:18:43,409 - lightrag - INFO - kw_prompt result:
2025-01-14 11:18:43,409 - lightrag - INFO - Using hybrid mode for query processing
2025-01-14 11:18:44,122 - lightrag - INFO - Local query uses 100 entites, 17 relations, 3 text units
2025-01-14 11:18:45,035 - lightrag - INFO - Global query uses 19 entites, 36 relations, 3 text units
2025-01-14 18:02:05,406 - lightrag - INFO - Logger initialized for working directory: ./contemi_openai
2025-01-14 18:02:05,470 - lightrag - INFO - Load KV llm_response_cache with 2 data
2025-01-14 18:02:05,475 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 18:02:05,479 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 18:02:05,514 - lightrag - INFO - Loaded graph from ./contemi_openai/graph_chunk_entity_relation.graphml with 1250 nodes, 1031 edges
2025-01-14 18:02:05,597 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-14 18:02:05,597 - lightrag - INFO - Logger initialized for working directory: ./contemi_opensrc
2025-01-14 18:02:05,597 - lightrag - INFO - Load KV llm_response_cache with 0 data
2025-01-14 18:02:05,600 - lightrag - INFO - Load KV full_docs with 125 data
2025-01-14 18:02:05,604 - lightrag - INFO - Load KV text_chunks with 303 data
2025-01-14 18:02:05,638 - lightrag - INFO - Loaded graph from ./contemi_opensrc/graph_chunk_entity_relation.graphml with 1413 nodes, 1105 edges
2025-01-14 18:02:05,671 - lightrag - INFO - Loaded document status storage with 125 records
2025-01-15 02:30:37,555 - lightrag - INFO - kw_prompt result:
2025-01-15 02:30:37,555 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 02:30:39,155 - lightrag - INFO - kw_prompt result:
2025-01-15 02:30:39,155 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 02:30:49,956 - lightrag - INFO - kw_prompt result:
2025-01-15 02:30:49,956 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 02:30:52,512 - lightrag - INFO - kw_prompt result:
2025-01-15 02:30:52,512 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 02:30:56,288 - lightrag - INFO - kw_prompt result:
2025-01-15 02:30:56,288 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 02:31:01,857 - lightrag - INFO - kw_prompt result:
2025-01-15 02:31:01,857 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 02:31:03,334 - lightrag - INFO - Local query uses 100 entites, 48 relations, 3 text units
2025-01-15 02:31:04,422 - lightrag - INFO - Global query uses 10 entites, 28 relations, 3 text units
2025-01-15 02:32:50,057 - lightrag - INFO - kw_prompt result:
2025-01-15 02:32:50,057 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 02:32:50,995 - lightrag - INFO - Local query uses 100 entites, 17 relations, 3 text units
2025-01-15 02:32:51,931 - lightrag - INFO - Global query uses 10 entites, 28 relations, 3 text units
2025-01-15 02:37:06,312 - lightrag - INFO - kw_prompt result:
2025-01-15 02:37:06,312 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 02:37:07,251 - lightrag - INFO - Local query uses 100 entites, 74 relations, 4 text units
2025-01-15 02:37:07,987 - lightrag - INFO - Global query uses 14 entites, 47 relations, 4 text units
2025-01-15 02:37:13,194 - lightrag - INFO - kw_prompt result:
2025-01-15 02:37:13,194 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 02:37:14,057 - lightrag - INFO - Local query uses 100 entites, 46 relations, 3 text units
2025-01-15 02:37:14,959 - lightrag - INFO - Global query uses 10 entites, 42 relations, 4 text units
2025-01-15 02:39:18,997 - lightrag - INFO - kw_prompt result:
2025-01-15 02:39:18,997 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 02:39:19,922 - lightrag - INFO - Local query uses 40 entites, 59 relations, 3 text units
2025-01-15 02:39:20,589 - lightrag - INFO - Global query uses 12 entites, 32 relations, 4 text units
2025-01-15 02:39:33,556 - lightrag - INFO - kw_prompt result:
2025-01-15 02:39:33,556 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 02:39:34,846 - lightrag - INFO - Local query uses 100 entites, 58 relations, 3 text units
2025-01-15 02:39:35,635 - lightrag - INFO - Global query uses 9 entites, 61 relations, 4 text units
2025-01-15 02:40:05,679 - lightrag - INFO - kw_prompt result:
2025-01-15 02:40:05,680 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 02:40:06,282 - lightrag - INFO - Local query uses 100 entites, 26 relations, 3 text units
2025-01-15 02:40:07,154 - lightrag - INFO - Global query uses 11 entites, 40 relations, 4 text units
2025-01-15 02:40:50,923 - lightrag - INFO - kw_prompt result:
2025-01-15 02:40:50,924 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 02:40:51,622 - lightrag - INFO - Local query uses 100 entites, 26 relations, 3 text units
2025-01-15 02:40:52,304 - lightrag - INFO - Global query uses 14 entites, 83 relations, 3 text units
2025-01-15 02:41:07,475 - lightrag - INFO - kw_prompt result:
2025-01-15 02:41:07,475 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 02:41:08,259 - lightrag - INFO - Local query uses 100 entites, 25 relations, 3 text units
2025-01-15 02:41:09,567 - lightrag - INFO - Global query uses 18 entites, 53 relations, 3 text units
2025-01-15 04:51:24,139 - lightrag - INFO - kw_prompt result:
2025-01-15 04:51:24,139 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 04:51:25,102 - lightrag - INFO - Local query uses 100 entites, 17 relations, 3 text units
2025-01-15 04:51:26,058 - lightrag - INFO - Global query uses 11 entites, 42 relations, 4 text units
2025-01-15 05:44:47,242 - lightrag - INFO - kw_prompt result:
2025-01-15 05:44:47,242 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 05:44:48,008 - lightrag - INFO - Local query uses 100 entites, 17 relations, 3 text units
2025-01-15 05:44:48,947 - lightrag - INFO - Global query uses 15 entites, 25 relations, 3 text units
2025-01-15 05:45:17,227 - lightrag - INFO - kw_prompt result:
2025-01-15 05:45:17,227 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:45:21,774 - lightrag - INFO - kw_prompt result:
2025-01-15 05:45:21,774 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:45:25,837 - lightrag - INFO - kw_prompt result:
2025-01-15 05:45:25,837 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:45:35,346 - lightrag - INFO - kw_prompt result:
2025-01-15 05:45:35,346 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:45:49,650 - lightrag - INFO - kw_prompt result:
2025-01-15 05:45:49,650 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 05:45:50,717 - lightrag - INFO - Local query uses 100 entites, 17 relations, 3 text units
2025-01-15 05:45:51,621 - lightrag - INFO - Global query uses 9 entites, 17 relations, 4 text units
2025-01-15 05:55:51,394 - lightrag - INFO - kw_prompt result:
2025-01-15 05:55:51,394 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:55:55,552 - lightrag - INFO - kw_prompt result:
2025-01-15 05:55:55,552 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:56:03,824 - lightrag - INFO - kw_prompt result:
2025-01-15 05:56:03,824 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:56:09,105 - lightrag - INFO - kw_prompt result:
2025-01-15 05:56:09,105 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 05:56:09,998 - lightrag - INFO - Local query uses 21 entites, 14 relations, 3 text units
2025-01-15 05:56:11,404 - lightrag - INFO - Global query uses 10 entites, 21 relations, 4 text units
2025-01-15 05:56:55,811 - lightrag - INFO - kw_prompt result:
2025-01-15 05:56:55,812 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:56:58,428 - lightrag - INFO - kw_prompt result:
2025-01-15 05:56:58,428 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:57:05,149 - lightrag - INFO - kw_prompt result:
2025-01-15 05:57:05,149 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:57:07,169 - lightrag - INFO - kw_prompt result:
2025-01-15 05:57:07,169 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:57:09,309 - lightrag - INFO - kw_prompt result:
2025-01-15 05:57:09,309 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:57:13,649 - lightrag - INFO - kw_prompt result:
2025-01-15 05:57:13,649 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:57:21,601 - lightrag - INFO - kw_prompt result:
2025-01-15 05:57:21,601 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:57:24,682 - lightrag - INFO - kw_prompt result:
2025-01-15 05:57:24,682 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:57:27,515 - lightrag - INFO - kw_prompt result:
2025-01-15 05:57:27,515 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:58:12,428 - lightrag - INFO - kw_prompt result:
2025-01-15 05:58:12,428 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:58:18,053 - lightrag - INFO - kw_prompt result:
2025-01-15 05:58:18,053 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:58:31,829 - lightrag - INFO - kw_prompt result:
2025-01-15 05:58:31,829 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-15 05:58:52,972 - lightrag - INFO - kw_prompt result:
2025-01-15 05:58:52,972 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 05:58:53,969 - lightrag - INFO - Local query uses 67 entites, 43 relations, 3 text units
2025-01-15 05:58:54,979 - lightrag - INFO - Global query uses 10 entites, 25 relations, 3 text units
2025-01-15 06:56:07,041 - lightrag - INFO - kw_prompt result:
2025-01-15 06:56:07,041 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 06:56:08,123 - lightrag - INFO - Local query uses 100 entites, 81 relations, 3 text units
2025-01-15 06:56:09,175 - lightrag - INFO - Global query uses 14 entites, 100 relations, 3 text units
2025-01-15 06:56:39,284 - lightrag - INFO - kw_prompt result:
2025-01-15 06:56:39,284 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 06:56:39,996 - lightrag - INFO - Local query uses 100 entites, 39 relations, 3 text units
2025-01-15 06:56:40,964 - lightrag - INFO - Global query uses 9 entites, 17 relations, 4 text units
2025-01-15 06:57:33,307 - lightrag - INFO - kw_prompt result:
2025-01-15 06:57:33,307 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 06:57:34,447 - lightrag - INFO - Local query uses 100 entites, 92 relations, 3 text units
2025-01-15 06:57:35,239 - lightrag - INFO - Global query uses 14 entites, 67 relations, 3 text units
2025-01-15 06:59:06,571 - lightrag - INFO - kw_prompt result:
2025-01-15 06:59:06,571 - lightrag - INFO - Using hybrid mode for query processing
2025-01-15 06:59:07,446 - lightrag - INFO - Local query uses 100 entites, 45 relations, 3 text units
2025-01-15 06:59:08,190 - lightrag - INFO - Global query uses 15 entites, 58 relations, 3 text units
2025-01-16 03:48:01,790 - lightrag - INFO - kw_prompt result:
2025-01-16 03:48:01,790 - lightrag - INFO - Using hybrid mode for query processing
2025-01-16 03:48:02,840 - lightrag - INFO - Local query uses 100 entites, 33 relations, 4 text units
2025-01-16 03:48:03,859 - lightrag - INFO - Global query uses 11 entites, 77 relations, 3 text units
2025-01-16 03:48:22,056 - lightrag - INFO - kw_prompt result:
2025-01-16 03:48:22,056 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-16 03:48:26,254 - lightrag - INFO - kw_prompt result:
2025-01-16 03:48:26,254 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-16 03:48:32,693 - lightrag - INFO - kw_prompt result:
2025-01-16 03:48:32,693 - lightrag - INFO - Using hybrid mode for query processing
2025-01-16 03:48:33,774 - lightrag - INFO - Local query uses 100 entites, 25 relations, 3 text units
2025-01-16 03:48:34,440 - lightrag - INFO - Global query uses 13 entites, 23 relations, 4 text units
2025-01-16 03:48:56,501 - lightrag - INFO - kw_prompt result:
2025-01-16 03:48:56,501 - lightrag - INFO - Using hybrid mode for query processing
2025-01-16 03:48:57,267 - lightrag - INFO - Local query uses 100 entites, 60 relations, 4 text units
2025-01-16 03:48:58,172 - lightrag - INFO - Global query uses 15 entites, 68 relations, 6 text units
2025-01-16 03:53:55,138 - lightrag - INFO - kw_prompt result:
2025-01-16 03:53:55,138 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-16 03:53:57,426 - lightrag - INFO - kw_prompt result:
2025-01-16 03:53:57,426 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-16 03:54:00,953 - lightrag - INFO - kw_prompt result:
2025-01-16 03:54:00,953 - lightrag - INFO - Using hybrid mode for query processing
2025-01-16 03:54:01,912 - lightrag - INFO - Local query uses 100 entites, 17 relations, 4 text units
2025-01-16 03:54:02,945 - lightrag - INFO - Global query uses 12 entites, 37 relations, 4 text units
2025-01-16 04:18:21,191 - lightrag - INFO - kw_prompt result:
2025-01-16 04:18:21,191 - lightrag - WARNING - low_level_keywords and high_level_keywords is empty
2025-01-16 04:18:27,350 - lightrag - INFO - kw_prompt result:
2025-01-16 04:18:27,350 - lightrag - INFO - Using hybrid mode for query processing
2025-01-16 04:18:28,282 - lightrag - INFO - Local query uses 100 entites, 17 relations, 3 text units
2025-01-16 04:18:29,512 - lightrag - INFO - Global query uses 11 entites, 44 relations, 3 text units
2025-01-16 04:18:53,741 - lightrag - INFO - kw_prompt result:
2025-01-16 04:18:53,741 - lightrag - INFO - Using hybrid mode for query processing
2025-01-16 04:18:54,768 - lightrag - INFO - Local query uses 100 entites, 71 relations, 4 text units
2025-01-16 04:18:55,692 - lightrag - INFO - Global query uses 10 entites, 21 relations, 3 text units
